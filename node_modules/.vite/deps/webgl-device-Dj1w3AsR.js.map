{"version":3,"file":"webgl-device-Dj1w3AsR.js","names":["uid","log","message","uid","attachment","name","attributeMapping","target","isArray","isObjectEmpty","name","arrayBuffer","messageType","message","isObjectEmpty","uniforms","name","name","status","getFramebuffer","enable","compareConstantArrayValues","target","target","name"],"sources":["../../@luma.gl/core/dist/utils/promise-utils.js","../../@luma.gl/core/dist/adapter/canvas-context.js","../../@luma.gl/core/dist/adapter/resources/sampler.js","../../@luma.gl/core/dist/adapter/resources/texture.js","../../@luma.gl/core/dist/adapter/resources/texture-view.js","../../@luma.gl/core/dist/adapter-utils/format-compiler-log.js","../../@luma.gl/core/dist/adapter/resources/shader.js","../../@luma.gl/core/dist/adapter/resources/framebuffer.js","../../@luma.gl/core/dist/adapter/resources/render-pipeline.js","../../@luma.gl/core/dist/adapter/resources/render-pass.js","../../@luma.gl/core/dist/adapter/resources/command-encoder.js","../../@luma.gl/core/dist/adapter/resources/command-buffer.js","../../@luma.gl/core/dist/shadertypes/data-types/decode-shader-types.js","../../@luma.gl/core/dist/adapter-utils/get-attribute-from-layouts.js","../../@luma.gl/core/dist/adapter/resources/vertex-array.js","../../@luma.gl/core/dist/adapter/resources/transform-feedback.js","../../@luma.gl/core/dist/adapter/resources/query-set.js","../../@luma.gl/core/dist/utils/array-utils-flat.js","../../@luma.gl/webgl/dist/context/parameters/webgl-parameter-tables.js","../../@luma.gl/webgl/dist/context/parameters/unified-parameter-api.js","../../@luma.gl/webgl/dist/context/state-tracker/deep-array-equal.js","../../@luma.gl/webgl/dist/context/state-tracker/webgl-state-tracker.js","../../@luma.gl/webgl/dist/context/helpers/create-browser-context.js","../../@luma.gl/webgl/dist/context/helpers/webgl-extensions.js","../../@luma.gl/webgl/dist/adapter/device-helpers/webgl-device-info.js","../../@luma.gl/webgl/dist/adapter/converters/webgl-vertex-formats.js","../../@luma.gl/webgl/dist/adapter/converters/webgl-texture-table.js","../../@luma.gl/webgl/dist/adapter/device-helpers/webgl-device-features.js","../../@luma.gl/webgl/dist/adapter/device-helpers/webgl-device-limits.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-framebuffer.js","../../@luma.gl/webgl/dist/adapter/webgl-canvas-context.js","../../@luma.gl/webgl/dist/utils/uid.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-buffer.js","../../@luma.gl/webgl/dist/adapter/helpers/parse-shader-compiler-log.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-shader.js","../../@luma.gl/webgl/dist/adapter/converters/device-parameters.js","../../@luma.gl/webgl/dist/adapter/converters/sampler-parameters.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-sampler.js","../../@luma.gl/webgl/dist/context/state-tracker/with-parameters.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-texture-view.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-texture.js","../../@luma.gl/webgl/dist/adapter/converters/webgl-shadertypes.js","../../@luma.gl/webgl/dist/adapter/helpers/get-shader-layout-from-glsl.js","../../@luma.gl/webgl/dist/adapter/helpers/set-uniform.js","../../@luma.gl/webgl/dist/adapter/helpers/webgl-topology-utils.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-render-pipeline.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-command-buffer.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-render-pass.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-command-encoder.js","../../@luma.gl/webgl/dist/utils/fill-array.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-vertex-array.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-transform-feedback.js","../../@luma.gl/webgl/dist/adapter/resources/webgl-query-set.js","../../@luma.gl/webgl/dist/adapter/helpers/format-utils.js","../../@luma.gl/webgl/dist/adapter/converters/shader-formats.js","../../@luma.gl/webgl/dist/adapter/helpers/webgl-texture-utils.js","../../@luma.gl/webgl/dist/adapter/webgl-device.js"],"sourcesContent":["// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// TODO - replace with Promise.withResolvers once we upgrade TS baseline\nexport function withResolvers() {\n    let resolve;\n    let reject;\n    const promise = new Promise((_resolve, _reject) => {\n        resolve = _resolve;\n        reject = _reject;\n    });\n    // @ts-expect-error - in fact these are no used before initialized\n    return { promise, resolve, reject };\n}\n//# sourceMappingURL=promise-utils.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { isBrowser } from '@probe.gl/env';\nimport { uid } from \"../utils/uid.js\";\nimport { withResolvers } from \"../utils/promise-utils.js\";\n/**\n * Manages a canvas. Supports both HTML or offscreen canvas\n * - Creates a new canvas or looks up a canvas from the DOM\n * - Provides check for DOM loaded\n * @todo commit() @see https://github.com/w3ctag/design-reviews/issues/288\n * @todo transferControlToOffscreen: @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/transferControlToOffscreen\n */\nexport class CanvasContext {\n    static isHTMLCanvas(canvas) {\n        return typeof HTMLCanvasElement !== 'undefined' && canvas instanceof HTMLCanvasElement;\n    }\n    static isOffscreenCanvas(canvas) {\n        return typeof OffscreenCanvas !== 'undefined' && canvas instanceof OffscreenCanvas;\n    }\n    static defaultProps = {\n        id: undefined,\n        canvas: null,\n        width: 800,\n        height: 600,\n        useDevicePixels: true,\n        autoResize: true,\n        container: null,\n        visible: true,\n        alphaMode: 'opaque',\n        colorSpace: 'srgb',\n        trackPosition: false\n    };\n    id;\n    props;\n    canvas;\n    /** Handle to HTML canvas */\n    htmlCanvas;\n    /** Handle to wrapped OffScreenCanvas */\n    offscreenCanvas;\n    type;\n    /** Promise that resolved once the resize observer has updated the pixel size */\n    initialized;\n    isInitialized = false;\n    /** Visibility is automatically updated (via an IntersectionObserver) */\n    isVisible = true;\n    /** Width of canvas in CSS units (tracked by a ResizeObserver) */\n    cssWidth;\n    /** Height of canvas in CSS units (tracked by a ResizeObserver) */\n    cssHeight;\n    /** Device pixel ratio. Automatically updated via media queries */\n    devicePixelRatio;\n    /** Exact width of canvas in physical pixels (tracked by a ResizeObserver) */\n    devicePixelWidth;\n    /** Exact height of canvas in physical pixels (tracked by a ResizeObserver) */\n    devicePixelHeight;\n    /** Width of drawing buffer: automatically tracks this.pixelWidth if props.autoResize is true */\n    drawingBufferWidth;\n    /** Height of drawing buffer: automatically tracks this.pixelHeight if props.autoResize is true */\n    drawingBufferHeight;\n    _initializedResolvers = withResolvers();\n    _resizeObserver;\n    _intersectionObserver;\n    _position;\n    destroyed = false;\n    toString() {\n        return `${this[Symbol.toStringTag]}(${this.id})`;\n    }\n    constructor(props) {\n        this.props = { ...CanvasContext.defaultProps, ...props };\n        props = this.props;\n        this.initialized = this._initializedResolvers.promise;\n        // Create a canvas element if needed\n        if (!isBrowser()) {\n            // TODO - does this prevent app from using jsdom style polyfills?\n            this.canvas = { width: props.width || 1, height: props.height || 1 };\n        }\n        else if (!props.canvas) {\n            this.canvas = createCanvasElement(props);\n        }\n        else if (typeof props.canvas === 'string') {\n            this.canvas = getCanvasFromDOM(props.canvas);\n        }\n        else {\n            this.canvas = props.canvas;\n        }\n        if (CanvasContext.isHTMLCanvas(this.canvas)) {\n            this.id = props.id || this.canvas.id;\n            this.type = 'html-canvas';\n            this.htmlCanvas = this.canvas;\n        }\n        else if (CanvasContext.isOffscreenCanvas(this.canvas)) {\n            this.id = props.id || 'offscreen-canvas';\n            this.type = 'offscreen-canvas';\n            this.offscreenCanvas = this.canvas;\n        }\n        else {\n            // TODO - Node.js support is currently untested (was used for headless-gl in luma v8)\n            this.id = props.id || 'node-canvas-context';\n            this.type = 'node';\n        }\n        // Initialize size variables to some sane values (these will be updated by ResizeObserver)\n        this.cssWidth = this.htmlCanvas?.clientWidth || this.canvas.width;\n        this.cssHeight = this.htmlCanvas?.clientHeight || this.canvas.height;\n        this.devicePixelWidth = this.canvas.width;\n        this.devicePixelHeight = this.canvas.height;\n        this.drawingBufferWidth = this.canvas.width;\n        this.drawingBufferHeight = this.canvas.height;\n        this.devicePixelRatio = globalThis.devicePixelRatio || 1;\n        this._position = [0, 0];\n        if (CanvasContext.isHTMLCanvas(this.canvas)) {\n            // Track visibility changes\n            this._intersectionObserver = new IntersectionObserver(entries => this._handleIntersection(entries));\n            this._intersectionObserver.observe(this.canvas);\n            // Track size changes\n            this._resizeObserver = new ResizeObserver(entries => this._handleResize(entries));\n            try {\n                this._resizeObserver.observe(this.canvas, { box: 'device-pixel-content-box' });\n            }\n            catch {\n                // Safari fallback\n                this._resizeObserver.observe(this.canvas, { box: 'content-box' });\n            }\n            // Track device pixel ratio changes.\n            // Defer call to after construction completes to ensure `this.device` is available.\n            setTimeout(() => this._observeDevicePixelRatio(), 0);\n            // Track top/left position changes\n            if (this.props.trackPosition) {\n                this._trackPosition();\n            }\n        }\n    }\n    destroy() {\n        this.destroyed = true;\n    }\n    setProps(props) {\n        if ('useDevicePixels' in props) {\n            this.props.useDevicePixels = props.useDevicePixels || false;\n            this._updateDrawingBufferSize();\n        }\n        return this;\n    }\n    // SIZE METHODS\n    /**\n     * Returns the size covered by the canvas in CSS pixels\n     * @note This can be different from the actual device pixel size of a canvas due to DPR scaling, and rounding to integer pixels\n     * @note This is independent of the canvas' internal drawing buffer size (.width, .height).\n     */\n    getCSSSize() {\n        return [this.cssWidth, this.cssHeight];\n    }\n    getPosition() {\n        return this._position;\n    }\n    /**\n     * Returns the size covered by the canvas in actual device pixels.\n     * @note This can be different from the 'CSS' size of a canvas due to DPR scaling, and rounding to integer pixels\n     * @note This is independent of the canvas' internal drawing buffer size (.width, .height).\n     */\n    getDevicePixelSize() {\n        return [this.devicePixelWidth, this.devicePixelHeight];\n    }\n    /** Get the drawing buffer size (number of pixels GPU is rendering into, can be different from CSS size) */\n    getDrawingBufferSize() {\n        return [this.drawingBufferWidth, this.drawingBufferHeight];\n    }\n    /** Returns the biggest allowed framebuffer size. @todo Allow the application to limit this? */\n    getMaxDrawingBufferSize() {\n        const maxTextureDimension = this.device.limits.maxTextureDimension2D;\n        return [maxTextureDimension, maxTextureDimension];\n    }\n    /** Update the canvas drawing buffer size. Called automatically if props.autoResize is true. */\n    setDrawingBufferSize(width, height) {\n        this.canvas.width = width;\n        this.canvas.height = height;\n        this.drawingBufferWidth = width;\n        this.drawingBufferHeight = height;\n    }\n    /**\n     * Returns the current DPR (number of physical pixels per CSS pixel), if props.useDevicePixels is true\n     * @note This can be a fractional (non-integer) number, e.g. when the user zooms in the browser.\n     * @note This function handles the non-HTML canvas cases\n     */\n    getDevicePixelRatio() {\n        const dpr = typeof window !== 'undefined' && window.devicePixelRatio;\n        return dpr || 1;\n    }\n    // DEPRECATED METHODS\n    /**\n     * Maps CSS pixel position to device pixel position\n     */\n    cssToDevicePixels(cssPixel, yInvert = true) {\n        const ratio = this.cssToDeviceRatio();\n        const [width, height] = this.getDrawingBufferSize();\n        return scalePixels(cssPixel, ratio, width, height, yInvert);\n    }\n    /** @deprecated - use .getDevicePixelSize() */\n    getPixelSize() {\n        return this.getDevicePixelSize();\n    }\n    /** @deprecated - TODO which values should we use for aspect */\n    getAspect() {\n        const [width, height] = this.getDevicePixelSize();\n        return width / height;\n    }\n    /** @deprecated Returns multiplier need to convert CSS size to Device size */\n    cssToDeviceRatio() {\n        try {\n            const [drawingBufferWidth] = this.getDrawingBufferSize();\n            const [cssWidth] = this.getCSSSize();\n            return cssWidth ? drawingBufferWidth / cssWidth : 1;\n        }\n        catch {\n            return 1;\n        }\n    }\n    /** @deprecated Use canvasContext.setDrawingBufferSize() */\n    resize(size) {\n        this.setDrawingBufferSize(size.width, size.height);\n    }\n    // IMPLEMENTATION\n    /**\n     * Allows subclass constructor to override the canvas id for auto created canvases.\n     * This can really help when debugging DOM in apps that create multiple devices\n     */\n    _setAutoCreatedCanvasId(id) {\n        if (this.htmlCanvas?.id === 'lumagl-auto-created-canvas') {\n            this.htmlCanvas.id = id;\n        }\n    }\n    /** reacts to an observed intersection */\n    _handleIntersection(entries) {\n        const entry = entries.find(entry_ => entry_.target === this.canvas);\n        if (!entry) {\n            return;\n        }\n        // TODO - store intersection rectangle?\n        const isVisible = entry.isIntersecting;\n        if (this.isVisible !== isVisible) {\n            this.isVisible = isVisible;\n            this.device.props.onVisibilityChange(this);\n        }\n    }\n    /**\n     * Reacts to an observed resize by using the most accurate pixel size information the browser can provide\n     * @see https://web.dev/articles/device-pixel-content-box\n     * @see https://webgpufundamentals.org/webgpu/lessons/webgpu-resizing-the-canvas.html\n     */\n    _handleResize(entries) {\n        const entry = entries.find(entry_ => entry_.target === this.canvas);\n        if (!entry) {\n            return;\n        }\n        // Update CSS size using content box size\n        this.cssWidth = entry.contentBoxSize[0].inlineSize;\n        this.cssHeight = entry.contentBoxSize[0].blockSize;\n        // Update our drawing buffer size variables, saving the old values for logging\n        const oldPixelSize = this.getDevicePixelSize();\n        // Use the most accurate drawing buffer size information the current browser can provide\n        // Note: content box sizes are guaranteed to be integers\n        // Note: Safari falls back to contentBoxSize\n        const devicePixelWidth = entry.devicePixelContentBoxSize?.[0].inlineSize ||\n            entry.contentBoxSize[0].inlineSize * devicePixelRatio;\n        const devicePixelHeight = entry.devicePixelContentBoxSize?.[0].blockSize ||\n            entry.contentBoxSize[0].blockSize * devicePixelRatio;\n        // Make sure we don't overflow the maximum supported texture size\n        const [maxDevicePixelWidth, maxDevicePixelHeight] = this.getMaxDrawingBufferSize();\n        this.devicePixelWidth = Math.max(1, Math.min(devicePixelWidth, maxDevicePixelWidth));\n        this.devicePixelHeight = Math.max(1, Math.min(devicePixelHeight, maxDevicePixelHeight));\n        this._updateDrawingBufferSize();\n        // Inform the device\n        this.device.props.onResize(this, { oldPixelSize });\n    }\n    _updateDrawingBufferSize() {\n        // Update the canvas drawing buffer size\n        if (this.props.autoResize) {\n            if (typeof this.props.useDevicePixels === 'number') {\n                const dpr = this.props.useDevicePixels;\n                this.setDrawingBufferSize(this.cssWidth * dpr, this.cssHeight * dpr);\n            }\n            else if (this.props.useDevicePixels) {\n                this.setDrawingBufferSize(this.devicePixelWidth, this.devicePixelHeight);\n            }\n            else {\n                this.setDrawingBufferSize(this.cssWidth, this.cssHeight);\n            }\n            // Inform the subclass\n            this._updateDevice();\n        }\n        // Resolve the initialized promise\n        this._initializedResolvers.resolve();\n        this.isInitialized = true;\n        this.updatePosition();\n    }\n    /** Monitor DPR changes */\n    _observeDevicePixelRatio() {\n        const oldRatio = this.devicePixelRatio;\n        this.devicePixelRatio = window.devicePixelRatio;\n        this.updatePosition();\n        // Inform the device\n        this.device.props.onDevicePixelRatioChange(this, { oldRatio });\n        // Set up a one time query against the current resolution.\n        matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener('change', () => this._observeDevicePixelRatio(), { once: true });\n    }\n    /** Start tracking positions with a timer */\n    _trackPosition(intervalMs = 100) {\n        const intervalId = setInterval(() => {\n            if (this.destroyed) {\n                clearInterval(intervalId);\n            }\n            else {\n                this.updatePosition();\n            }\n        }, intervalMs);\n    }\n    /**\n     * Calculated the absolute position of the canvas\n     * @note - getBoundingClientRect() is normally cheap but can be expensive\n     * if called before browser has finished a reflow. Should not be the case here.\n     */\n    updatePosition() {\n        const newRect = this.htmlCanvas?.getBoundingClientRect();\n        if (newRect) {\n            // We only track position since we rely on the more precise ResizeObserver for size\n            const position = [newRect.left, newRect.top];\n            this._position ??= position;\n            const positionChanged = position[0] !== this._position[0] || position[1] !== this._position[1];\n            if (positionChanged) {\n                const oldPosition = this._position;\n                this._position = position;\n                this.device.props.onPositionChange?.(this, { oldPosition });\n            }\n        }\n    }\n}\n// HELPER FUNCTIONS\n/** Get a container element from a string or DOM element */\nfunction getContainer(container) {\n    if (typeof container === 'string') {\n        const element = document.getElementById(container);\n        if (!element) {\n            throw new Error(`${container} is not an HTML element`);\n        }\n        return element;\n    }\n    if (container) {\n        return container;\n    }\n    return document.body;\n}\n/** Get a Canvas element from DOM id */\nfunction getCanvasFromDOM(canvasId) {\n    const canvas = document.getElementById(canvasId);\n    if (!CanvasContext.isHTMLCanvas(canvas)) {\n        throw new Error('Object is not a canvas element');\n    }\n    return canvas;\n}\n/** Create a new canvas */\nfunction createCanvasElement(props) {\n    const { width, height } = props;\n    const newCanvas = document.createElement('canvas');\n    newCanvas.id = uid('lumagl-auto-created-canvas');\n    newCanvas.width = width || 1;\n    newCanvas.height = height || 1;\n    newCanvas.style.width = Number.isFinite(width) ? `${width}px` : '100%';\n    newCanvas.style.height = Number.isFinite(height) ? `${height}px` : '100%';\n    if (!props?.visible) {\n        newCanvas.style.visibility = 'hidden';\n    }\n    // Insert the canvas in the DOM\n    const container = getContainer(props?.container || null);\n    container.insertBefore(newCanvas, container.firstChild);\n    return newCanvas;\n}\n/**\n * Scales pixels linearly, handles edge cases\n * @param pixel\n * @param ratio\n * @param width\n * @param height\n * @param yInvert\n * @returns\n */\nfunction scalePixels(pixel, ratio, width, height, yInvert) {\n    const point = pixel;\n    const x = scaleX(point[0], ratio, width);\n    let y = scaleY(point[1], ratio, height, yInvert);\n    // Find boundaries of next pixel to provide valid range of device pixel locations\n    let t = scaleX(point[0] + 1, ratio, width);\n    // If next pixel's position is clamped to boundary, use it as is, otherwise subtract 1 for current pixel boundary\n    const xHigh = t === width - 1 ? t : t - 1;\n    t = scaleY(point[1] + 1, ratio, height, yInvert);\n    let yHigh;\n    if (yInvert) {\n        // If next pixel's position is clamped to boundary, use it as is, otherwise clamp it to valid range\n        t = t === 0 ? t : t + 1;\n        // swap y and yHigh\n        yHigh = y;\n        y = t;\n    }\n    else {\n        // If next pixel's position is clamped to boundary, use it as is, otherwise clamp it to valid range\n        yHigh = t === height - 1 ? t : t - 1;\n        // y remains same\n    }\n    return {\n        x,\n        y,\n        // when ratio < 1, current css pixel and next css pixel may point to same device pixel, set width/height to 1 in those cases.\n        width: Math.max(xHigh - x + 1, 1),\n        height: Math.max(yHigh - y + 1, 1)\n    };\n}\nfunction scaleX(x, ratio, width) {\n    // since we are rounding to nearest, when ratio > 1, edge pixels may point to out of bounds value, clamp to the limit\n    const r = Math.min(Math.round(x * ratio), width - 1);\n    return r;\n}\nfunction scaleY(y, ratio, height, yInvert) {\n    // since we are rounding to nearest, when ratio > 1, edge pixels may point to out of bounds value, clamp to the limit\n    return yInvert\n        ? Math.max(0, height - 1 - Math.round(y * ratio))\n        : Math.min(Math.round(y * ratio), height - 1);\n}\n//# sourceMappingURL=canvas-context.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/** Immutable Sampler object */\nexport class Sampler extends Resource {\n    static defaultProps = {\n        ...Resource.defaultProps,\n        type: 'color-sampler',\n        addressModeU: 'clamp-to-edge',\n        addressModeV: 'clamp-to-edge',\n        addressModeW: 'clamp-to-edge',\n        magFilter: 'nearest',\n        minFilter: 'nearest',\n        mipmapFilter: 'none',\n        lodMinClamp: 0,\n        lodMaxClamp: 32, // Per WebGPU spec\n        compare: 'less-equal',\n        maxAnisotropy: 1\n    };\n    get [Symbol.toStringTag]() {\n        return 'Sampler';\n    }\n    constructor(device, props) {\n        props = Sampler.normalizeProps(device, props);\n        super(device, props, Sampler.defaultProps);\n    }\n    static normalizeProps(device, props) {\n        return props;\n    }\n}\n//# sourceMappingURL=sampler.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\nimport { Sampler } from \"./sampler.js\";\nimport { log } from \"../../utils/log.js\";\nconst BASE_DIMENSIONS = {\n    '1d': '1d',\n    '2d': '2d',\n    '2d-array': '2d',\n    cube: '2d',\n    'cube-array': '2d',\n    '3d': '3d'\n};\n/**\n * Abstract Texture interface\n * Texture Object\n * https://gpuweb.github.io/gpuweb/#gputexture\n */\nexport class Texture extends Resource {\n    /** The texture can be bound for use as a sampled texture in a shader */\n    static SAMPLE = 0x04;\n    /** The texture can be bound for use as a storage texture in a shader */\n    static STORAGE = 0x08;\n    /** The texture can be used as a color or depth/stencil attachment in a render pass */\n    static RENDER = 0x10;\n    /** The texture can be used as the source of a copy operation */\n    static COPY_SRC = 0x01;\n    /** he texture can be used as the destination of a copy or write operation */\n    static COPY_DST = 0x02;\n    /** @deprecated Use Texture.SAMPLE */\n    static TEXTURE = 0x04;\n    /** @deprecated Use Texture.RENDER */\n    static RENDER_ATTACHMENT = 0x10;\n    /** dimension of this texture */\n    dimension;\n    /** base dimension of this texture */\n    baseDimension;\n    /** format of this texture */\n    format;\n    /** width in pixels of this texture */\n    width;\n    /** height in pixels of this texture */\n    height;\n    /** depth of this texture */\n    depth;\n    /** mip levels in this texture */\n    mipLevels;\n    /** \"Time\" of last update. Monotonically increasing timestamp. TODO move to AsyncTexture? */\n    updateTimestamp;\n    get [Symbol.toStringTag]() {\n        return 'Texture';\n    }\n    toString() {\n        return `Texture(${this.id},${this.format},${this.width}x${this.height})`;\n    }\n    /** Do not use directly. Create with device.createTexture() */\n    constructor(device, props) {\n        props = Texture.normalizeProps(device, props);\n        super(device, props, Texture.defaultProps);\n        this.dimension = this.props.dimension;\n        this.baseDimension = BASE_DIMENSIONS[this.dimension];\n        this.format = this.props.format;\n        // Size\n        this.width = this.props.width;\n        this.height = this.props.height;\n        this.depth = this.props.depth;\n        this.mipLevels = this.props.mipLevels;\n        // Calculate size, if not provided\n        if (this.props.width === undefined || this.props.height === undefined) {\n            if (device.isExternalImage(props.data)) {\n                const size = device.getExternalImageSize(props.data);\n                this.width = size?.width || 1;\n                this.height = size?.height || 1;\n            }\n            else {\n                this.width = 1;\n                this.height = 1;\n                if (this.props.width === undefined || this.props.height === undefined) {\n                    log.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();\n                }\n            }\n        }\n        // TODO - perhaps this should be set on async write completion?\n        this.updateTimestamp = device.incrementTimestamp();\n    }\n    /** Set sampler props associated with this texture */\n    setSampler(sampler) {\n        this.sampler = sampler instanceof Sampler ? sampler : this.device.createSampler(sampler);\n    }\n    /**\n     * Create a new texture with the same parameters and optionally a different size\n     * @note Textures are immutable and cannot be resized after creation, but we can create a similar texture with the same parameters but a new size.\n     * @note Does not copy contents of the texture\n     */\n    clone(size) {\n        return this.device.createTexture({ ...this.props, ...size });\n    }\n    /** Ensure we have integer coordinates */\n    static normalizeProps(device, props) {\n        const newProps = { ...props };\n        // Ensure we have integer coordinates\n        const { width, height } = newProps;\n        if (typeof width === 'number') {\n            newProps.width = Math.max(1, Math.ceil(width));\n        }\n        if (typeof height === 'number') {\n            newProps.height = Math.max(1, Math.ceil(height));\n        }\n        return newProps;\n    }\n    // HELPERS\n    /** Initialize texture with supplied props */\n    // eslint-disable-next-line max-statements\n    _initializeData(data) {\n        // Store opts for accessors\n        if (this.device.isExternalImage(data)) {\n            this.copyExternalImage({\n                image: data,\n                width: this.width,\n                height: this.height,\n                depth: this.depth,\n                mipLevel: 0,\n                x: 0,\n                y: 0,\n                z: 0,\n                aspect: 'all',\n                colorSpace: 'srgb',\n                premultipliedAlpha: false,\n                flipY: false\n            });\n        }\n        else if (data) {\n            this.copyImageData({\n                data,\n                // width: this.width,\n                // height: this.height,\n                // depth: this.depth,\n                mipLevel: 0,\n                x: 0,\n                y: 0,\n                z: 0,\n                aspect: 'all'\n            });\n        }\n    }\n    _normalizeCopyImageDataOptions(options_) {\n        const { width, height, depth } = this;\n        const options = { ...Texture.defaultCopyDataOptions, width, height, depth, ...options_ };\n        const info = this.device.getTextureFormatInfo(this.format);\n        if (!options_.bytesPerRow && !info.bytesPerPixel) {\n            throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);\n        }\n        options.bytesPerRow = options_.bytesPerRow || width * (info.bytesPerPixel || 4);\n        options.rowsPerImage = options_.rowsPerImage || height;\n        // WebGL will error if we try to copy outside the bounds of the texture\n        // options.width = Math.min(options.width, this.width - options.x);\n        // options.height = Math.min(options.height, this.height - options.y);\n        return options;\n    }\n    _normalizeCopyExternalImageOptions(options_) {\n        const size = this.device.getExternalImageSize(options_.image);\n        const options = { ...Texture.defaultCopyExternalImageOptions, ...size, ...options_ };\n        // WebGL will error if we try to copy outside the bounds of the texture\n        options.width = Math.min(options.width, this.width - options.x);\n        options.height = Math.min(options.height, this.height - options.y);\n        return options;\n    }\n    /** Default options */\n    static defaultProps = {\n        ...Resource.defaultProps,\n        data: null,\n        dimension: '2d',\n        format: 'rgba8unorm',\n        usage: Texture.TEXTURE | Texture.RENDER_ATTACHMENT | Texture.COPY_DST,\n        width: undefined,\n        height: undefined,\n        depth: 1,\n        mipLevels: 1,\n        samples: undefined,\n        sampler: {},\n        view: undefined\n    };\n    static defaultCopyDataOptions = {\n        data: undefined,\n        byteOffset: 0,\n        bytesPerRow: undefined,\n        rowsPerImage: undefined,\n        mipLevel: 0,\n        x: 0,\n        y: 0,\n        z: 0,\n        aspect: 'all'\n    };\n    /** Default options */\n    static defaultCopyExternalImageOptions = {\n        image: undefined,\n        sourceX: 0,\n        sourceY: 0,\n        width: undefined,\n        height: undefined,\n        depth: 1,\n        mipLevel: 0,\n        x: 0,\n        y: 0,\n        z: 0,\n        aspect: 'all',\n        colorSpace: 'srgb',\n        premultipliedAlpha: false,\n        flipY: false\n    };\n}\n//# sourceMappingURL=texture.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/** Immutable TextureView object */\nexport class TextureView extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'TextureView';\n    }\n    /** Should not be constructed directly. Use `texture.createView(props)` */\n    constructor(device, props) {\n        super(device, props, TextureView.defaultProps);\n    }\n    static defaultProps = {\n        ...Resource.defaultProps,\n        format: undefined,\n        dimension: undefined,\n        aspect: 'all',\n        baseMipLevel: 0,\n        mipLevelCount: undefined,\n        baseArrayLayer: 0,\n        arrayLayerCount: undefined\n    };\n}\n//# sourceMappingURL=texture-view.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** @returns annotated errors or warnings */\nexport function formatCompilerLog(shaderLog, source, options) {\n    let formattedLog = '';\n    const lines = source.split(/\\r?\\n/);\n    const log = shaderLog.slice().sort((a, b) => a.lineNum - b.lineNum);\n    switch (options?.showSourceCode || 'no') {\n        case 'all':\n            // Parse the error - note: browser and driver dependent\n            let currentMessage = 0;\n            for (let lineNum = 1; lineNum <= lines.length; lineNum++) {\n                formattedLog += getNumberedLine(lines[lineNum - 1], lineNum, options);\n                while (log.length > currentMessage && log[currentMessage].lineNum === lineNum) {\n                    const message = log[currentMessage++];\n                    formattedLog += formatCompilerMessage(message, lines, message.lineNum, {\n                        ...options,\n                        inlineSource: false\n                    });\n                }\n            }\n            // Print any remaining messages\n            while (log.length > currentMessage) {\n                const message = log[currentMessage++];\n                formattedLog += formatCompilerMessage(message, [], 0, {\n                    ...options,\n                    inlineSource: false\n                });\n            }\n            return formattedLog;\n        case 'issues':\n        case 'no':\n            // Parse the error - note: browser and driver dependent\n            for (const message of shaderLog) {\n                formattedLog += formatCompilerMessage(message, lines, message.lineNum, {\n                    inlineSource: options?.showSourceCode !== 'no'\n                });\n            }\n            return formattedLog;\n    }\n}\n// Helpers\n/** Format one message */\nfunction formatCompilerMessage(message, lines, lineNum, options) {\n    if (options?.inlineSource) {\n        const numberedLines = getNumberedLines(lines, lineNum);\n        // If we got error position on line add a `^^^` indicator on next line\n        const positionIndicator = message.linePos > 0 ? `${' '.repeat(message.linePos + 5)}^^^\\n` : '';\n        return `\n${numberedLines}${positionIndicator}${message.type.toUpperCase()}: ${message.message}\n\n`;\n    }\n    const color = message.type === 'error' ? 'red' : '#8B4000'; // dark orange\n    return options?.html\n        ? `<div class='luma-compiler-log-error' style=\"color:${color};\"><b> ${message.type.toUpperCase()}: ${message.message}</b></div>`\n        : `${message.type.toUpperCase()}: ${message.message}`;\n}\nfunction getNumberedLines(lines, lineNum, options) {\n    let numberedLines = '';\n    for (let lineIndex = lineNum - 2; lineIndex <= lineNum; lineIndex++) {\n        const sourceLine = lines[lineIndex - 1];\n        if (sourceLine !== undefined) {\n            numberedLines += getNumberedLine(sourceLine, lineNum, options);\n        }\n    }\n    return numberedLines;\n}\nfunction getNumberedLine(line, lineNum, options) {\n    const escapedLine = options?.html ? escapeHTML(line) : line;\n    return `${padLeft(String(lineNum), 4)}: ${escapedLine}${options?.html ? '<br/>' : '\\n'}`;\n}\n/**\n * Pads a string with a number of spaces (space characters) to the left\n * @param {String} string - string to pad\n * @param {Number} digits - number of spaces to add\n * @return {String} string - The padded string\n */\nfunction padLeft(string, paddedLength) {\n    let result = '';\n    for (let i = string.length; i < paddedLength; ++i) {\n        result += ' ';\n    }\n    return result + string;\n}\nfunction escapeHTML(unsafe) {\n    return unsafe\n        .replaceAll('&', '&amp;')\n        .replaceAll('<', '&lt;')\n        .replaceAll('>', '&gt;')\n        .replaceAll('\"', '&quot;')\n        .replaceAll(\"'\", '&#039;');\n}\n//# sourceMappingURL=format-compiler-log.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n// import { log } from '../../utils/log';\nimport { uid } from \"../../utils/uid.js\";\nimport { formatCompilerLog } from \"../../adapter-utils/format-compiler-log.js\";\n/**\n * Immutable Shader object\n * In WebGPU the handle can be copied between threads\n */\nexport class Shader extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'Shader';\n    }\n    /** The stage of this shader */\n    stage;\n    /** The source code of this shader */\n    source;\n    /** The compilation status of the shader. 'pending' if compilation is asynchronous, and on production */\n    compilationStatus = 'pending';\n    /** Create a new Shader instance */\n    constructor(device, props) {\n        props = { ...props, debugShaders: props.debugShaders || device.props.debugShaders || 'errors' };\n        super(device, { id: getShaderIdFromProps(props), ...props }, Shader.defaultProps);\n        this.stage = this.props.stage;\n        this.source = this.props.source;\n    }\n    /** Get compiler log synchronously (WebGL only) */\n    getCompilationInfoSync() {\n        return null;\n    }\n    /** Get translated shader source in host platform's native language (HLSL, GLSL, and even GLSL ES), if available */\n    getTranslatedSource() {\n        return null;\n    }\n    // PORTABLE HELPERS\n    /** In browser logging of errors */\n    async debugShader() {\n        const trigger = this.props.debugShaders;\n        switch (trigger) {\n            case 'never':\n                return;\n            case 'errors':\n                // On WebGL - Don't extract the log unless errors\n                if (this.compilationStatus === 'success') {\n                    return;\n                }\n                break;\n            case 'warnings':\n            case 'always':\n                break;\n        }\n        const messages = await this.getCompilationInfo();\n        if (trigger === 'warnings' && messages?.length === 0) {\n            return;\n        }\n        this._displayShaderLog(messages, this.id);\n    }\n    // PRIVATE\n    /**\n     * In-browser UI logging of errors\n     * TODO - this HTML formatting code should not be in Device, should be pluggable\n     */\n    _displayShaderLog(messages, shaderId) {\n        // Return if under Node.js / incomplete `document` polyfills\n        if (typeof document === 'undefined' || !document?.createElement) {\n            return;\n        }\n        const shaderName = shaderId; // getShaderName(this.source) || ;\n        const shaderTitle = `${this.stage} shader \"${shaderName}\"`;\n        let htmlLog = formatCompilerLog(messages, this.source, { showSourceCode: 'all', html: true });\n        // Show translated source if available\n        const translatedSource = this.getTranslatedSource();\n        if (translatedSource) {\n            htmlLog += `<br /><br /><h1>Translated Source</h1><br /><br /><code style=\"user-select:text;\"><pre>${translatedSource}</pre></code>`;\n        }\n        // Make it clickable so we can copy to clipboard\n        const button = document.createElement('Button');\n        button.innerHTML = `\n<h1>Compilation error in ${shaderTitle}</h1><br /><br />\n<code style=\"user-select:text;\"><pre>\n${htmlLog}\n</pre></code>`;\n        button.style.top = '10px';\n        button.style.left = '10px';\n        button.style.position = 'absolute';\n        button.style.zIndex = '9999';\n        button.style.width = '100%';\n        button.style.textAlign = 'left';\n        document.body.appendChild(button);\n        const errors = document.getElementsByClassName('luma-compiler-log-error');\n        errors[0]?.scrollIntoView();\n        // TODO - add a small embedded copy button (instead of main button)\n        button.onclick = () => {\n            // const source = this.source.replaceAll('\\n', '<br />');\n            const dataURI = `data:text/plain,${encodeURIComponent(this.source)}`;\n            navigator.clipboard.writeText(dataURI);\n        };\n        // TODO - add a small embedded close button\n    }\n    static defaultProps = {\n        ...Resource.defaultProps,\n        language: 'auto',\n        stage: undefined,\n        source: '',\n        sourceMap: null,\n        entryPoint: 'main',\n        debugShaders: undefined\n    };\n}\n// HELPERS\n/** Deduce an id, from shader source, or supplied id, or shader type */\nfunction getShaderIdFromProps(props) {\n    return getShaderName(props.source) || props.id || uid(`unnamed ${props.stage}-shader`);\n}\n/** Extracts GLSLIFY style naming of shaders: `#define SHADER_NAME ...` */\nfunction getShaderName(shader, defaultName = 'unnamed') {\n    const SHADER_NAME_REGEXP = /#define[\\s*]SHADER_NAME[\\s*]([A-Za-z0-9_-]+)[\\s*]/;\n    const match = SHADER_NAME_REGEXP.exec(shader);\n    return match ? match[1] : defaultName;\n}\n//# sourceMappingURL=shader.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\nimport { Texture } from \"./texture.js\";\nimport { log } from \"../../utils/log.js\";\n/**\n * Create new textures with correct size for all attachments.\n * @note resize() destroys existing textures (if size has changed).\n */\nexport class Framebuffer extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'Framebuffer';\n    }\n    /** Width of all attachments in this framebuffer */\n    width;\n    /** Height of all attachments in this framebuffer */\n    height;\n    constructor(device, props = {}) {\n        super(device, props, Framebuffer.defaultProps);\n        this.width = this.props.width;\n        this.height = this.props.height;\n    }\n    /**\n     * Create a copy of this framebuffer with new attached textures, with same props but of the specified size.\n     * @note Does not copy contents of the attached textures.\n     */\n    clone(size) {\n        const colorAttachments = this.colorAttachments.map(colorAttachment => colorAttachment.texture.clone(size));\n        const depthStencilAttachment = this.depthStencilAttachment && this.depthStencilAttachment.texture.clone(size);\n        return this.device.createFramebuffer({ ...this.props, colorAttachments, depthStencilAttachment });\n    }\n    resize(size) {\n        let updateSize = !size;\n        if (size) {\n            const [width, height] = Array.isArray(size) ? size : [size.width, size.height];\n            updateSize = updateSize || height !== this.height || width !== this.width;\n            this.width = width;\n            this.height = height;\n        }\n        if (updateSize) {\n            log.log(2, `Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)();\n            this.resizeAttachments(this.width, this.height);\n        }\n    }\n    /** Auto creates any textures */\n    autoCreateAttachmentTextures() {\n        if (this.props.colorAttachments.length === 0 && !this.props.depthStencilAttachment) {\n            throw new Error('Framebuffer has noattachments');\n        }\n        this.colorAttachments = this.props.colorAttachments.map((attachment, index) => {\n            if (typeof attachment === 'string') {\n                const texture = this.createColorTexture(attachment, index);\n                this.attachResource(texture);\n                return texture.view;\n            }\n            if (attachment instanceof Texture) {\n                return attachment.view;\n            }\n            return attachment;\n        });\n        const attachment = this.props.depthStencilAttachment;\n        if (attachment) {\n            if (typeof attachment === 'string') {\n                const texture = this.createDepthStencilTexture(attachment);\n                this.attachResource(texture);\n                this.depthStencilAttachment = texture.view;\n            }\n            else if (attachment instanceof Texture) {\n                this.depthStencilAttachment = attachment.view;\n            }\n            else {\n                this.depthStencilAttachment = attachment;\n            }\n        }\n    }\n    /** Create a color texture */\n    createColorTexture(format, index) {\n        return this.device.createTexture({\n            id: `${this.id}-color-attachment-${index}`,\n            usage: Texture.RENDER_ATTACHMENT,\n            format,\n            width: this.width,\n            height: this.height,\n            // TODO deprecated? - luma.gl v8 compatibility\n            sampler: {\n                magFilter: 'linear',\n                minFilter: 'linear'\n            }\n        });\n    }\n    /** Create depth stencil texture */\n    createDepthStencilTexture(format) {\n        return this.device.createTexture({\n            id: `${this.id}-depth-stencil-attachment`,\n            usage: Texture.RENDER_ATTACHMENT,\n            format,\n            width: this.width,\n            height: this.height\n        });\n    }\n    /**\n     * Default implementation of resize\n     * Creates new textures with correct size for all attachments.\n     * and destroys existing textures if owned\n     */\n    resizeAttachments(width, height) {\n        for (let i = 0; i < this.colorAttachments.length; ++i) {\n            if (this.colorAttachments[i]) {\n                const resizedTexture = this.colorAttachments[i].texture.clone({\n                    width,\n                    height\n                });\n                this.destroyAttachedResource(this.colorAttachments[i]);\n                this.colorAttachments[i] = resizedTexture.view;\n                this.attachResource(resizedTexture.view);\n            }\n        }\n        if (this.depthStencilAttachment) {\n            const resizedTexture = this.depthStencilAttachment.texture.clone({\n                width,\n                height\n            });\n            this.destroyAttachedResource(this.depthStencilAttachment);\n            this.depthStencilAttachment = resizedTexture.view;\n            this.attachResource(resizedTexture);\n        }\n        this.updateAttachments();\n    }\n    static defaultProps = {\n        ...Resource.defaultProps,\n        width: 1,\n        height: 1,\n        colorAttachments: [], // ['rgba8unorm'],\n        depthStencilAttachment: null // 'depth24plus-stencil8'\n    };\n}\n//# sourceMappingURL=framebuffer.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/**\n * A compiled and linked shader program\n */\nexport class RenderPipeline extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'RenderPipeline';\n    }\n    /** The merged layout */\n    shaderLayout;\n    /** Buffer map describing buffer interleaving etc */\n    bufferLayout;\n    /** The linking status of the pipeline. 'pending' if linking is asynchronous, and on production */\n    linkStatus = 'pending';\n    /** The hash of the pipeline */\n    hash = '';\n    constructor(device, props) {\n        super(device, props, RenderPipeline.defaultProps);\n        this.shaderLayout = this.props.shaderLayout;\n        this.bufferLayout = this.props.bufferLayout || [];\n    }\n    static defaultProps = {\n        ...Resource.defaultProps,\n        vs: null,\n        vertexEntryPoint: 'vertexMain',\n        vsConstants: {},\n        fs: null,\n        fragmentEntryPoint: 'fragmentMain',\n        fsConstants: {},\n        shaderLayout: null,\n        bufferLayout: [],\n        topology: 'triangle-list',\n        colorAttachmentFormats: undefined,\n        depthStencilAttachmentFormat: undefined,\n        parameters: {},\n        bindings: {},\n        uniforms: {}\n    };\n}\n//# sourceMappingURL=render-pipeline.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// import {Binding} from '../types/shader-layout';\nimport { Resource } from \"./resource.js\";\n/**\n * A RenderPass instance is a required parameter to all draw calls.\n *\n * It holds a combination of\n * - render targets (specified via a framebuffer)\n * - clear colors, read/write, discard information for the framebuffer attachments\n * - a couple of mutable parameters ()\n */\nexport class RenderPass extends Resource {\n    /** TODO - should be [0, 0, 0, 0], update once deck.gl tests run clean */\n    static defaultClearColor = [0, 0, 0, 1];\n    /** Depth 1.0 represents the far plance */\n    static defaultClearDepth = 1;\n    /** Clears all stencil bits */\n    static defaultClearStencil = 0;\n    get [Symbol.toStringTag]() {\n        return 'RenderPass';\n    }\n    constructor(device, props) {\n        props = RenderPass.normalizeProps(device, props);\n        super(device, props, RenderPass.defaultProps);\n    }\n    static normalizeProps(device, props) {\n        return props;\n    }\n    /** Default properties for RenderPass */\n    static defaultProps = {\n        ...Resource.defaultProps,\n        framebuffer: null,\n        parameters: undefined,\n        clearColor: RenderPass.defaultClearColor,\n        clearColors: undefined,\n        clearDepth: RenderPass.defaultClearDepth,\n        clearStencil: RenderPass.defaultClearStencil,\n        depthReadOnly: false,\n        stencilReadOnly: false,\n        discard: false,\n        occlusionQuerySet: undefined,\n        timestampQuerySet: undefined,\n        beginTimestampIndex: undefined,\n        endTimestampIndex: undefined\n    };\n}\n// TODO - Can we align WebGL implementation with WebGPU API?\n// In WebGPU the following methods are on the renderpass instead of the renderpipeline\n// luma.gl keeps them on the pipeline for now, but that has some issues.\n// abstract setPipeline(pipeline: RenderPipeline): void {}\n// abstract setIndexBuffer()\n// abstract setVertexBuffer(slot: number, buffer: Buffer, offset: number): void;\n// abstract setBindings(bindings: Record<string, Binding>): void;\n// abstract setParameters(parameters: RenderPassParameters);\n// abstract draw(options: {\n// abstract drawIndirect(indirectBuffer: GPUBuffer, indirectOffset: number): void;\n// abstract drawIndexedIndirect(indirectBuffer: GPUBuffer, indirectOffset: number): void;\n//# sourceMappingURL=render-pass.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/**\n * Encodes commands to queue that can be executed later\n */\nexport class CommandEncoder extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'CommandEncoder';\n    }\n    constructor(device, props) {\n        super(device, props, CommandEncoder.defaultProps);\n    }\n    // TODO - luma.gl has these on the device, should we align with WebGPU API?\n    // beginRenderPass(GPURenderPassDescriptor descriptor): GPURenderPassEncoder;\n    // beginComputePass(optional GPUComputePassDescriptor descriptor = {}): GPUComputePassEncoder;\n    static defaultProps = {\n        ...Resource.defaultProps,\n        measureExecutionTime: undefined\n    };\n}\n//# sourceMappingURL=command-encoder.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/**\n * Encodes commands to queue that can be executed later\n */\nexport class CommandBuffer extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'CommandBuffer';\n    }\n    constructor(device, props) {\n        super(device, props, CommandBuffer.defaultProps);\n    }\n    static defaultProps = {\n        ...Resource.defaultProps\n    };\n}\n//# sourceMappingURL=command-buffer.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** Split a uniform type string into type and components */\nexport function getVariableShaderTypeInfo(format) {\n    const decoded = UNIFORM_FORMATS[format];\n    return decoded;\n}\n/** Decodes a vertex type, returning byte length and flags (integer, signed, normalized) */\nexport function getAttributeShaderTypeInfo(attributeType) {\n    const [primitiveType, components] = TYPE_INFO[attributeType];\n    const integer = primitiveType === 'i32' || primitiveType === 'u32';\n    const signed = primitiveType !== 'u32';\n    const byteLength = PRIMITIVE_TYPE_SIZES[primitiveType] * components;\n    return {\n        primitiveType,\n        components,\n        byteLength,\n        integer,\n        signed\n    };\n}\nexport function makeShaderAttributeType(primitiveType, components) {\n    return components === 1 ? primitiveType : `vec${components}<${primitiveType}>`;\n}\nexport function resolveAttributeShaderTypeAlias(alias) {\n    return WGSL_ATTRIBUTE_TYPE_ALIAS_MAP[alias] || alias;\n}\nexport function resolveVariableShaderTypeAlias(alias) {\n    return WGSL_VARIABLE_TYPE_ALIAS_MAP[alias] || alias;\n}\n// TABLES\nconst PRIMITIVE_TYPE_SIZES = {\n    f32: 4,\n    f16: 2,\n    i32: 4,\n    u32: 4\n    // 'bool-webgl': 4,\n};\n/** All valid shader attribute types. A table guarantees exhaustive list and fast execution */\nconst TYPE_INFO = {\n    f32: ['f32', 1],\n    'vec2<f32>': ['f32', 2],\n    'vec3<f32>': ['f32', 3],\n    'vec4<f32>': ['f32', 4],\n    f16: ['f16', 1],\n    'vec2<f16>': ['f16', 2],\n    'vec3<f16>': ['f16', 3],\n    'vec4<f16>': ['f16', 4],\n    i32: ['i32', 1],\n    'vec2<i32>': ['i32', 2],\n    'vec3<i32>': ['i32', 3],\n    'vec4<i32>': ['i32', 4],\n    u32: ['u32', 1],\n    'vec2<u32>': ['u32', 2],\n    'vec3<u32>': ['u32', 3],\n    'vec4<u32>': ['u32', 4]\n};\n/** @todo These tables are quite big, consider parsing type strings instead */\nconst UNIFORM_FORMATS = {\n    f32: { type: 'f32', components: 1 },\n    f16: { type: 'f16', components: 1 },\n    i32: { type: 'i32', components: 1 },\n    u32: { type: 'u32', components: 1 },\n    // 'bool-webgl': {type: 'bool-webgl', components: 1},\n    'vec2<f32>': { type: 'f32', components: 2 },\n    'vec3<f32>': { type: 'f32', components: 3 },\n    'vec4<f32>': { type: 'f32', components: 4 },\n    'vec2<f16>': { type: 'f16', components: 2 },\n    'vec3<f16>': { type: 'f16', components: 3 },\n    'vec4<f16>': { type: 'f16', components: 4 },\n    'vec2<i32>': { type: 'i32', components: 2 },\n    'vec3<i32>': { type: 'i32', components: 3 },\n    'vec4<i32>': { type: 'i32', components: 4 },\n    'vec2<u32>': { type: 'u32', components: 2 },\n    'vec3<u32>': { type: 'u32', components: 3 },\n    'vec4<u32>': { type: 'u32', components: 4 },\n    'mat2x2<f32>': { type: 'f32', components: 4 },\n    'mat2x3<f32>': { type: 'f32', components: 6 },\n    'mat2x4<f32>': { type: 'f32', components: 8 },\n    'mat3x2<f32>': { type: 'f32', components: 6 },\n    'mat3x3<f32>': { type: 'f32', components: 9 },\n    'mat3x4<f32>': { type: 'f32', components: 12 },\n    'mat4x2<f32>': { type: 'f32', components: 8 },\n    'mat4x3<f32>': { type: 'f32', components: 12 },\n    'mat4x4<f32>': { type: 'f32', components: 16 },\n    'mat2x2<f16>': { type: 'f16', components: 4 },\n    'mat2x3<f16>': { type: 'f16', components: 6 },\n    'mat2x4<f16>': { type: 'f16', components: 8 },\n    'mat3x2<f16>': { type: 'f16', components: 6 },\n    'mat3x3<f16>': { type: 'f16', components: 9 },\n    'mat3x4<f16>': { type: 'f16', components: 12 },\n    'mat4x2<f16>': { type: 'f16', components: 8 },\n    'mat4x3<f16>': { type: 'f16', components: 12 },\n    'mat4x4<f16>': { type: 'f16', components: 16 },\n    'mat2x2<i32>': { type: 'i32', components: 4 },\n    'mat2x3<i32>': { type: 'i32', components: 6 },\n    'mat2x4<i32>': { type: 'i32', components: 8 },\n    'mat3x2<i32>': { type: 'i32', components: 6 },\n    'mat3x3<i32>': { type: 'i32', components: 9 },\n    'mat3x4<i32>': { type: 'i32', components: 12 },\n    'mat4x2<i32>': { type: 'i32', components: 8 },\n    'mat4x3<i32>': { type: 'i32', components: 12 },\n    'mat4x4<i32>': { type: 'i32', components: 16 },\n    'mat2x2<u32>': { type: 'u32', components: 4 },\n    'mat2x3<u32>': { type: 'u32', components: 6 },\n    'mat2x4<u32>': { type: 'u32', components: 8 },\n    'mat3x2<u32>': { type: 'u32', components: 6 },\n    'mat3x3<u32>': { type: 'u32', components: 9 },\n    'mat3x4<u32>': { type: 'u32', components: 12 },\n    'mat4x2<u32>': { type: 'u32', components: 8 },\n    'mat4x3<u32>': { type: 'u32', components: 12 },\n    'mat4x4<u32>': { type: 'u32', components: 16 }\n};\n/**  Predeclared aliases @see https://www.w3.org/TR/WGSL/#vector-types */\nexport const WGSL_ATTRIBUTE_TYPE_ALIAS_MAP = {\n    vec2i: 'vec2<i32>',\n    vec3i: 'vec3<i32>',\n    vec4i: 'vec4<i32>',\n    vec2u: 'vec2<u32>',\n    vec3u: 'vec3<u32>',\n    vec4u: 'vec4<u32>',\n    vec2f: 'vec2<f32>',\n    vec3f: 'vec3<f32>',\n    vec4f: 'vec4<f32>',\n    // Requires the f16 extension.\n    vec2h: 'vec2<f16>',\n    vec3h: 'vec3<f16>',\n    vec4h: 'vec4<f16>'\n};\n/** @todo These tables are quite big, consider parsing alias strings instead */\nexport const WGSL_VARIABLE_TYPE_ALIAS_MAP = {\n    ...WGSL_ATTRIBUTE_TYPE_ALIAS_MAP,\n    mat2x2f: 'mat2x2<f32>',\n    mat2x3f: 'mat2x3<f32>',\n    mat2x4f: 'mat2x4<f32>',\n    mat3x2f: 'mat3x2<f32>',\n    mat3x3f: 'mat3x3<f32>',\n    mat3x4f: 'mat3x4<f32>',\n    mat4x2f: 'mat4x2<f32>',\n    mat4x3f: 'mat4x3<f32>',\n    mat4x4f: 'mat4x4<f32>',\n    mat2x2i: 'mat2x2<i32>',\n    mat2x3i: 'mat2x3<i32>',\n    mat2x4i: 'mat2x4<i32>',\n    mat3x2i: 'mat3x2<i32>',\n    mat3x3i: 'mat3x3<i32>',\n    mat3x4i: 'mat3x4<i32>',\n    mat4x2i: 'mat4x2<i32>',\n    mat4x3i: 'mat4x3<i32>',\n    mat4x4i: 'mat4x4<i32>',\n    mat2x2u: 'mat2x2<u32>',\n    mat2x3u: 'mat2x3<u32>',\n    mat2x4u: 'mat2x4<u32>',\n    mat3x2u: 'mat3x2<u32>',\n    mat3x3u: 'mat3x3<u32>',\n    mat3x4u: 'mat3x4<u32>',\n    mat4x2u: 'mat4x2<u32>',\n    mat4x3u: 'mat4x3<u32>',\n    mat4x4u: 'mat4x4<u32>',\n    mat2x2h: 'mat2x2<f16>',\n    mat2x3h: 'mat2x3<f16>',\n    mat2x4h: 'mat2x4<f16>',\n    mat3x2h: 'mat3x2<f16>',\n    mat3x3h: 'mat3x3<f16>',\n    mat3x4h: 'mat3x4<f16>',\n    mat4x2h: 'mat4x2<f16>',\n    mat4x3h: 'mat4x3<f16>',\n    mat4x4h: 'mat4x4<f16>'\n};\n//# sourceMappingURL=decode-shader-types.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { log } from \"../utils/log.js\";\nimport { getAttributeShaderTypeInfo } from \"../shadertypes/data-types/decode-shader-types.js\";\nimport { getVertexFormatInfo, getCompatibleVertexFormat } from \"../shadertypes/vertex-arrays/decode-vertex-format.js\";\n/**\n * Map from \"attribute names\" to \"resolved attribute infos\"\n * containing information about both buffer layouts and shader attribute declarations\n */\nexport function getAttributeInfosFromLayouts(shaderLayout, bufferLayout) {\n    const attributeInfos = {};\n    for (const attribute of shaderLayout.attributes) {\n        const attributeInfo = getAttributeInfoFromLayouts(shaderLayout, bufferLayout, attribute.name);\n        if (attributeInfo) {\n            attributeInfos[attribute.name] = attributeInfo;\n        }\n    }\n    return attributeInfos;\n}\n/**\n * Array indexed by \"location\" holding \"resolved attribute infos\"\n */\nexport function getAttributeInfosByLocation(shaderLayout, bufferLayout, maxVertexAttributes = 16) {\n    const attributeInfos = getAttributeInfosFromLayouts(shaderLayout, bufferLayout);\n    const locationInfos = new Array(maxVertexAttributes).fill(null);\n    for (const attributeInfo of Object.values(attributeInfos)) {\n        locationInfos[attributeInfo.location] = attributeInfo;\n    }\n    return locationInfos;\n}\n/**\n * Get the combined information from a shader layout and a buffer layout for a specific attribute\n */\nfunction getAttributeInfoFromLayouts(shaderLayout, bufferLayout, name) {\n    const shaderDeclaration = getAttributeFromShaderLayout(shaderLayout, name);\n    const bufferMapping = getAttributeFromBufferLayout(bufferLayout, name);\n    // TODO should no longer happen\n    if (!shaderDeclaration) {\n        //  || !bufferMapping\n        return null;\n    }\n    const attributeTypeInfo = getAttributeShaderTypeInfo(shaderDeclaration.type);\n    const defaultVertexFormat = getCompatibleVertexFormat(attributeTypeInfo);\n    const vertexFormat = bufferMapping?.vertexFormat || defaultVertexFormat;\n    const vertexFormatInfo = getVertexFormatInfo(vertexFormat);\n    return {\n        attributeName: bufferMapping?.attributeName || shaderDeclaration.name,\n        bufferName: bufferMapping?.bufferName || shaderDeclaration.name,\n        location: shaderDeclaration.location,\n        shaderType: shaderDeclaration.type,\n        primitiveType: attributeTypeInfo.primitiveType,\n        shaderComponents: attributeTypeInfo.components,\n        vertexFormat,\n        bufferDataType: vertexFormatInfo.type,\n        bufferComponents: vertexFormatInfo.components,\n        // normalized is a property of the buffer's vertex format\n        normalized: vertexFormatInfo.normalized,\n        // integer is a property of the shader declaration\n        integer: attributeTypeInfo.integer,\n        stepMode: bufferMapping?.stepMode || shaderDeclaration.stepMode || 'vertex',\n        byteOffset: bufferMapping?.byteOffset || 0,\n        byteStride: bufferMapping?.byteStride || 0\n    };\n}\nfunction getAttributeFromShaderLayout(shaderLayout, name) {\n    const attribute = shaderLayout.attributes.find(attr => attr.name === name);\n    if (!attribute) {\n        log.warn(`shader layout attribute \"${name}\" not present in shader`);\n    }\n    return attribute || null;\n}\nfunction getAttributeFromBufferLayout(bufferLayouts, name) {\n    // Check that bufferLayouts are valid (each either has format or attribute)\n    checkBufferLayouts(bufferLayouts);\n    let bufferLayoutInfo = getAttributeFromShortHand(bufferLayouts, name);\n    if (bufferLayoutInfo) {\n        return bufferLayoutInfo;\n    }\n    bufferLayoutInfo = getAttributeFromAttributesList(bufferLayouts, name);\n    if (bufferLayoutInfo) {\n        return bufferLayoutInfo;\n    }\n    // Didn't find...\n    log.warn(`layout for attribute \"${name}\" not present in buffer layout`);\n    return null;\n}\n/** Check that bufferLayouts are valid (each either has format or attribute) */\nfunction checkBufferLayouts(bufferLayouts) {\n    for (const bufferLayout of bufferLayouts) {\n        if ((bufferLayout.attributes && bufferLayout.format) ||\n            (!bufferLayout.attributes && !bufferLayout.format)) {\n            log.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`);\n        }\n    }\n}\n/** Get attribute from format shorthand if specified */\nfunction getAttributeFromShortHand(bufferLayouts, name) {\n    for (const bufferLayout of bufferLayouts) {\n        if (bufferLayout.format && bufferLayout.name === name) {\n            return {\n                attributeName: bufferLayout.name,\n                bufferName: name,\n                stepMode: bufferLayout.stepMode,\n                vertexFormat: bufferLayout.format,\n                // If offset is needed, use `attributes` field.\n                byteOffset: 0,\n                byteStride: bufferLayout.byteStride || 0\n            };\n        }\n    }\n    return null;\n}\n/**\n * Search attribute mappings (e.g. interleaved attributes) for buffer mapping.\n * Not the name of the buffer might be the same as one of the interleaved attributes.\n */\nfunction getAttributeFromAttributesList(bufferLayouts, name) {\n    for (const bufferLayout of bufferLayouts) {\n        let byteStride = bufferLayout.byteStride;\n        // Calculate a default byte stride if not provided\n        if (typeof bufferLayout.byteStride !== 'number') {\n            for (const attributeMapping of bufferLayout.attributes || []) {\n                const info = getVertexFormatInfo(attributeMapping.format);\n                // @ts-ignore\n                byteStride += info.byteLength;\n            }\n        }\n        const attributeMapping = bufferLayout.attributes?.find(mapping => mapping.attribute === name);\n        if (attributeMapping) {\n            return {\n                attributeName: attributeMapping.attribute,\n                bufferName: bufferLayout.name,\n                stepMode: bufferLayout.stepMode,\n                vertexFormat: attributeMapping.format,\n                byteOffset: attributeMapping.byteOffset,\n                // @ts-ignore\n                byteStride\n            };\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=get-attribute-from-layouts.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { getAttributeInfosByLocation } from \"../../adapter-utils/get-attribute-from-layouts.js\";\nimport { Resource } from \"./resource.js\";\n/**\n * Stores attribute bindings.\n * Makes it easy to share a render pipeline and use separate vertex arrays.\n * @note On WebGL, VertexArray allows non-constant bindings to be performed in advance\n * reducing the number of WebGL calls per draw call.\n * @note On WebGPU this is just a convenience class that collects the bindings.\n */\nexport class VertexArray extends Resource {\n    static defaultProps = {\n        ...Resource.defaultProps,\n        shaderLayout: undefined,\n        bufferLayout: []\n    };\n    get [Symbol.toStringTag]() {\n        return 'VertexArray';\n    }\n    /** Max number of vertex attributes */\n    maxVertexAttributes;\n    /** Attribute infos indexed by location - TODO only needed by webgl module? */\n    attributeInfos;\n    /** Index buffer */\n    indexBuffer = null;\n    /** Attributes indexed by buffer slot */\n    attributes;\n    constructor(device, props) {\n        super(device, props, VertexArray.defaultProps);\n        this.maxVertexAttributes = device.limits.maxVertexAttributes;\n        this.attributes = new Array(this.maxVertexAttributes).fill(null);\n        this.attributeInfos = getAttributeInfosByLocation(props.shaderLayout, props.bufferLayout, this.maxVertexAttributes);\n    }\n    // DEPRECATED METHODS\n    /** @deprecated Set constant attributes (WebGL only) */\n    setConstantWebGL(location, value) {\n        this.device.reportError(new Error('constant attributes not supported'), this)();\n    }\n}\n//# sourceMappingURL=vertex-array.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/** Holds a set of output buffers for pipeline (WebGL only) */\nexport class TransformFeedback extends Resource {\n    static defaultProps = {\n        ...Resource.defaultProps,\n        layout: undefined,\n        buffers: {}\n    };\n    get [Symbol.toStringTag]() {\n        return 'TransformFeedback';\n    }\n    constructor(device, props) {\n        super(device, props, TransformFeedback.defaultProps);\n    }\n}\n//# sourceMappingURL=transform-feedback.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Resource } from \"./resource.js\";\n/** Immutable QuerySet object */\nexport class QuerySet extends Resource {\n    get [Symbol.toStringTag]() {\n        return 'QuerySet';\n    }\n    constructor(device, props) {\n        super(device, props, QuerySet.defaultProps);\n    }\n    static defaultProps = {\n        ...Resource.defaultProps,\n        type: undefined,\n        count: undefined\n    };\n}\n//# sourceMappingURL=query-set.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nlet arrayBuffer;\nexport function getScratchArrayBuffer(byteLength) {\n    if (!arrayBuffer || arrayBuffer.byteLength < byteLength) {\n        arrayBuffer = new ArrayBuffer(byteLength);\n    }\n    return arrayBuffer;\n}\nexport function getScratchArray(Type, length) {\n    const scratchArrayBuffer = getScratchArrayBuffer(Type.BYTES_PER_ELEMENT * length);\n    return new Type(scratchArrayBuffer, 0, length); // arrayBuffer, byteOffset, length (in elements)\n}\n//# sourceMappingURL=array-utils-flat.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// @ts-nocheck TODO fix\n// Tables describing WebGL parameters\nimport { GL } from '@luma.gl/constants';\n// DEFAULT SETTINGS - FOR FAST CACHE INITIALIZATION AND CONTEXT RESETS\n/* eslint-disable no-shadow */\nexport const GL_PARAMETER_DEFAULTS = {\n    [3042]: false,\n    [32773]: new Float32Array([0, 0, 0, 0]),\n    [32777]: 32774,\n    [34877]: 32774,\n    [32969]: 1,\n    [32968]: 0,\n    [32971]: 1,\n    [32970]: 0,\n    [3106]: new Float32Array([0, 0, 0, 0]), // TBD\n    [3107]: [true, true, true, true],\n    [2884]: false,\n    [2885]: 1029,\n    [2929]: false,\n    [2931]: 1,\n    [2932]: 513,\n    [2928]: new Float32Array([0, 1]), // TBD\n    [2930]: true,\n    [3024]: true,\n    [35725]: null,\n    // FRAMEBUFFER_BINDING and DRAW_FRAMEBUFFER_BINDING(WebGL2) refer same state.\n    [36006]: null,\n    [36007]: null,\n    [34229]: null,\n    [34964]: null,\n    [2886]: 2305,\n    [33170]: 4352,\n    [2849]: 1,\n    [32823]: false,\n    [32824]: 0,\n    [10752]: 0,\n    [32926]: false,\n    [32928]: false,\n    [32938]: 1.0,\n    [32939]: false,\n    [3089]: false,\n    // Note: Dynamic value. If scissor test enabled we expect users to set correct scissor box\n    [3088]: new Int32Array([0, 0, 1024, 1024]),\n    [2960]: false,\n    [2961]: 0,\n    [2968]: 0xffffffff,\n    [36005]: 0xffffffff,\n    [2962]: 519,\n    [2967]: 0,\n    [2963]: 0xffffffff,\n    [34816]: 519,\n    [36003]: 0,\n    [36004]: 0xffffffff,\n    [2964]: 7680,\n    [2965]: 7680,\n    [2966]: 7680,\n    [34817]: 7680,\n    [34818]: 7680,\n    [34819]: 7680,\n    // Dynamic value: We use [0, 0, 1024, 1024] as default, but usually this is updated in each frame.\n    [2978]: [0, 0, 1024, 1024],\n    [36389]: null,\n    [36662]: null,\n    [36663]: null,\n    [35053]: null,\n    [35055]: null,\n    [35723]: 4352,\n    [36010]: null,\n    [35977]: false,\n    [3333]: 4,\n    [3317]: 4,\n    [37440]: false,\n    [37441]: false,\n    [37443]: 37444,\n    [3330]: 0,\n    [3332]: 0,\n    [3331]: 0,\n    [3314]: 0,\n    [32878]: 0,\n    [3316]: 0,\n    [3315]: 0,\n    [32877]: 0\n};\n// SETTER TABLES - ENABLES SETTING ANY PARAMETER WITH A COMMON API\nconst enable = (gl, value, key) => value ? gl.enable(key) : gl.disable(key);\nconst hint = (gl, value, key) => gl.hint(key, value);\nconst pixelStorei = (gl, value, key) => gl.pixelStorei(key, value);\nconst bindFramebuffer = (gl, value, key) => {\n    const target = key === 36006 ? 36009 : 36008;\n    return gl.bindFramebuffer(target, value);\n};\nconst bindBuffer = (gl, value, key) => {\n    const bindingMap = {\n        [34964]: 34962,\n        [36662]: 36662,\n        [36663]: 36663,\n        [35053]: 35051,\n        [35055]: 35052\n    };\n    const glTarget = bindingMap[key];\n    gl.bindBuffer(glTarget, value);\n};\n// Utility\nfunction isArray(array) {\n    return Array.isArray(array) || (ArrayBuffer.isView(array) && !(array instanceof DataView));\n}\n// Map from WebGL parameter names to corresponding WebGL setter functions\n// WegGL constants are read by parameter names, but set by function names\n// NOTE: When value type is a string, it will be handled by 'GL_COMPOSITE_PARAMETER_SETTERS'\nexport const GL_PARAMETER_SETTERS = {\n    [3042]: enable,\n    [32773]: (gl, value) => gl.blendColor(...value),\n    [32777]: 'blendEquation',\n    [34877]: 'blendEquation',\n    [32969]: 'blendFunc',\n    [32968]: 'blendFunc',\n    [32971]: 'blendFunc',\n    [32970]: 'blendFunc',\n    [3106]: (gl, value) => gl.clearColor(...value),\n    [3107]: (gl, value) => gl.colorMask(...value),\n    [2884]: enable,\n    [2885]: (gl, value) => gl.cullFace(value),\n    [2929]: enable,\n    [2931]: (gl, value) => gl.clearDepth(value),\n    [2932]: (gl, value) => gl.depthFunc(value),\n    [2928]: (gl, value) => gl.depthRange(...value),\n    [2930]: (gl, value) => gl.depthMask(value),\n    [3024]: enable,\n    [35723]: hint,\n    [35725]: (gl, value) => gl.useProgram(value),\n    [36007]: (gl, value) => gl.bindRenderbuffer(36161, value),\n    [36389]: (gl, value) => gl.bindTransformFeedback?.(36386, value),\n    [34229]: (gl, value) => gl.bindVertexArray(value),\n    // NOTE: FRAMEBUFFER_BINDING and DRAW_FRAMEBUFFER_BINDING(WebGL2) refer same state.\n    [36006]: bindFramebuffer,\n    [36010]: bindFramebuffer,\n    // Buffers\n    [34964]: bindBuffer,\n    [36662]: bindBuffer,\n    [36663]: bindBuffer,\n    [35053]: bindBuffer,\n    [35055]: bindBuffer,\n    [2886]: (gl, value) => gl.frontFace(value),\n    [33170]: hint,\n    [2849]: (gl, value) => gl.lineWidth(value),\n    [32823]: enable,\n    [32824]: 'polygonOffset',\n    [10752]: 'polygonOffset',\n    [35977]: enable,\n    [32926]: enable,\n    [32928]: enable,\n    [32938]: 'sampleCoverage',\n    [32939]: 'sampleCoverage',\n    [3089]: enable,\n    [3088]: (gl, value) => gl.scissor(...value),\n    [2960]: enable,\n    [2961]: (gl, value) => gl.clearStencil(value),\n    [2968]: (gl, value) => gl.stencilMaskSeparate(1028, value),\n    [36005]: (gl, value) => gl.stencilMaskSeparate(1029, value),\n    [2962]: 'stencilFuncFront',\n    [2967]: 'stencilFuncFront',\n    [2963]: 'stencilFuncFront',\n    [34816]: 'stencilFuncBack',\n    [36003]: 'stencilFuncBack',\n    [36004]: 'stencilFuncBack',\n    [2964]: 'stencilOpFront',\n    [2965]: 'stencilOpFront',\n    [2966]: 'stencilOpFront',\n    [34817]: 'stencilOpBack',\n    [34818]: 'stencilOpBack',\n    [34819]: 'stencilOpBack',\n    [2978]: (gl, value) => gl.viewport(...value),\n    // WEBGL2 EXTENSIONS\n    // EXT_depth_clamp https://registry.khronos.org/webgl/extensions/EXT_depth_clamp/\n    [34383]: enable,\n    // WEBGL_provoking_vertex https://registry.khronos.org/webgl/extensions/WEBGL_provoking_vertex/\n    // [GL.PROVOKING_VERTEX_WEBL]: TODO - extension function needed\n    // WEBGL_polygon_mode https://registry.khronos.org/webgl/extensions/WEBGL_polygon_mode/\n    // POLYGON_MODE_WEBGL  TODO - extension function needed\n    [10754]: enable,\n    // WEBGL_clip_cull_distance https://registry.khronos.org/webgl/extensions/WEBGL_clip_cull_distance/\n    [12288]: enable,\n    [12289]: enable,\n    [12290]: enable,\n    [12291]: enable,\n    [12292]: enable,\n    [12293]: enable,\n    [12294]: enable,\n    [12295]: enable,\n    // PIXEL PACK/UNPACK MODES\n    [3333]: pixelStorei,\n    [3317]: pixelStorei,\n    [37440]: pixelStorei,\n    [37441]: pixelStorei,\n    [37443]: pixelStorei,\n    [3330]: pixelStorei,\n    [3332]: pixelStorei,\n    [3331]: pixelStorei,\n    [3314]: pixelStorei,\n    [32878]: pixelStorei,\n    [3316]: pixelStorei,\n    [3315]: pixelStorei,\n    [32877]: pixelStorei,\n    // Function-style setters\n    framebuffer: (gl, framebuffer) => {\n        // accepts 1) a WebGLFramebuffer 2) null (default framebuffer), or 3) luma.gl Framebuffer class\n        // framebuffer is null when restoring to default framebuffer, otherwise use the WebGL handle.\n        const handle = framebuffer && 'handle' in framebuffer ? framebuffer.handle : framebuffer;\n        return gl.bindFramebuffer(36160, handle);\n    },\n    blend: (gl, value) => value ? gl.enable(3042) : gl.disable(3042),\n    blendColor: (gl, value) => gl.blendColor(...value),\n    blendEquation: (gl, args) => {\n        const separateModes = typeof args === 'number' ? [args, args] : args;\n        gl.blendEquationSeparate(...separateModes);\n    },\n    blendFunc: (gl, args) => {\n        const separateFuncs = args?.length === 2 ? [...args, ...args] : args;\n        gl.blendFuncSeparate(...separateFuncs);\n    },\n    clearColor: (gl, value) => gl.clearColor(...value),\n    clearDepth: (gl, value) => gl.clearDepth(value),\n    clearStencil: (gl, value) => gl.clearStencil(value),\n    colorMask: (gl, value) => gl.colorMask(...value),\n    cull: (gl, value) => value ? gl.enable(2884) : gl.disable(2884),\n    cullFace: (gl, value) => gl.cullFace(value),\n    depthTest: (gl, value) => value ? gl.enable(2929) : gl.disable(2929),\n    depthFunc: (gl, value) => gl.depthFunc(value),\n    depthMask: (gl, value) => gl.depthMask(value),\n    depthRange: (gl, value) => gl.depthRange(...value),\n    dither: (gl, value) => value ? gl.enable(3024) : gl.disable(3024),\n    derivativeHint: (gl, value) => {\n        // gl1: 'OES_standard_derivatives'\n        gl.hint(35723, value);\n    },\n    frontFace: (gl, value) => gl.frontFace(value),\n    mipmapHint: (gl, value) => gl.hint(33170, value),\n    lineWidth: (gl, value) => gl.lineWidth(value),\n    polygonOffsetFill: (gl, value) => value ? gl.enable(32823) : gl.disable(32823),\n    polygonOffset: (gl, value) => gl.polygonOffset(...value),\n    sampleCoverage: (gl, value) => gl.sampleCoverage(value[0], value[1] || false),\n    scissorTest: (gl, value) => value ? gl.enable(3089) : gl.disable(3089),\n    scissor: (gl, value) => gl.scissor(...value),\n    stencilTest: (gl, value) => value ? gl.enable(2960) : gl.disable(2960),\n    stencilMask: (gl, value) => {\n        value = isArray(value) ? value : [value, value];\n        const [mask, backMask] = value;\n        gl.stencilMaskSeparate(1028, mask);\n        gl.stencilMaskSeparate(1029, backMask);\n    },\n    stencilFunc: (gl, args) => {\n        args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n        const [func, ref, mask, backFunc, backRef, backMask] = args;\n        gl.stencilFuncSeparate(1028, func, ref, mask);\n        gl.stencilFuncSeparate(1029, backFunc, backRef, backMask);\n    },\n    stencilOp: (gl, args) => {\n        args = isArray(args) && args.length === 3 ? [...args, ...args] : args;\n        const [sfail, dpfail, dppass, backSfail, backDpfail, backDppass] = args;\n        gl.stencilOpSeparate(1028, sfail, dpfail, dppass);\n        gl.stencilOpSeparate(1029, backSfail, backDpfail, backDppass);\n    },\n    viewport: (gl, value) => gl.viewport(...value)\n};\nfunction getValue(glEnum, values, cache) {\n    return values[glEnum] !== undefined ? values[glEnum] : cache[glEnum];\n}\n// COMPOSITE_WEBGL_PARAMETER_\nexport const GL_COMPOSITE_PARAMETER_SETTERS = {\n    blendEquation: (gl, values, cache) => gl.blendEquationSeparate(getValue(32777, values, cache), getValue(34877, values, cache)),\n    blendFunc: (gl, values, cache) => gl.blendFuncSeparate(getValue(32969, values, cache), getValue(32968, values, cache), getValue(32971, values, cache), getValue(32970, values, cache)),\n    polygonOffset: (gl, values, cache) => gl.polygonOffset(getValue(32824, values, cache), getValue(10752, values, cache)),\n    sampleCoverage: (gl, values, cache) => gl.sampleCoverage(getValue(32938, values, cache), getValue(32939, values, cache)),\n    stencilFuncFront: (gl, values, cache) => gl.stencilFuncSeparate(1028, getValue(2962, values, cache), getValue(2967, values, cache), getValue(2963, values, cache)),\n    stencilFuncBack: (gl, values, cache) => gl.stencilFuncSeparate(1029, getValue(34816, values, cache), getValue(36003, values, cache), getValue(36004, values, cache)),\n    stencilOpFront: (gl, values, cache) => gl.stencilOpSeparate(1028, getValue(2964, values, cache), getValue(2965, values, cache), getValue(2966, values, cache)),\n    stencilOpBack: (gl, values, cache) => gl.stencilOpSeparate(1029, getValue(34817, values, cache), getValue(34818, values, cache), getValue(34819, values, cache))\n};\n// Setter functions intercepted for cache updates\nexport const GL_HOOKED_SETTERS = {\n    // GENERIC SETTERS\n    enable: (update, capability) => update({\n        [capability]: true\n    }),\n    disable: (update, capability) => update({\n        [capability]: false\n    }),\n    pixelStorei: (update, pname, value) => update({\n        [pname]: value\n    }),\n    hint: (update, pname, value) => update({\n        [pname]: value\n    }),\n    // SPECIFIC SETTERS\n    useProgram: (update, value) => update({\n        [35725]: value\n    }),\n    bindRenderbuffer: (update, target, value) => update({\n        [36007]: value\n    }),\n    bindTransformFeedback: (update, target, value) => update({\n        [36389]: value\n    }),\n    bindVertexArray: (update, value) => update({\n        [34229]: value\n    }),\n    bindFramebuffer: (update, target, framebuffer) => {\n        switch (target) {\n            case 36160:\n                return update({\n                    [36006]: framebuffer,\n                    [36010]: framebuffer\n                });\n            case 36009:\n                return update({ [36006]: framebuffer });\n            case 36008:\n                return update({ [36010]: framebuffer });\n            default:\n                return null;\n        }\n    },\n    bindBuffer: (update, target, buffer) => {\n        const pname = {\n            [34962]: [34964],\n            [36662]: [36662],\n            [36663]: [36663],\n            [35051]: [35053],\n            [35052]: [35055]\n        }[target];\n        if (pname) {\n            return update({ [pname]: buffer });\n        }\n        // targets that should not be cached\n        return { valueChanged: true };\n    },\n    blendColor: (update, r, g, b, a) => update({\n        [32773]: new Float32Array([r, g, b, a])\n    }),\n    blendEquation: (update, mode) => update({\n        [32777]: mode,\n        [34877]: mode\n    }),\n    blendEquationSeparate: (update, modeRGB, modeAlpha) => update({\n        [32777]: modeRGB,\n        [34877]: modeAlpha\n    }),\n    blendFunc: (update, src, dst) => update({\n        [32969]: src,\n        [32968]: dst,\n        [32971]: src,\n        [32970]: dst\n    }),\n    blendFuncSeparate: (update, srcRGB, dstRGB, srcAlpha, dstAlpha) => update({\n        [32969]: srcRGB,\n        [32968]: dstRGB,\n        [32971]: srcAlpha,\n        [32970]: dstAlpha\n    }),\n    clearColor: (update, r, g, b, a) => update({\n        [3106]: new Float32Array([r, g, b, a])\n    }),\n    clearDepth: (update, depth) => update({\n        [2931]: depth\n    }),\n    clearStencil: (update, s) => update({\n        [2961]: s\n    }),\n    colorMask: (update, r, g, b, a) => update({\n        [3107]: [r, g, b, a]\n    }),\n    cullFace: (update, mode) => update({\n        [2885]: mode\n    }),\n    depthFunc: (update, func) => update({\n        [2932]: func\n    }),\n    depthRange: (update, zNear, zFar) => update({\n        [2928]: new Float32Array([zNear, zFar])\n    }),\n    depthMask: (update, mask) => update({\n        [2930]: mask\n    }),\n    frontFace: (update, face) => update({\n        [2886]: face\n    }),\n    lineWidth: (update, width) => update({\n        [2849]: width\n    }),\n    polygonOffset: (update, factor, units) => update({\n        [32824]: factor,\n        [10752]: units\n    }),\n    sampleCoverage: (update, value, invert) => update({\n        [32938]: value,\n        [32939]: invert\n    }),\n    scissor: (update, x, y, width, height) => update({\n        [3088]: new Int32Array([x, y, width, height])\n    }),\n    stencilMask: (update, mask) => update({\n        [2968]: mask,\n        [36005]: mask\n    }),\n    stencilMaskSeparate: (update, face, mask) => update({\n        [face === 1028 ? 2968 : 36005]: mask\n    }),\n    stencilFunc: (update, func, ref, mask) => update({\n        [2962]: func,\n        [2967]: ref,\n        [2963]: mask,\n        [34816]: func,\n        [36003]: ref,\n        [36004]: mask\n    }),\n    stencilFuncSeparate: (update, face, func, ref, mask) => update({\n        [face === 1028 ? 2962 : 34816]: func,\n        [face === 1028 ? 2967 : 36003]: ref,\n        [face === 1028 ? 2963 : 36004]: mask\n    }),\n    stencilOp: (update, fail, zfail, zpass) => update({\n        [2964]: fail,\n        [2965]: zfail,\n        [2966]: zpass,\n        [34817]: fail,\n        [34818]: zfail,\n        [34819]: zpass\n    }),\n    stencilOpSeparate: (update, face, fail, zfail, zpass) => update({\n        [face === 1028 ? 2964 : 34817]: fail,\n        [face === 1028 ? 2965 : 34818]: zfail,\n        [face === 1028 ? 2966 : 34819]: zpass\n    }),\n    viewport: (update, x, y, width, height) => update({\n        [2978]: [x, y, width, height]\n    })\n};\n// GETTER TABLE - FOR READING OUT AN ENTIRE CONTEXT\nconst isEnabled = (gl, key) => gl.isEnabled(key);\n// Exceptions for any keys that cannot be queried by gl.getParameters\nexport const GL_PARAMETER_GETTERS = {\n    [3042]: isEnabled,\n    [2884]: isEnabled,\n    [2929]: isEnabled,\n    [3024]: isEnabled,\n    [32823]: isEnabled,\n    [32926]: isEnabled,\n    [32928]: isEnabled,\n    [3089]: isEnabled,\n    [2960]: isEnabled,\n    [35977]: isEnabled\n};\nexport const NON_CACHE_PARAMETERS = new Set([\n    34016,\n    36388,\n    36387,\n    35983,\n    35368,\n    34965,\n    35739,\n    35738,\n    3074,\n    34853,\n    34854,\n    34855,\n    34856,\n    34857,\n    34858,\n    34859,\n    34860,\n    34861,\n    34862,\n    34863,\n    34864,\n    34865,\n    34866,\n    34867,\n    34868,\n    35097,\n    32873,\n    35869,\n    32874,\n    34068\n]);\n//# sourceMappingURL=webgl-parameter-tables.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL_PARAMETER_DEFAULTS, GL_PARAMETER_SETTERS, GL_COMPOSITE_PARAMETER_SETTERS, GL_PARAMETER_GETTERS } from \"./webgl-parameter-tables.js\";\n/**\n * Sets any GL parameter regardless of function (gl.blendMode, ...)\n *\n * @note requires a `cache` object to be set on the context (gl.state.cache)\n * This object is used to fill in any missing values for composite setter functions\n */\nexport function setGLParameters(gl, parameters) {\n    if (isObjectEmpty(parameters)) {\n        return;\n    }\n    const compositeSetters = {};\n    // HANDLE PRIMITIVE SETTERS (and make note of any composite setters)\n    for (const key in parameters) {\n        const glConstant = Number(key);\n        // @ts-ignore TODO\n        const setter = GL_PARAMETER_SETTERS[key];\n        if (setter) {\n            // Composite setters should only be called once, so save them\n            if (typeof setter === 'string') {\n                // @ts-ignore TODO\n                compositeSetters[setter] = true;\n            }\n            else {\n                // if (gl[glConstant] !== undefined) {\n                // TODO - added above check since this is being called on WebGL2 parameters in WebGL1...\n                // TODO - deep equal on values? only call setter if value has changed?\n                // NOTE - the setter will automatically update this.state\n                // @ts-ignore TODO\n                setter(gl, parameters[key], glConstant);\n            }\n        }\n    }\n    // HANDLE COMPOSITE SETTERS\n    // NOTE: any non-provided values needed by composite setters are filled in from state cache\n    // The cache parameter is automatically retrieved from the context\n    // This depends on `trackContextState`, which is technically a \"circular\" dependency.\n    // But it is too inconvenient to always require a cache parameter here.\n    // This is the ONLY external dependency in this module/\n    // @ts-expect-error\n    const cache = gl.state && gl.state.cache;\n    if (cache) {\n        for (const key in compositeSetters) {\n            // TODO - avoid calling composite setters if values have not changed.\n            // @ts-ignore TODO\n            const compositeSetter = GL_COMPOSITE_PARAMETER_SETTERS[key];\n            // Note - if `trackContextState` has been called,\n            // the setter will automatically update this.state.cache\n            compositeSetter(gl, parameters, cache);\n        }\n    }\n    // Add a log for the else case?\n}\n/**\n * Reads the entire WebGL state from a context\n\n  // default to querying all parameters\n\n  * @returns - a newly created map, with values keyed by GL parameters\n *\n * @note Copies the state from a context (gl.getParameter should not be overriden)\n * Reads the entire WebGL state from a context\n *\n * @note This can generates a huge amount of synchronous driver roundtrips and should be\n * considered a very slow operation, to be used only if/when a context already manipulated\n * by external code needs to be synchronized for the first time\n */\nexport function getGLParameters(gl, parameters = GL_PARAMETER_DEFAULTS) {\n    // support both arrays of parameters and objects (keys represent parameters)\n    if (typeof parameters === 'number') {\n        // single GL enum\n        const key = parameters;\n        // @ts-ignore TODO\n        const getter = GL_PARAMETER_GETTERS[key];\n        return getter ? getter(gl, key) : gl.getParameter(key);\n    }\n    const parameterKeys = Array.isArray(parameters) ? parameters : Object.keys(parameters);\n    const state = {};\n    for (const key of parameterKeys) {\n        // @ts-ignore TODO\n        const getter = GL_PARAMETER_GETTERS[key];\n        // @ts-ignore TODO\n        state[key] = getter ? getter(gl, Number(key)) : gl.getParameter(Number(key));\n    }\n    return state;\n}\n/**\n * Reset all parameters to a (almost) pure context state\n * @note viewport and scissor will be set to the values in GL_PARAMETER_DEFAULTS,\n * NOT the canvas size dimensions, so they will have to be properly set after\n * calling this function.\n */\nexport function resetGLParameters(gl) {\n    setGLParameters(gl, GL_PARAMETER_DEFAULTS);\n}\n// Helpers\n// Returns true if given object is empty, false otherwise.\nfunction isObjectEmpty(object) {\n    // @ts-ignore dummy key variable\n    for (const key in object) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=unified-parameter-api.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** deeply compare two arrays */\nexport function deepArrayEqual(x, y) {\n    if (x === y) {\n        return true;\n    }\n    if (isArray(x) && isArray(y) && x.length === y.length) {\n        for (let i = 0; i < x.length; ++i) {\n            if (x[i] !== y[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return false;\n}\nfunction isArray(x) {\n    return Array.isArray(x) || ArrayBuffer.isView(x);\n}\n//# sourceMappingURL=deep-array-equal.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// @ts-nocheck TODO - fix\nimport { setGLParameters, getGLParameters } from \"../parameters/unified-parameter-api.js\";\nimport { deepArrayEqual } from \"./deep-array-equal.js\";\nimport { GL_PARAMETER_DEFAULTS, GL_HOOKED_SETTERS, NON_CACHE_PARAMETERS } from \"../parameters/webgl-parameter-tables.js\";\n// HELPER CLASS - WebGLStateTracker\n/**\n * Support for listening to context state changes and intercepting state queries\n * NOTE: this system does not handle buffer bindings\n */\nexport class WebGLStateTracker {\n    static get(gl) {\n        // @ts-expect-error\n        return gl.state;\n    }\n    gl;\n    program = null;\n    stateStack = [];\n    enable = true;\n    cache = null;\n    log;\n    initialized = false;\n    constructor(gl, props) {\n        this.gl = gl;\n        this.log = props?.log || (() => { });\n        this._updateCache = this._updateCache.bind(this);\n        Object.seal(this);\n    }\n    push(values = {}) {\n        this.stateStack.push({});\n    }\n    pop() {\n        // assert(this.stateStack.length > 0);\n        // Use the saved values in the state stack to restore parameters\n        const oldValues = this.stateStack[this.stateStack.length - 1];\n        setGLParameters(this.gl, oldValues);\n        // Don't pop until we have reset parameters (to make sure other \"stack frames\" are not affected)\n        this.stateStack.pop();\n    }\n    /**\n     * Initialize WebGL state caching on a context\n     * can be called multiple times to enable/disable\n     *\n     * @note After calling this function, context state will be cached\n     * .push() and .pop() will be available for saving,\n     * temporarily modifying, and then restoring state.\n     */\n    trackState(gl, options) {\n        this.cache = options?.copyState\n            ? getGLParameters(gl)\n            : Object.assign({}, GL_PARAMETER_DEFAULTS);\n        if (this.initialized) {\n            throw new Error('WebGLStateTracker');\n        }\n        this.initialized = true;\n        // @ts-expect-error\n        this.gl.state = this;\n        installProgramSpy(gl);\n        // intercept all setter functions in the table\n        for (const key in GL_HOOKED_SETTERS) {\n            const setter = GL_HOOKED_SETTERS[key];\n            installSetterSpy(gl, key, setter);\n        }\n        // intercept all getter functions in the table\n        installGetterOverride(gl, 'getParameter');\n        installGetterOverride(gl, 'isEnabled');\n    }\n    /**\n    // interceptor for context set functions - update our cache and our stack\n    // values (Object) - the key values for this setter\n     * @param values\n     * @returns\n     */\n    _updateCache(values) {\n        let valueChanged = false;\n        let oldValue; // = undefined\n        const oldValues = this.stateStack.length > 0 ? this.stateStack[this.stateStack.length - 1] : null;\n        for (const key in values) {\n            // assert(key !== undefined);\n            const value = values[key];\n            const cached = this.cache[key];\n            // Check that value hasn't already been shadowed\n            if (!deepArrayEqual(value, cached)) {\n                valueChanged = true;\n                oldValue = cached;\n                // First, save current value being shadowed\n                // If a state stack frame is active, save the current parameter values for pop\n                // but first check that value hasn't already been shadowed and saved\n                if (oldValues && !(key in oldValues)) {\n                    oldValues[key] = cached;\n                }\n                // Save current value being shadowed\n                this.cache[key] = value;\n            }\n        }\n        return { valueChanged, oldValue };\n    }\n}\n// HELPER FUNCTIONS - INSTALL GET/SET INTERCEPTORS (SPYS) ON THE CONTEXT\n/**\n// Overrides a WebGL2RenderingContext state \"getter\" function\n// to return values directly from cache\n * @param gl\n * @param functionName\n */\nfunction installGetterOverride(gl, functionName) {\n    // Get the original function from the WebGL2RenderingContext\n    const originalGetterFunc = gl[functionName].bind(gl);\n    // Wrap it with a spy so that we can update our state cache when it gets called\n    gl[functionName] = function get(pname) {\n        if (pname === undefined || NON_CACHE_PARAMETERS.has(pname)) {\n            // Invalid or blacklisted parameter, do not cache\n            return originalGetterFunc(pname);\n        }\n        const glState = WebGLStateTracker.get(gl);\n        if (!(pname in glState.cache)) {\n            // WebGL limits are not prepopulated in the cache, call the original getter when first queried.\n            glState.cache[pname] = originalGetterFunc(pname);\n        }\n        // Optionally call the original function to do a \"hard\" query from the WebGL2RenderingContext\n        return glState.enable\n            ? // Call the getter the params so that it can e.g. serve from a cache\n                glState.cache[pname]\n            : // Optionally call the original function to do a \"hard\" query from the WebGL2RenderingContext\n                originalGetterFunc(pname);\n    };\n    // Set the name of this anonymous function to help in debugging and profiling\n    Object.defineProperty(gl[functionName], 'name', {\n        value: `${functionName}-from-cache`,\n        configurable: false\n    });\n}\n/**\n// Overrides a WebGL2RenderingContext state \"setter\" function\n// to call a setter spy before the actual setter. Allows us to keep a cache\n// updated with a copy of the WebGL context state.\n * @param gl\n * @param functionName\n * @param setter\n * @returns\n */\nfunction installSetterSpy(gl, functionName, setter) {\n    // Get the original function from the WebGL2RenderingContext\n    if (!gl[functionName]) {\n        // TODO - remove?\n        // This could happen if we try to intercept WebGL2 method on a WebGL1 context\n        return;\n    }\n    const originalSetterFunc = gl[functionName].bind(gl);\n    // Wrap it with a spy so that we can update our state cache when it gets called\n    gl[functionName] = function set(...params) {\n        // Update the value\n        // Call the setter with the state cache and the params so that it can store the parameters\n        const glState = WebGLStateTracker.get(gl);\n        // eslint-disable-next-line @typescript-eslint/unbound-method\n        const { valueChanged, oldValue } = setter(glState._updateCache, ...params);\n        // Call the original WebGL2RenderingContext func to make sure the context actually gets updated\n        if (valueChanged) {\n            originalSetterFunc(...params);\n        }\n        // Note: if the original function fails to set the value, our state cache will be bad\n        // No solution for this at the moment, but assuming that this is unlikely to be a real problem\n        // We could call the setter after the originalSetterFunc. Concern is that this would\n        // cause different behavior in debug mode, where originalSetterFunc can throw exceptions\n        return oldValue;\n    };\n    // Set the name of this anonymous function to help in debugging and profiling\n    Object.defineProperty(gl[functionName], 'name', {\n        value: `${functionName}-to-cache`,\n        configurable: false\n    });\n}\nfunction installProgramSpy(gl) {\n    const originalUseProgram = gl.useProgram.bind(gl);\n    gl.useProgram = function useProgramLuma(handle) {\n        const glState = WebGLStateTracker.get(gl);\n        if (glState.program !== handle) {\n            originalUseProgram(handle);\n            glState.program = handle;\n        }\n    };\n}\n//# sourceMappingURL=webgl-state-tracker.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/**\n * Create a WebGL context for a canvas\n * Note calling this multiple time on the same canvas does return the same context\n * @param canvas A canvas element or offscreen canvas\n */\nexport function createBrowserContext(canvas, props, webglContextAttributes) {\n    // Try to extract any extra information about why context creation failed\n    let errorMessage = '';\n    // const onCreateError = error => (errorMessage = error.statusMessage || errorMessage);\n    // Avoid multiple listeners?\n    // canvas.removeEventListener('webglcontextcreationerror', onCreateError, false);\n    // canvas.addEventListener('webglcontextcreationerror', onCreateError, false);\n    const webglProps = {\n        preserveDrawingBuffer: true,\n        // failIfMajorPerformanceCaveat: true,\n        ...webglContextAttributes\n    };\n    // Create the desired context\n    let gl = null;\n    // Create a webgl2 context\n    gl ||= canvas.getContext('webgl2', webglProps);\n    if (webglProps.failIfMajorPerformanceCaveat) {\n        errorMessage ||=\n            'Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.';\n    }\n    // Creation failed with failIfMajorPerformanceCaveat - Try a Software GPU\n    if (!gl && !webglContextAttributes.failIfMajorPerformanceCaveat) {\n        webglProps.failIfMajorPerformanceCaveat = false;\n        gl = canvas.getContext('webgl2', webglProps);\n        // @ts-expect-error\n        gl.luma ||= {};\n        // @ts-expect-error\n        gl.luma.softwareRenderer = true;\n    }\n    if (!gl) {\n        gl = canvas.getContext('webgl', {});\n        if (gl) {\n            gl = null;\n            errorMessage ||= 'Your browser only supports WebGL1';\n        }\n    }\n    if (!gl) {\n        errorMessage ||= 'Your browser does not support WebGL';\n        throw new Error(`Failed to create WebGL context: ${errorMessage}`);\n    }\n    // Carefully extract and wrap callbacks to prevent addEventListener from rebinding them.\n    const { onContextLost, onContextRestored } = props;\n    canvas.addEventListener('webglcontextlost', (event) => onContextLost(event), false);\n    canvas.addEventListener('webglcontextrestored', (event) => onContextRestored(event), false);\n    // @ts-expect-error\n    gl.luma ||= {};\n    return gl;\n}\n/* TODO - can we call this asynchronously to catch the error events?\nexport async function createBrowserContextAsync(canvas: HTMLCanvasElement | OffscreenCanvas, props: ContextProps): Promise<WebGL2RenderingContext> {\n  props = {...DEFAULT_CONTEXT_PROPS, ...props};\n\n // Try to extract any extra information about why context creation failed\n let errorMessage = null;\n const onCreateError = (error) => (errorMessage = error.statusMessage || errorMessage);\n canvas.addEventListener('webglcontextcreationerror', onCreateError, false);\n\n const gl = createBrowserContext(canvas, props);\n\n // Give the listener a chance to fire\n await new Promise(resolve => setTimeout(resolve, 0));\n\n canvas.removeEventListener('webglcontextcreationerror', onCreateError, false);\n\n return gl;\n}\n*/\n//# sourceMappingURL=create-browser-context.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/** Ensure extensions are only requested once */\nexport function getWebGLExtension(gl, name, extensions) {\n    // @ts-ignore TODO\n    if (extensions[name] === undefined) {\n        // @ts-ignore TODO\n        extensions[name] = gl.getExtension(name) || null;\n    }\n    // @ts-ignore TODO\n    return extensions[name];\n}\n//# sourceMappingURL=webgl-extensions.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\nimport { getWebGLExtension } from \"../../context/helpers/webgl-extensions.js\";\n/** @returns strings identifying the GPU vendor and driver. */\nexport function getDeviceInfo(gl, extensions) {\n    // \"Masked\" info is always available, but don't contain much useful information\n    const vendorMasked = gl.getParameter(7936);\n    const rendererMasked = gl.getParameter(7937);\n    // If we are lucky, unmasked info is available\n    // https://www.khronos.org/registry/webgl/extensions/WEBGL_debug_renderer_info/\n    getWebGLExtension(gl, 'WEBGL_debug_renderer_info', extensions);\n    const ext = extensions.WEBGL_debug_renderer_info;\n    const vendorUnmasked = gl.getParameter(ext ? ext.UNMASKED_VENDOR_WEBGL : 7936);\n    const rendererUnmasked = gl.getParameter(ext ? ext.UNMASKED_RENDERER_WEBGL : 7937);\n    const vendor = vendorUnmasked || vendorMasked;\n    const renderer = rendererUnmasked || rendererMasked;\n    // Driver version\n    const version = gl.getParameter(7938);\n    // \"Sniff\" the GPU type and backend from the info. This works best if unmasked info is available.\n    const gpu = identifyGPUVendor(vendor, renderer);\n    const gpuBackend = identifyGPUBackend(vendor, renderer);\n    const gpuType = identifyGPUType(vendor, renderer);\n    // Determine GLSL version\n    // For now, skip parsing of the long version string, just use context type below to deduce version\n    // const version = gl.getParameter(GL.SHADING_LANGUAGE_VERSION) as string;\n    // const shadingLanguageVersion = parseGLSLVersion(version);\n    const shadingLanguage = 'glsl';\n    const shadingLanguageVersion = 300;\n    return {\n        type: 'webgl',\n        gpu,\n        gpuType,\n        gpuBackend,\n        vendor,\n        renderer,\n        version,\n        shadingLanguage,\n        shadingLanguageVersion\n    };\n}\n/** \"Sniff\" the GPU type from the info. This works best if unmasked info is available. */\nfunction identifyGPUVendor(vendor, renderer) {\n    if (/NVIDIA/i.exec(vendor) || /NVIDIA/i.exec(renderer)) {\n        return 'nvidia';\n    }\n    if (/INTEL/i.exec(vendor) || /INTEL/i.exec(renderer)) {\n        return 'intel';\n    }\n    if (/Apple/i.exec(vendor) || /Apple/i.exec(renderer)) {\n        return 'apple';\n    }\n    if (/AMD/i.exec(vendor) ||\n        /AMD/i.exec(renderer) ||\n        /ATI/i.exec(vendor) ||\n        /ATI/i.exec(renderer)) {\n        return 'amd';\n    }\n    if (/SwiftShader/i.exec(vendor) || /SwiftShader/i.exec(renderer)) {\n        return 'software';\n    }\n    return 'unknown';\n}\n/** \"Sniff\" the GPU backend from the info. This works best if unmasked info is available. */\nfunction identifyGPUBackend(vendor, renderer) {\n    if (/Metal/i.exec(vendor) || /Metal/i.exec(renderer)) {\n        return 'metal';\n    }\n    if (/ANGLE/i.exec(vendor) || /ANGLE/i.exec(renderer)) {\n        return 'opengl';\n    }\n    return 'unknown';\n}\nfunction identifyGPUType(vendor, renderer) {\n    if (/SwiftShader/i.exec(vendor) || /SwiftShader/i.exec(renderer)) {\n        return 'cpu';\n    }\n    const gpuVendor = identifyGPUVendor(vendor, renderer);\n    switch (gpuVendor) {\n        case 'intel':\n            return 'integrated';\n        case 'software':\n            return 'cpu';\n        case 'unknown':\n            return 'unknown';\n        default:\n            return 'discrete';\n    }\n}\n//# sourceMappingURL=webgl-device-info.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n/** Get vertex format from GL constants */\nexport function getVertexFormatFromGL(type, components) {\n    const base = getVertexTypeFromGL(type);\n    // prettier-ignore\n    switch (components) {\n        case 1: return base;\n        case 2: return `${base}x2`;\n        // @ts-expect-error TODO deal with lack of \"unaligned\" formats\n        case 3: return `${base}x3`;\n        case 4: return `${base}x4`;\n    }\n    // @ts-ignore unreachable\n    throw new Error(String(components));\n}\n/** Get data type from GL constants */\nexport function getVertexTypeFromGL(type, normalized = false) {\n    // prettier-ignore\n    switch (type) {\n        // WebGPU does not support normalized 32 bit integer attributes\n        case 5124: return normalized ? 'sint32' : 'sint32';\n        case 5125: return normalized ? 'uint32' : 'uint32';\n        case 5122: return normalized ? 'sint16' : 'unorm16';\n        case 5123: return normalized ? 'uint16' : 'unorm16';\n        case 5120: return normalized ? 'sint8' : 'snorm16';\n        case 5121: return normalized ? 'uint8' : 'unorm8';\n        case 5126: return 'float32';\n        case 5131: return 'float16';\n    }\n    // @ts-ignore unreachable\n    throw new Error(String(type));\n}\nexport function getGLFromVertexType(dataType) {\n    // prettier-ignore\n    switch (dataType) {\n        case 'uint8': return 5121;\n        case 'sint8': return 5120;\n        case 'unorm8': return 5121;\n        case 'snorm8': return 5120;\n        case 'uint16': return 5123;\n        case 'sint16': return 5122;\n        case 'unorm16': return 5123;\n        case 'snorm16': return 5122;\n        case 'uint32': return 5125;\n        case 'sint32': return 5124;\n        // WebGPU does not support normalized 32 bit integer attributes\n        // case 'unorm32': return GL.UNSIGNED_INT;\n        // case 'snorm32': return GL.INT;\n        case 'float16': return 5131;\n        case 'float32': return 5126;\n    }\n    // @ts-ignore unreachable\n    throw new Error(String(dataType));\n}\n//# sourceMappingURL=webgl-vertex-formats.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { textureFormatDecoder } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { getWebGLExtension } from \"../../context/helpers/webgl-extensions.js\";\nimport { getGLFromVertexType } from \"./webgl-vertex-formats.js\";\n/* eslint-disable camelcase */\n// TEXTURE FEATURES\n// Define local webgl extension strings to optimize minification\nconst X_S3TC = 'WEBGL_compressed_texture_s3tc'; // BC1, BC2, BC3\nconst X_S3TC_SRGB = 'WEBGL_compressed_texture_s3tc_srgb'; // BC1, BC2, BC3\nconst X_RGTC = 'EXT_texture_compression_rgtc'; // BC4, BC5\nconst X_BPTC = 'EXT_texture_compression_bptc'; // BC6, BC7\nconst X_ETC2 = 'WEBGL_compressed_texture_etc'; // Renamed from 'WEBGL_compressed_texture_es3'\nconst X_ASTC = 'WEBGL_compressed_texture_astc';\nconst X_ETC1 = 'WEBGL_compressed_texture_etc1';\nconst X_PVRTC = 'WEBGL_compressed_texture_pvrtc';\nconst X_ATC = 'WEBGL_compressed_texture_atc';\n// Define local webgl extension strings to optimize minification\nconst EXT_texture_norm16 = 'EXT_texture_norm16';\nconst EXT_render_snorm = 'EXT_render_snorm';\nconst EXT_color_buffer_float = 'EXT_color_buffer_float';\n// prettier-ignore\nexport const TEXTURE_FEATURES = {\n    'float32-renderable-webgl': ['EXT_color_buffer_float'],\n    'float16-renderable-webgl': ['EXT_color_buffer_half_float'],\n    'rgb9e5ufloat-renderable-webgl': ['WEBGL_render_shared_exponent'],\n    'snorm8-renderable-webgl': [EXT_render_snorm],\n    'norm16-renderable-webgl': [EXT_texture_norm16],\n    'snorm16-renderable-webgl': [EXT_texture_norm16, EXT_render_snorm],\n    'float32-filterable': ['OES_texture_float_linear'],\n    'float16-filterable-webgl': ['OES_texture_half_float_linear'],\n    'texture-filterable-anisotropic-webgl': ['EXT_texture_filter_anisotropic'],\n    'texture-blend-float-webgl': ['EXT_float_blend'],\n    'texture-compression-bc': [X_S3TC, X_S3TC_SRGB, X_RGTC, X_BPTC],\n    // 'texture-compression-bc3-srgb-webgl': [X_S3TC_SRGB],\n    // 'texture-compression-bc3-webgl': [X_S3TC],\n    'texture-compression-bc5-webgl': [X_RGTC],\n    'texture-compression-bc7-webgl': [X_BPTC],\n    'texture-compression-etc2': [X_ETC2],\n    'texture-compression-astc': [X_ASTC],\n    'texture-compression-etc1-webgl': [X_ETC1],\n    'texture-compression-pvrtc-webgl': [X_PVRTC],\n    'texture-compression-atc-webgl': [X_ATC]\n};\nexport function isTextureFeature(feature) {\n    return feature in TEXTURE_FEATURES;\n}\n/** Checks a texture feature (for Device.features). Mainly compressed texture support */\nexport function checkTextureFeature(gl, feature, extensions) {\n    const textureExtensions = TEXTURE_FEATURES[feature] || [];\n    return textureExtensions.every(extension => getWebGLExtension(gl, extension, extensions));\n}\n// TABLES\n/**\n * Texture format data -\n * Exported but can change without notice\n */\n// prettier-ignore\nexport const WEBGL_TEXTURE_FORMATS = {\n    // 8-bit formats\n    'r8unorm': { gl: 33321, rb: true },\n    'r8snorm': { gl: 36756 },\n    'r8uint': { gl: 33330, rb: true },\n    'r8sint': { gl: 33329, rb: true },\n    // 16-bit formats\n    'rg8unorm': { gl: 33323, rb: true },\n    'rg8snorm': { gl: 36757 },\n    'rg8uint': { gl: 33336, rb: true },\n    'rg8sint': { gl: 33335, rb: true },\n    'r16uint': { gl: 33332, rb: true },\n    'r16sint': { gl: 33331, rb: true },\n    'r16float': { gl: 33325, rb: true },\n    'r16unorm': { gl: 33322, rb: true },\n    'r16snorm': { gl: 36760 },\n    // Packed 16-bit formats\n    'rgba4unorm-webgl': { gl: 32854, rb: true },\n    'rgb565unorm-webgl': { gl: 36194, rb: true },\n    'rgb5a1unorm-webgl': { gl: 32855, rb: true },\n    // 24-bit formats\n    'rgb8unorm-webgl': { gl: 32849 },\n    'rgb8snorm-webgl': { gl: 36758 },\n    // 32-bit formats\n    'rgba8unorm': { gl: 32856 },\n    'rgba8unorm-srgb': { gl: 35907 },\n    'rgba8snorm': { gl: 36759 },\n    'rgba8uint': { gl: 36220 },\n    'rgba8sint': { gl: 36238 },\n    // reverse colors, webgpu only\n    'bgra8unorm': {},\n    'bgra8unorm-srgb': {},\n    'rg16uint': { gl: 33338 },\n    'rg16sint': { gl: 33337 },\n    'rg16float': { gl: 33327, rb: true },\n    'rg16unorm': { gl: 33324 },\n    'rg16snorm': { gl: 36761 },\n    'r32uint': { gl: 33334, rb: true },\n    'r32sint': { gl: 33333, rb: true },\n    'r32float': { gl: 33326 },\n    // Packed 32-bit formats\n    'rgb9e5ufloat': { gl: 35901 }, // , filter: true},\n    'rg11b10ufloat': { gl: 35898, rb: true },\n    'rgb10a2unorm': { gl: 32857, rb: true },\n    'rgb10a2uint': { gl: 36975, rb: true },\n    // 48-bit formats\n    'rgb16unorm-webgl': { gl: 32852 }, // rgb not renderable\n    'rgb16snorm-webgl': { gl: 36762 }, // rgb not renderable\n    // 64-bit formats\n    'rg32uint': { gl: 33340, rb: true },\n    'rg32sint': { gl: 33339, rb: true },\n    'rg32float': { gl: 33328, rb: true },\n    'rgba16uint': { gl: 36214, rb: true },\n    'rgba16sint': { gl: 36232, rb: true },\n    'rgba16float': { gl: 34842 },\n    'rgba16unorm': { gl: 32859, rb: true },\n    'rgba16snorm': { gl: 36763 },\n    // 96-bit formats (deprecated!)\n    'rgb32float-webgl': { gl: 34837, x: EXT_color_buffer_float, dataFormat: 6407, types: [5126] },\n    // 128-bit formats\n    'rgba32uint': { gl: 36208, rb: true },\n    'rgba32sint': { gl: 36226, rb: true },\n    'rgba32float': { gl: 34836, rb: true },\n    // Depth and stencil formats\n    'stencil8': { gl: 36168, rb: true }, // 8 stencil bits\n    'depth16unorm': { gl: 33189, dataFormat: 6402, types: [5123], rb: true }, // 16 depth bits\n    'depth24plus': { gl: 33190, dataFormat: 6402, types: [5125] },\n    'depth32float': { gl: 36012, dataFormat: 6402, types: [5126], rb: true },\n    // The depth component of the \"depth24plus\" and \"depth24plus-stencil8\" formats may be implemented as either a 24-bit depth value or a \"depth32float\" value.\n    'depth24plus-stencil8': { gl: 35056, rb: true, depthTexture: true, dataFormat: 34041, types: [34042] },\n    // \"depth32float-stencil8\" feature - TODO below is render buffer only?\n    'depth32float-stencil8': { gl: 36013, dataFormat: 34041, types: [36269], rb: true },\n    // BC compressed formats: check device.features.has(\"texture-compression-bc\");\n    'bc1-rgb-unorm-webgl': { gl: 33776, x: X_S3TC },\n    'bc1-rgb-unorm-srgb-webgl': { gl: 35916, x: X_S3TC_SRGB },\n    'bc1-rgba-unorm': { gl: 33777, x: X_S3TC },\n    'bc1-rgba-unorm-srgb': { gl: 35916, x: X_S3TC_SRGB },\n    'bc2-rgba-unorm': { gl: 33778, x: X_S3TC },\n    'bc2-rgba-unorm-srgb': { gl: 35918, x: X_S3TC_SRGB },\n    'bc3-rgba-unorm': { gl: 33779, x: X_S3TC },\n    'bc3-rgba-unorm-srgb': { gl: 35919, x: X_S3TC_SRGB },\n    'bc4-r-unorm': { gl: 36283, x: X_RGTC },\n    'bc4-r-snorm': { gl: 36284, x: X_RGTC },\n    'bc5-rg-unorm': { gl: 36285, x: X_RGTC },\n    'bc5-rg-snorm': { gl: 36286, x: X_RGTC },\n    'bc6h-rgb-ufloat': { gl: 36495, x: X_BPTC },\n    'bc6h-rgb-float': { gl: 36494, x: X_BPTC },\n    'bc7-rgba-unorm': { gl: 36492, x: X_BPTC },\n    'bc7-rgba-unorm-srgb': { gl: 36493, x: X_BPTC },\n    // WEBGL_compressed_texture_etc: device.features.has(\"texture-compression-etc2\")\n    // Note: Supposedly guaranteed availability compressed formats in WebGL2, but through CPU decompression\n    'etc2-rgb8unorm': { gl: 37492 },\n    'etc2-rgb8unorm-srgb': { gl: 37494 },\n    'etc2-rgb8a1unorm': { gl: 37496 },\n    'etc2-rgb8a1unorm-srgb': { gl: 37497 },\n    'etc2-rgba8unorm': { gl: 37493 },\n    'etc2-rgba8unorm-srgb': { gl: 37495 },\n    'eac-r11unorm': { gl: 37488 },\n    'eac-r11snorm': { gl: 37489 },\n    'eac-rg11unorm': { gl: 37490 },\n    'eac-rg11snorm': { gl: 37491 },\n    // X_ASTC compressed formats: device.features.has(\"texture-compression-astc\")\n    'astc-4x4-unorm': { gl: 37808 },\n    'astc-4x4-unorm-srgb': { gl: 37840 },\n    'astc-5x4-unorm': { gl: 37809 },\n    'astc-5x4-unorm-srgb': { gl: 37841 },\n    'astc-5x5-unorm': { gl: 37810 },\n    'astc-5x5-unorm-srgb': { gl: 37842 },\n    'astc-6x5-unorm': { gl: 37811 },\n    'astc-6x5-unorm-srgb': { gl: 37843 },\n    'astc-6x6-unorm': { gl: 37812 },\n    'astc-6x6-unorm-srgb': { gl: 37844 },\n    'astc-8x5-unorm': { gl: 37813 },\n    'astc-8x5-unorm-srgb': { gl: 37845 },\n    'astc-8x6-unorm': { gl: 37814 },\n    'astc-8x6-unorm-srgb': { gl: 37846 },\n    'astc-8x8-unorm': { gl: 37815 },\n    'astc-8x8-unorm-srgb': { gl: 37847 },\n    'astc-10x5-unorm': { gl: 37819 },\n    'astc-10x5-unorm-srgb': { gl: 37851 },\n    'astc-10x6-unorm': { gl: 37817 },\n    'astc-10x6-unorm-srgb': { gl: 37849 },\n    'astc-10x8-unorm': { gl: 37818 },\n    'astc-10x8-unorm-srgb': { gl: 37850 },\n    'astc-10x10-unorm': { gl: 37819 },\n    'astc-10x10-unorm-srgb': { gl: 37851 },\n    'astc-12x10-unorm': { gl: 37820 },\n    'astc-12x10-unorm-srgb': { gl: 37852 },\n    'astc-12x12-unorm': { gl: 37821 },\n    'astc-12x12-unorm-srgb': { gl: 37853 },\n    // WEBGL_compressed_texture_pvrtc\n    'pvrtc-rgb4unorm-webgl': { gl: 35840 },\n    'pvrtc-rgba4unorm-webgl': { gl: 35842 },\n    'pvrtc-rbg2unorm-webgl': { gl: 35841 },\n    'pvrtc-rgba2unorm-webgl': { gl: 35843 },\n    // WEBGL_compressed_texture_etc1\n    'etc1-rbg-unorm-webgl': { gl: 36196 },\n    // WEBGL_compressed_texture_atc\n    'atc-rgb-unorm-webgl': { gl: 35986 },\n    'atc-rgba-unorm-webgl': { gl: 35986 },\n    'atc-rgbai-unorm-webgl': { gl: 34798 }\n};\n// FUNCTIONS\n/** Checks if a texture format is supported */\nexport function isWebGLTextureFormatCapabilitiesed(gl, format, extensions) {\n    const webglTextureInfo = WEBGL_TEXTURE_FORMATS[format];\n    // Check that we have a GL constant\n    if (!webglTextureInfo?.gl) {\n        return false;\n    }\n    // Check extensions\n    const extension = webglTextureInfo.x;\n    if (extension) {\n        return Boolean(getWebGLExtension(gl, extension, extensions));\n    }\n    return true;\n}\n/** Checks if a texture format is supported, renderable, filterable etc */\nexport function getTextureFormatCapabilitiesWebGL(gl, formatSupport, extensions) {\n    let supported = formatSupport.create;\n    const webglFormatInfo = WEBGL_TEXTURE_FORMATS[formatSupport.format];\n    // Support Check that we have a GL constant\n    if (webglFormatInfo?.gl === undefined) {\n        supported = false;\n    }\n    if (webglFormatInfo?.x) {\n        supported = supported && Boolean(getWebGLExtension(gl, webglFormatInfo.x, extensions));\n    }\n    return {\n        format: formatSupport.format,\n        // @ts-ignore\n        create: supported && formatSupport.create,\n        // @ts-ignore\n        render: supported && formatSupport.render,\n        // @ts-ignore\n        filter: supported && formatSupport.filter,\n        // @ts-ignore\n        blend: supported && formatSupport.blend,\n        // @ts-ignore\n        store: supported && formatSupport.store\n    };\n}\n/** Get parameters necessary to work with format in WebGL: internalFormat, dataFormat, type, compressed, */\nexport function getTextureFormatWebGL(format) {\n    const formatData = WEBGL_TEXTURE_FORMATS[format];\n    const webglFormat = convertTextureFormatToGL(format);\n    const decoded = textureFormatDecoder.getInfo(format);\n    if (decoded.compressed) {\n        // TODO: Unclear whether this is always valid, this may be why ETC2 RGBA8 fails.\n        formatData.dataFormat = webglFormat;\n    }\n    return {\n        internalFormat: webglFormat,\n        format: formatData?.dataFormat ||\n            getWebGLPixelDataFormat(decoded.channels, decoded.integer, decoded.normalized, webglFormat),\n        // depth formats don't have a type\n        type: decoded.dataType\n            ? getGLFromVertexType(decoded.dataType)\n            : formatData?.types?.[0] || 5121,\n        compressed: decoded.compressed || false\n    };\n}\nexport function getDepthStencilAttachmentWebGL(format) {\n    const formatInfo = textureFormatDecoder.getInfo(format);\n    switch (formatInfo.attachment) {\n        case 'depth':\n            return 36096;\n        case 'stencil':\n            return 36128;\n        case 'depth-stencil':\n            return 33306;\n        default:\n            throw new Error(`Not a depth stencil format: ${format}`);\n    }\n}\n/** TODO - VERY roundabout legacy way of calculating bytes per pixel */\nexport function getTextureFormatBytesPerPixel(format) {\n    const formatInfo = textureFormatDecoder.getInfo(format);\n    return formatInfo.bytesPerPixel;\n}\n// DATA TYPE HELPERS\nexport function getWebGLPixelDataFormat(channels, integer, normalized, format) {\n    // WebGL1 formats use same internalFormat\n    if (format === 6408 || format === 6407) {\n        return format;\n    }\n    // prettier-ignore\n    switch (channels) {\n        case 'r': return integer && !normalized ? 36244 : 6403;\n        case 'rg': return integer && !normalized ? 33320 : 33319;\n        case 'rgb': return integer && !normalized ? 36248 : 6407;\n        case 'rgba': return integer && !normalized ? 36249 : 6408;\n        case 'bgra': throw new Error('bgra pixels not supported by WebGL');\n        default: return 6408;\n    }\n}\n/**\n * Map WebGPU style texture format strings to GL constants\n */\nfunction convertTextureFormatToGL(format) {\n    const formatInfo = WEBGL_TEXTURE_FORMATS[format];\n    const webglFormat = formatInfo?.gl;\n    if (webglFormat === undefined) {\n        throw new Error(`Unsupported texture format ${format}`);\n    }\n    return webglFormat;\n}\n//# sourceMappingURL=webgl-texture-table.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Feature detection for WebGL\n// Provides a function that enables simple checking of which WebGL features are\nimport { DeviceFeatures } from '@luma.gl/core';\nimport { getWebGLExtension } from \"../../context/helpers/webgl-extensions.js\";\nimport { isTextureFeature, checkTextureFeature, TEXTURE_FEATURES } from \"../converters/webgl-texture-table.js\";\n/**\n * Defines luma.gl \"feature\" names and semantics\n * when value is 'string' it is the name of the extension that enables this feature\n */\nconst WEBGL_FEATURES = {\n    // optional WebGPU features\n    'depth-clip-control': 'EXT_depth_clamp', // TODO these seem subtly different\n    // 'timestamp-query' // GPUQueryType \"timestamp-query\"\n    // \"indirect-first-instance\"\n    // Textures are handled by getTextureFeatures()\n    // 'depth32float-stencil8' // GPUTextureFormat 'depth32float-stencil8'\n    // optional WebGL features\n    'timer-query-webgl': 'EXT_disjoint_timer_query_webgl2',\n    'compilation-status-async-webgl': 'KHR_parallel_shader_compile',\n    'polygon-mode-webgl': 'WEBGL_polygon_mode',\n    'provoking-vertex-webgl': 'WEBGL_provoking_vertex',\n    'shader-clip-cull-distance-webgl': 'WEBGL_clip_cull_distance',\n    'shader-noperspective-interpolation-webgl': 'NV_shader_noperspective_interpolation',\n    'shader-conservative-depth-webgl': 'EXT_conservative_depth'\n    // Textures are handled by getTextureFeatures()\n};\n/**\n * WebGL extensions exposed as luma.gl features\n * To minimize GL log noise and improve performance, this class ensures that\n * - WebGL extensions are not queried until the corresponding feature is checked.\n * - WebGL extensions are only queried once.\n */\nexport class WebGLDeviceFeatures extends DeviceFeatures {\n    gl;\n    extensions;\n    testedFeatures = new Set();\n    constructor(gl, extensions, disabledFeatures) {\n        super([], disabledFeatures);\n        this.gl = gl;\n        this.extensions = extensions;\n        // TODO - is this really needed?\n        // Enable EXT_float_blend first: https://developer.mozilla.org/en-US/docs/Web/API/EXT_float_blend\n        getWebGLExtension(gl, 'EXT_color_buffer_float', extensions);\n    }\n    *[Symbol.iterator]() {\n        const features = this.getFeatures();\n        for (const feature of features) {\n            if (this.has(feature)) {\n                yield feature;\n            }\n        }\n        return [];\n    }\n    has(feature) {\n        if (this.disabledFeatures?.[feature]) {\n            return false;\n        }\n        // We have already tested this feature\n        if (!this.testedFeatures.has(feature)) {\n            this.testedFeatures.add(feature);\n            // Check the feature once\n            if (isTextureFeature(feature) && checkTextureFeature(this.gl, feature, this.extensions)) {\n                this.features.add(feature);\n            }\n            if (this.getWebGLFeature(feature)) {\n                this.features.add(feature);\n            }\n        }\n        return this.features.has(feature);\n    }\n    // FOR DEVICE\n    initializeFeatures() {\n        // Initialize all features by checking them.\n        // Except WEBGL_polygon_mode since Chrome logs ugly console warnings\n        const features = this.getFeatures().filter(feature => feature !== 'polygon-mode-webgl');\n        for (const feature of features) {\n            this.has(feature);\n        }\n    }\n    // IMPLEMENTATION\n    getFeatures() {\n        return [...Object.keys(WEBGL_FEATURES), ...Object.keys(TEXTURE_FEATURES)];\n    }\n    /** Extract all WebGL features */\n    getWebGLFeature(feature) {\n        const featureInfo = WEBGL_FEATURES[feature];\n        // string value requires checking the corresponding WebGL extension\n        const isSupported = typeof featureInfo === 'string'\n            ? Boolean(getWebGLExtension(this.gl, featureInfo, this.extensions))\n            : Boolean(featureInfo);\n        return isSupported;\n    }\n}\n//# sourceMappingURL=webgl-device-features.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { DeviceLimits } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\n// prettier-ignore\nexport class WebGLDeviceLimits extends DeviceLimits {\n    get maxTextureDimension1D() { return 0; } // WebGL does not support 1D textures\n    get maxTextureDimension2D() { return this.getParameter(3379); }\n    get maxTextureDimension3D() { return this.getParameter(32883); }\n    get maxTextureArrayLayers() { return this.getParameter(35071); }\n    get maxBindGroups() { return 0; }\n    get maxDynamicUniformBuffersPerPipelineLayout() { return 0; } // TBD\n    get maxDynamicStorageBuffersPerPipelineLayout() { return 0; } // TBD\n    get maxSampledTexturesPerShaderStage() { return this.getParameter(35660); } // ) TBD\n    get maxSamplersPerShaderStage() { return this.getParameter(35661); }\n    get maxStorageBuffersPerShaderStage() { return 0; } // TBD\n    get maxStorageTexturesPerShaderStage() { return 0; } // TBD\n    get maxUniformBuffersPerShaderStage() { return this.getParameter(35375); }\n    get maxUniformBufferBindingSize() { return this.getParameter(35376); }\n    get maxStorageBufferBindingSize() { return 0; }\n    get minUniformBufferOffsetAlignment() { return this.getParameter(35380); }\n    get minStorageBufferOffsetAlignment() { return 0; }\n    get maxVertexBuffers() { return 16; } // WebGL 2 supports 16 buffers, see https://github.com/gpuweb/gpuweb/issues/4284\n    get maxVertexAttributes() { return this.getParameter(34921); }\n    get maxVertexBufferArrayStride() { return 2048; } // TBD, this is just the default value from WebGPU\n    get maxInterStageShaderVariables() { return this.getParameter(35659); }\n    get maxComputeWorkgroupStorageSize() { return 0; } // WebGL does not support compute shaders\n    get maxComputeInvocationsPerWorkgroup() { return 0; } // WebGL does not support compute shaders\n    get maxComputeWorkgroupSizeX() { return 0; } // WebGL does not support compute shaders\n    get maxComputeWorkgroupSizeY() { return 0; } // WebGL does not support compute shaders\n    get maxComputeWorkgroupSizeZ() { return 0; } // WebGL does not support compute shaders\n    get maxComputeWorkgroupsPerDimension() { return 0; } // WebGL does not support compute shaders\n    // PRIVATE\n    gl;\n    limits = {};\n    constructor(gl) {\n        super();\n        this.gl = gl;\n    }\n    getParameter(parameter) {\n        if (this.limits[parameter] === undefined) {\n            this.limits[parameter] = this.gl.getParameter(parameter);\n        }\n        return this.limits[parameter] || 0;\n    }\n}\n//# sourceMappingURL=webgl-device-limits.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Framebuffer } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { getDepthStencilAttachmentWebGL } from \"../converters/webgl-texture-table.js\";\n/** luma.gl Framebuffer, WebGL implementation  */\nexport class WEBGLFramebuffer extends Framebuffer {\n    device;\n    gl;\n    handle;\n    colorAttachments = [];\n    depthStencilAttachment = null;\n    constructor(device, props) {\n        super(device, props);\n        // WebGL default framebuffer handle is null\n        const isDefaultFramebuffer = props.handle === null;\n        this.device = device;\n        this.gl = device.gl;\n        this.handle =\n            this.props.handle || isDefaultFramebuffer ? this.props.handle : this.gl.createFramebuffer();\n        if (!isDefaultFramebuffer) {\n            // default framebuffer handle is null, so we can't set debug metadata...\n            device._setWebGLDebugMetadata(this.handle, this, { spector: this.props });\n            // Auto create textures for attachments if needed\n            this.autoCreateAttachmentTextures();\n            this.updateAttachments();\n        }\n    }\n    /** destroys any auto created resources etc. */\n    destroy() {\n        super.destroy(); // destroys owned resources etc.\n        if (!this.destroyed && this.handle !== null) {\n            this.gl.deleteFramebuffer(this.handle);\n            // this.handle = null;\n        }\n    }\n    updateAttachments() {\n        /** Attach from a map of attachments */\n        // @ts-expect-error native bindFramebuffer is overridden by our state tracker\n        const prevHandle = this.gl.bindFramebuffer(36160, this.handle);\n        // Walk the attachments\n        for (let i = 0; i < this.colorAttachments.length; ++i) {\n            const attachment = this.colorAttachments[i];\n            if (attachment) {\n                const attachmentPoint = 36064 + i;\n                this._attachTextureView(attachmentPoint, attachment);\n            }\n        }\n        if (this.depthStencilAttachment) {\n            const attachmentPoint = getDepthStencilAttachmentWebGL(this.depthStencilAttachment.props.format);\n            this._attachTextureView(attachmentPoint, this.depthStencilAttachment);\n        }\n        /** Check the status */\n        if (this.device.props.debug) {\n            const status = this.gl.checkFramebufferStatus(36160);\n            if (status !== 36053) {\n                throw new Error(`Framebuffer ${_getFrameBufferStatus(status)}`);\n            }\n        }\n        this.gl.bindFramebuffer(36160, prevHandle);\n    }\n    // PRIVATE\n    /** In WebGL we must use renderbuffers for depth/stencil attachments (unless we have extensions) */\n    // protected override createDepthStencilTexture(format: TextureFormat): Texture {\n    //   // return new WEBGLRenderbuffer(this.device, {\n    //   return new WEBGLTexture(this.device, {\n    //     id: `${this.id}-depth-stencil`,\n    //     format,\n    //     width: this.width,\n    //     height: this.height,\n    //     mipmaps: false\n    //   });\n    // }\n    /**\n     * @param attachment\n     * @param texture\n     * @param layer = 0 - index into WEBGLTextureArray and Texture3D or face for `TextureCubeMap`\n     * @param level = 0 - mipmapLevel\n     */\n    _attachTextureView(attachment, textureView) {\n        const { gl } = this.device;\n        const { texture } = textureView;\n        const level = textureView.props.baseMipLevel;\n        const layer = textureView.props.baseArrayLayer;\n        gl.bindTexture(texture.glTarget, texture.handle);\n        switch (texture.glTarget) {\n            case 35866:\n            case 32879:\n                gl.framebufferTextureLayer(36160, attachment, texture.handle, level, layer);\n                break;\n            case 34067:\n                // layer must be a cubemap face (or if index, converted to cube map face)\n                const face = mapIndexToCubeMapFace(layer);\n                gl.framebufferTexture2D(36160, attachment, face, texture.handle, level);\n                break;\n            case 3553:\n                gl.framebufferTexture2D(36160, attachment, 3553, texture.handle, level);\n                break;\n            default:\n                throw new Error('Illegal texture type');\n        }\n        gl.bindTexture(texture.glTarget, null);\n    }\n}\n// Helper functions\n// Map an index to a cube map face constant\nfunction mapIndexToCubeMapFace(layer) {\n    // TEXTURE_CUBE_MAP_POSITIVE_X is a big value (0x8515)\n    // if smaller assume layer is index, otherwise assume it is already a cube map face constant\n    return layer < 34069\n        ? layer + 34069\n        : layer;\n}\n// Helper METHODS\n// Get a string describing the framebuffer error if installed\nfunction _getFrameBufferStatus(status) {\n    switch (status) {\n        case 36053:\n            return 'success';\n        case 36054:\n            return 'Mismatched attachments';\n        case 36055:\n            return 'No attachments';\n        case 36057:\n            return 'Height/width mismatch';\n        case 36061:\n            return 'Unsupported or split attachments';\n        // WebGL2\n        case 36182:\n            return 'Samples mismatch';\n        // OVR_multiview2 extension\n        // case GL.FRAMEBUFFER_INCOMPLETE_VIEW_TARGETS_OVR: return 'baseViewIndex mismatch';\n        default:\n            return `${status}`;\n    }\n}\n/**\n * Attachment resize is expected to be a noop if size is same\n *\nprotected override resizeAttachments(width: number, height: number): this {\n  // for default framebuffer, just update the stored size\n  if (this.handle === null) {\n    // assert(width === undefined && height === undefined);\n    this.width = this.gl.drawingBufferWidth;\n    this.height = this.gl.drawingBufferHeight;\n    return this;\n  }\n\n  if (width === undefined) {\n    width = this.gl.drawingBufferWidth;\n  }\n  if (height === undefined) {\n    height = this.gl.drawingBufferHeight;\n  }\n\n  // TODO Not clear that this is better than default destroy/create implementation\n\n  for (const colorAttachment of this.colorAttachments) {\n    colorAttachment.texture.clone({width, height});\n  }\n  if (this.depthStencilAttachment) {\n    this.depthStencilAttachment.texture.resize({width, height});\n  }\n  return this;\n}\n*/\n//# sourceMappingURL=webgl-framebuffer.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { CanvasContext } from '@luma.gl/core';\nimport { WEBGLFramebuffer } from \"./resources/webgl-framebuffer.js\";\n/**\n * A WebGL Canvas Context which manages the canvas and handles drawing buffer resizing etc\n */\nexport class WebGLCanvasContext extends CanvasContext {\n    device;\n    handle = null;\n    _framebuffer = null;\n    get [Symbol.toStringTag]() {\n        return 'WebGLCanvasContext';\n    }\n    constructor(device, props) {\n        // Note: Base class creates / looks up the canvas (unless under Node.js)\n        super(props);\n        this.device = device;\n        // Base class constructor cannot access derived methods/fields, so we need to call these functions in the subclass constructor\n        this._setAutoCreatedCanvasId(`${this.device.id}-canvas`);\n        this._updateDevice();\n    }\n    getCurrentFramebuffer() {\n        // Setting handle to null returns a reference to the default framebuffer\n        this._framebuffer = this._framebuffer || new WEBGLFramebuffer(this.device, { handle: null });\n        return this._framebuffer;\n    }\n    // IMPLEMENTATION OF ABSTRACT METHODS\n    _updateDevice() { }\n}\n//# sourceMappingURL=webgl-canvas-context.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nconst uidCounters = {};\n/**\n * Returns a UID.\n * @param id= - Identifier base name\n * @return uid\n **/\nexport function uid(id = 'id') {\n    uidCounters[id] = uidCounters[id] || 1;\n    const count = uidCounters[id]++;\n    return `${id}-${count}`;\n}\n//# sourceMappingURL=uid.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Buffer } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\n/** WebGL Buffer interface */\nexport class WEBGLBuffer extends Buffer {\n    device;\n    gl;\n    handle;\n    /** Target in OpenGL defines the type of buffer */\n    glTarget;\n    /** Usage is a hint on how frequently the buffer will be updates */\n    glUsage;\n    /** Index type is needed when issuing draw calls, so we pre-compute it */\n    glIndexType = 5123;\n    /** Number of bytes allocated on the GPU for this buffer */\n    byteLength = 0;\n    /** Number of bytes used */\n    bytesUsed = 0;\n    constructor(device, props = {}) {\n        super(device, props);\n        this.device = device;\n        this.gl = this.device.gl;\n        const handle = typeof props === 'object' ? props.handle : undefined;\n        this.handle = handle || this.gl.createBuffer();\n        device._setWebGLDebugMetadata(this.handle, this, {\n            spector: { ...this.props, data: typeof this.props.data }\n        });\n        // - In WebGL1, need to make sure we use GL.ELEMENT_ARRAY_BUFFER when initializing element buffers\n        //   otherwise buffer type will lock to generic (non-element) buffer\n        // - In WebGL2, we can use GL.COPY_READ_BUFFER which avoids locking the type here\n        this.glTarget = getWebGLTarget(this.props.usage);\n        this.glUsage = getWebGLUsage(this.props.usage);\n        // Note: uint8 indices are converted to uint16 during device normalization for WebGPU compatibility\n        this.glIndexType = this.props.indexType === 'uint32' ? 5125 : 5123;\n        // Set data: (re)initializes the buffer\n        if (props.data) {\n            this._initWithData(props.data, props.byteOffset, props.byteLength);\n        }\n        else {\n            this._initWithByteLength(props.byteLength || 0);\n        }\n    }\n    destroy() {\n        if (!this.destroyed && this.handle) {\n            this.removeStats();\n            this.trackDeallocatedMemory();\n            this.gl.deleteBuffer(this.handle);\n            this.destroyed = true;\n            // @ts-expect-error\n            this.handle = null;\n        }\n    }\n    /** Allocate a new buffer and initialize to contents of typed array */\n    _initWithData(data, byteOffset = 0, byteLength = data.byteLength + byteOffset) {\n        // const glTarget = this.device.isWebGL2 ? GL.COPY_WRITE_BUFFER : this.glTarget;\n        const glTarget = this.glTarget;\n        this.gl.bindBuffer(glTarget, this.handle);\n        this.gl.bufferData(glTarget, byteLength, this.glUsage);\n        this.gl.bufferSubData(glTarget, byteOffset, data);\n        this.gl.bindBuffer(glTarget, null);\n        this.bytesUsed = byteLength;\n        this.byteLength = byteLength;\n        this._setDebugData(data, byteOffset, byteLength);\n        this.trackAllocatedMemory(byteLength);\n    }\n    // Allocate a GPU buffer of specified size.\n    _initWithByteLength(byteLength) {\n        // assert(byteLength >= 0);\n        // Workaround needed for Safari (#291):\n        // gl.bufferData with size equal to 0 crashes. Instead create zero sized array.\n        let data = byteLength;\n        if (byteLength === 0) {\n            // @ts-expect-error\n            data = new Float32Array(0);\n        }\n        // const glTarget = this.device.isWebGL2 ? GL.COPY_WRITE_BUFFER : this.glTarget;\n        const glTarget = this.glTarget;\n        this.gl.bindBuffer(glTarget, this.handle);\n        this.gl.bufferData(glTarget, data, this.glUsage);\n        this.gl.bindBuffer(glTarget, null);\n        this.bytesUsed = byteLength;\n        this.byteLength = byteLength;\n        this._setDebugData(null, 0, byteLength);\n        this.trackAllocatedMemory(byteLength);\n        return this;\n    }\n    write(data, byteOffset = 0) {\n        const dataView = ArrayBuffer.isView(data) ? data : new Uint8Array(data);\n        const srcOffset = 0;\n        const byteLength = undefined; // data.byteLength;\n        // Create the buffer - binding it here for the first time locks the type\n        // In WebGL2, use GL.COPY_WRITE_BUFFER to avoid locking the type\n        const glTarget = 36663;\n        this.gl.bindBuffer(glTarget, this.handle);\n        // WebGL2: subData supports additional srcOffset and length parameters\n        if (srcOffset !== 0 || byteLength !== undefined) {\n            this.gl.bufferSubData(glTarget, byteOffset, dataView, srcOffset, byteLength);\n        }\n        else {\n            this.gl.bufferSubData(glTarget, byteOffset, dataView);\n        }\n        this.gl.bindBuffer(glTarget, null);\n        this._setDebugData(data, byteOffset, data.byteLength);\n    }\n    async mapAndWriteAsync(callback, byteOffset = 0, byteLength = this.byteLength - byteOffset) {\n        const arrayBuffer = new ArrayBuffer(byteLength);\n        // eslint-disable-next-line @typescript-eslint/await-thenable\n        await callback(arrayBuffer, 'copied');\n        this.write(arrayBuffer, byteOffset);\n    }\n    async readAsync(byteOffset = 0, byteLength) {\n        return this.readSyncWebGL(byteOffset, byteLength);\n    }\n    async mapAndReadAsync(callback, byteOffset = 0, byteLength) {\n        const data = await this.readAsync(byteOffset, byteLength);\n        // eslint-disable-next-line @typescript-eslint/await-thenable\n        return await callback(data.buffer, 'copied');\n    }\n    readSyncWebGL(byteOffset = 0, byteLength) {\n        byteLength = byteLength ?? this.byteLength - byteOffset;\n        const data = new Uint8Array(byteLength);\n        const dstOffset = 0;\n        // Use GL.COPY_READ_BUFFER to avoid disturbing other targets and locking type\n        this.gl.bindBuffer(36662, this.handle);\n        this.gl.getBufferSubData(36662, byteOffset, data, dstOffset, byteLength);\n        this.gl.bindBuffer(36662, null);\n        // Update local `data` if offsets are 0\n        this._setDebugData(data, byteOffset, byteLength);\n        return data;\n    }\n}\n/**\n * Returns a WebGL buffer target\n *\n * @param usage\n * static MAP_READ = 0x01;\n * static MAP_WRITE = 0x02;\n * static COPY_SRC = 0x0004;\n * static COPY_DST = 0x0008;\n * static INDEX = 0x0010;\n * static VERTEX = 0x0020;\n * static UNIFORM = 0x0040;\n * static STORAGE = 0x0080;\n * static INDIRECT = 0x0100;\n * static QUERY_RESOLVE = 0x0200;\n *\n * @returns WebGL buffer targe\n *\n * Buffer bind points in WebGL2\n * gl.COPY_READ_BUFFER: Buffer for copying from one buffer object to another.\n * gl.COPY_WRITE_BUFFER: Buffer for copying from one buffer object to another.\n * gl.TRANSFORM_FEEDBACK_BUFFER: Buffer for transform feedback operations.\n * gl.PIXEL_PACK_BUFFER: Buffer used for pixel transfer operations.\n * gl.PIXEL_UNPACK_BUFFER: Buffer used for pixel transfer operations.\n */\nfunction getWebGLTarget(usage) {\n    if (usage & Buffer.INDEX) {\n        return 34963;\n    }\n    if (usage & Buffer.VERTEX) {\n        return 34962;\n    }\n    if (usage & Buffer.UNIFORM) {\n        return 35345;\n    }\n    // Binding a buffer for the first time locks the type\n    // In WebGL2, we can use GL.COPY_WRITE_BUFFER to avoid locking the type\n    return 34962;\n}\n/** @todo usage is not passed correctly */\nfunction getWebGLUsage(usage) {\n    if (usage & Buffer.INDEX) {\n        return 35044;\n    }\n    if (usage & Buffer.VERTEX) {\n        return 35044;\n    }\n    if (usage & Buffer.UNIFORM) {\n        return 35048;\n    }\n    return 35044;\n}\n//# sourceMappingURL=webgl-buffer.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n/**\n * Parse a WebGL-format GLSL compilation log into an array of WebGPU style message records.\n * This follows documented WebGL conventions for compilation logs.\n * Based on https://github.com/wwwtyro/gl-format-compiler-error (public domain)\n */\nexport function parseShaderCompilerLog(errLog) {\n    // Parse the error - note: browser and driver dependent\n    const lines = errLog.split(/\\r?\\n/);\n    const messages = [];\n    for (const line of lines) {\n        if (line.length <= 1) {\n            continue; // eslint-disable-line no-continue\n        }\n        const segments = line.split(':');\n        // Check for messages with no line information `ERROR: unsupported shader version`\n        if (segments.length === 2) {\n            const [messageType, message] = segments;\n            messages.push({\n                message: message.trim(),\n                type: getMessageType(messageType),\n                lineNum: 0,\n                linePos: 0\n            });\n            continue; // eslint-disable-line no-continue\n        }\n        const [messageType, linePosition, lineNumber, ...rest] = segments;\n        let lineNum = parseInt(lineNumber, 10);\n        if (isNaN(lineNum)) {\n            lineNum = 0;\n        }\n        let linePos = parseInt(linePosition, 10);\n        if (isNaN(linePos)) {\n            linePos = 0;\n        }\n        messages.push({\n            message: rest.join(':').trim(),\n            type: getMessageType(messageType),\n            lineNum,\n            linePos // TODO\n        });\n    }\n    return messages;\n}\n/** Ensure supported type */\nfunction getMessageType(messageType) {\n    const MESSAGE_TYPES = ['warning', 'error', 'info'];\n    const lowerCaseType = messageType.toLowerCase();\n    return (MESSAGE_TYPES.includes(lowerCaseType) ? lowerCaseType : 'info');\n}\n//# sourceMappingURL=parse-shader-compiler-log.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Shader, log } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { parseShaderCompilerLog } from \"../helpers/parse-shader-compiler-log.js\";\n/**\n * An immutable compiled shader program that execute portions of the GPU Pipeline\n */\nexport class WEBGLShader extends Shader {\n    device;\n    handle;\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        switch (this.props.stage) {\n            case 'vertex':\n                this.handle = this.props.handle || this.device.gl.createShader(35633);\n                break;\n            case 'fragment':\n                this.handle = this.props.handle || this.device.gl.createShader(35632);\n                break;\n            default:\n                throw new Error(this.props.stage);\n        }\n        // default framebuffer handle is null, so we can't set spector metadata...\n        device._setWebGLDebugMetadata(this.handle, this, { spector: this.props });\n        this._compile(this.source);\n    }\n    destroy() {\n        if (this.handle) {\n            this.removeStats();\n            this.device.gl.deleteShader(this.handle);\n            this.destroyed = true;\n            // @ts-expect-error\n            this.handle.destroyed = true;\n            // this.handle = null;\n        }\n    }\n    get asyncCompilationStatus() {\n        return this._waitForCompilationComplete().then(() => {\n            this._getCompilationStatus();\n            return this.compilationStatus;\n        });\n    }\n    async getCompilationInfo() {\n        await this._waitForCompilationComplete();\n        return this.getCompilationInfoSync();\n    }\n    getCompilationInfoSync() {\n        const shaderLog = this.device.gl.getShaderInfoLog(this.handle);\n        return shaderLog ? parseShaderCompilerLog(shaderLog) : [];\n    }\n    getTranslatedSource() {\n        const extensions = this.device.getExtension('WEBGL_debug_shaders');\n        const ext = extensions.WEBGL_debug_shaders;\n        return ext?.getTranslatedShaderSource(this.handle) || null;\n    }\n    // PRIVATE METHODS\n    /** Compile a shader and get compilation status */\n    async _compile(source) {\n        source = source.startsWith('#version ') ? source : `#version 300 es\\n${source}`;\n        const { gl } = this.device;\n        gl.shaderSource(this.handle, source);\n        gl.compileShader(this.handle);\n        // For performance reasons, avoid checking shader compilation errors on production\n        if (!this.device.props.debug) {\n            this.compilationStatus = 'pending';\n            return;\n        }\n        // Sync case - slower, but advantage is that it throws in the constructor, making break on error more useful\n        if (!this.device.features.has('compilation-status-async-webgl')) {\n            this._getCompilationStatus();\n            // The `Shader` base class will determine if debug window should be opened based on this.compilationStatus\n            this.debugShader();\n            if (this.compilationStatus === 'error') {\n                throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);\n            }\n            return;\n        }\n        // async case\n        log.once(1, 'Shader compilation is asynchronous')();\n        await this._waitForCompilationComplete();\n        log.info(2, `Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)();\n        this._getCompilationStatus();\n        // The `Shader` base class will determine if debug window should be opened based on this.compilationStatus\n        this.debugShader();\n    }\n    /** Use KHR_parallel_shader_compile extension if available */\n    async _waitForCompilationComplete() {\n        const waitMs = async (ms) => await new Promise(resolve => setTimeout(resolve, ms));\n        const DELAY_MS = 10; // Shader compilation is typically quite fast (with some exceptions)\n        // If status polling is not available, we can't wait for completion. Just wait a little to minimize blocking\n        if (!this.device.features.has('compilation-status-async-webgl')) {\n            await waitMs(DELAY_MS);\n            return;\n        }\n        const { gl } = this.device;\n        for (;;) {\n            const complete = gl.getShaderParameter(this.handle, 37297);\n            if (complete) {\n                return;\n            }\n            await waitMs(DELAY_MS);\n        }\n    }\n    /**\n     * Get the shader compilation status\n     * TODO - Load log even when no error reported, to catch warnings?\n     * https://gamedev.stackexchange.com/questions/30429/how-to-detect-glsl-warnings\n     */\n    _getCompilationStatus() {\n        this.compilationStatus = this.device.gl.getShaderParameter(this.handle, 35713)\n            ? 'success'\n            : 'error';\n    }\n}\n// TODO - Original code from luma.gl v8 - keep until new debug functionality has matured\n// if (!compilationSuccess) {\n//   const parsedLog = shaderLog ? parseShaderCompilerLog(shaderLog) : [];\n//   const messages = parsedLog.filter(message => message.type === 'error');\n//   const formattedLog = formatCompilerLog(messages, source, {showSourceCode: 'all', html: true});\n//   const shaderDescription = `${this.stage} shader ${shaderName}`;\n//   log.error(`GLSL compilation errors in ${shaderDescription}\\n${formattedLog}`)();\n//   displayShaderLog(parsedLog, source, shaderName);\n// }\n//# sourceMappingURL=webgl-shader.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { log } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { setGLParameters } from \"../../context/parameters/unified-parameter-api.js\";\n/* eslint-disable no-unused-expressions */ // For expression ? gl.enable() : gl.disable()\n/**\n * Execute a function with a set of temporary WebGL parameter overrides\n * - Saves current \"global\" WebGL context settings\n * - Sets the supplies WebGL context parameters,\n * - Executes supplied function\n * - Restores parameters\n * - Returns the return value of the supplied function\n */\nexport function withDeviceAndGLParameters(device, parameters, glParameters, func) {\n    if (isObjectEmpty(parameters)) {\n        // Avoid setting state if no parameters provided. Just call and return\n        return func(device);\n    }\n    // Wrap in a try-catch to ensure that parameters are restored on exceptions\n    const webglDevice = device;\n    webglDevice.pushState();\n    try {\n        setDeviceParameters(device, parameters);\n        setGLParameters(webglDevice.gl, glParameters);\n        return func(device);\n    }\n    finally {\n        webglDevice.popState();\n    }\n}\n/**\n * Execute a function with a set of temporary WebGL parameter overrides\n * - Saves current \"global\" WebGL context settings\n * - Sets the supplies WebGL context parameters,\n * - Executes supplied function\n * - Restores parameters\n * - Returns the return value of the supplied function\n * @deprecated use withDeviceParameters instead\n */\nexport function withGLParameters(device, parameters, func) {\n    if (isObjectEmpty(parameters)) {\n        // Avoid setting state if no parameters provided. Just call and return\n        return func(device);\n    }\n    // Wrap in a try-catch to ensure that parameters are restored on exceptions\n    const webglDevice = device;\n    webglDevice.pushState();\n    try {\n        setGLParameters(webglDevice.gl, parameters);\n        return func(device);\n    }\n    finally {\n        webglDevice.popState();\n    }\n}\n/**\n * Execute a function with a set of temporary WebGL parameter overrides\n * - Saves current \"global\" WebGL context settings\n * - Sets the supplies WebGL context parameters,\n * - Executes supplied function\n * - Restores parameters\n * - Returns the return value of the supplied function\n */\nexport function withDeviceParameters(device, parameters, func) {\n    if (isObjectEmpty(parameters)) {\n        // Avoid setting state if no parameters provided. Just call and return\n        return func(device);\n    }\n    // Wrap in a try-catch to ensure that parameters are restored on exceptions'\n    const webglDevice = device;\n    webglDevice.pushState();\n    try {\n        setDeviceParameters(device, parameters);\n        return func(device);\n    }\n    finally {\n        webglDevice.popState();\n    }\n}\n/** Set WebGPU Style Parameters */\nexport function setDeviceParameters(device, parameters) {\n    const webglDevice = device;\n    const { gl } = webglDevice;\n    // RASTERIZATION SETTINGS\n    if (parameters.cullMode) {\n        switch (parameters.cullMode) {\n            case 'none':\n                gl.disable(2884);\n                break;\n            case 'front':\n                gl.enable(2884);\n                gl.cullFace(1028);\n                break;\n            case 'back':\n                gl.enable(2884);\n                gl.cullFace(1029);\n                break;\n        }\n    }\n    if (parameters.frontFace) {\n        gl.frontFace(map('frontFace', parameters.frontFace, {\n            ccw: 2305,\n            cw: 2304\n        }));\n    }\n    if (parameters.unclippedDepth) {\n        if (device.features.has('depth-clip-control')) {\n            // EXT_depth_clamp\n            gl.enable(34383);\n        }\n    }\n    if (parameters.depthBias !== undefined) {\n        gl.enable(32823);\n        gl.polygonOffset(parameters.depthBias, parameters.depthBiasSlopeScale || 0);\n    }\n    // depthBiasSlopeScale: {\n    //   // Handled by depthBias\n    // },\n    // WEBGL EXTENSIONS\n    if (parameters.provokingVertex) {\n        if (device.features.has('provoking-vertex-webgl')) {\n            const extensions = webglDevice.getExtension('WEBGL_provoking_vertex');\n            const ext = extensions.WEBGL_provoking_vertex;\n            const vertex = map('provokingVertex', parameters.provokingVertex, {\n                first: 36429,\n                last: 36430\n            });\n            ext?.provokingVertexWEBGL(vertex);\n        }\n    }\n    if (parameters.polygonMode || parameters.polygonOffsetLine) {\n        if (device.features.has('polygon-mode-webgl')) {\n            if (parameters.polygonMode) {\n                const extensions = webglDevice.getExtension('WEBGL_polygon_mode');\n                const ext = extensions.WEBGL_polygon_mode;\n                const mode = map('polygonMode', parameters.polygonMode, {\n                    fill: 6914,\n                    line: 6913\n                });\n                ext?.polygonModeWEBGL(1028, mode);\n                ext?.polygonModeWEBGL(1029, mode);\n            }\n            if (parameters.polygonOffsetLine) {\n                gl.enable(10754);\n            }\n        }\n    }\n    if (device.features.has('shader-clip-cull-distance-webgl')) {\n        if (parameters.clipDistance0) {\n            gl.enable(12288);\n        }\n        if (parameters.clipDistance1) {\n            gl.enable(12289);\n        }\n        if (parameters.clipDistance2) {\n            gl.enable(12290);\n        }\n        if (parameters.clipDistance3) {\n            gl.enable(12291);\n        }\n        if (parameters.clipDistance4) {\n            gl.enable(12292);\n        }\n        if (parameters.clipDistance5) {\n            gl.enable(12293);\n        }\n        if (parameters.clipDistance6) {\n            gl.enable(12294);\n        }\n        if (parameters.clipDistance7) {\n            gl.enable(12295);\n        }\n    }\n    // DEPTH STENCIL\n    if (parameters.depthWriteEnabled !== undefined) {\n        gl.depthMask(mapBoolean('depthWriteEnabled', parameters.depthWriteEnabled));\n    }\n    if (parameters.depthCompare) {\n        parameters.depthCompare !== 'always' ? gl.enable(2929) : gl.disable(2929);\n        gl.depthFunc(convertCompareFunction('depthCompare', parameters.depthCompare));\n    }\n    if (parameters.stencilWriteMask) {\n        const mask = parameters.stencilWriteMask;\n        gl.stencilMaskSeparate(1028, mask);\n        gl.stencilMaskSeparate(1029, mask);\n    }\n    if (parameters.stencilReadMask) {\n        // stencilReadMask is handle inside stencil***Compare.\n        log.warn('stencilReadMask not supported under WebGL');\n    }\n    if (parameters.stencilCompare) {\n        const mask = parameters.stencilReadMask || 0xffffffff;\n        const glValue = convertCompareFunction('depthCompare', parameters.stencilCompare);\n        // TODO - ensure back doesn't overwrite\n        parameters.stencilCompare !== 'always'\n            ? gl.enable(2960)\n            : gl.disable(2960);\n        gl.stencilFuncSeparate(1028, glValue, 0, mask);\n        gl.stencilFuncSeparate(1029, glValue, 0, mask);\n    }\n    if (parameters.stencilPassOperation &&\n        parameters.stencilFailOperation &&\n        parameters.stencilDepthFailOperation) {\n        const dppass = convertStencilOperation('stencilPassOperation', parameters.stencilPassOperation);\n        const sfail = convertStencilOperation('stencilFailOperation', parameters.stencilFailOperation);\n        const dpfail = convertStencilOperation('stencilDepthFailOperation', parameters.stencilDepthFailOperation);\n        gl.stencilOpSeparate(1028, sfail, dpfail, dppass);\n        gl.stencilOpSeparate(1029, sfail, dpfail, dppass);\n    }\n    // stencilDepthFailOperation() {\n    //   // handled by stencilPassOperation\n    // },\n    // stencilFailOperation() {\n    //   // handled by stencilPassOperation\n    // },\n    // COLOR STATE\n    switch (parameters.blend) {\n        case true:\n            gl.enable(3042);\n            break;\n        case false:\n            gl.disable(3042);\n            break;\n        default:\n        // leave WebGL blend state unchanged if `parameters.blend` is not set\n    }\n    if (parameters.blendColorOperation || parameters.blendAlphaOperation) {\n        const colorEquation = convertBlendOperationToEquation('blendColorOperation', parameters.blendColorOperation || 'add');\n        const alphaEquation = convertBlendOperationToEquation('blendAlphaOperation', parameters.blendAlphaOperation || 'add');\n        gl.blendEquationSeparate(colorEquation, alphaEquation);\n        const colorSrcFactor = convertBlendFactorToFunction('blendColorSrcFactor', parameters.blendColorSrcFactor || 'one');\n        const colorDstFactor = convertBlendFactorToFunction('blendColorDstFactor', parameters.blendColorDstFactor || 'zero');\n        const alphaSrcFactor = convertBlendFactorToFunction('blendAlphaSrcFactor', parameters.blendAlphaSrcFactor || 'one');\n        const alphaDstFactor = convertBlendFactorToFunction('blendAlphaDstFactor', parameters.blendAlphaDstFactor || 'zero');\n        gl.blendFuncSeparate(colorSrcFactor, colorDstFactor, alphaSrcFactor, alphaDstFactor);\n    }\n}\n/*\n      rasterizationState: {\n        cullMode: \"back\",\n      },\n\n      depthStencilState: {\n        depthWriteEnabled: true,\n        depthCompare: \"less\",\n        format: \"depth24plus-stencil8\",\n      },\n\n      colorStates: [\n        {\n          format: \"bgra8unorm\",\n          // colorBlend.srcFactor = wgpu::BlendFactor::SrcAlpha;\n          // colorBlend.dstFactor = wgpu::BlendFactor::OneMinusSrcAlpha;\n          // alphaBlend.srcFactor = wgpu::BlendFactor::SrcAlpha;\n          // alphaBlend.dstFactor = wgpu::BlendFactor::OneMinusSrcAlpha;\n        },\n      ],\n    });\n*/\nexport function convertCompareFunction(parameter, value) {\n    return map(parameter, value, {\n        never: 512,\n        less: 513,\n        equal: 514,\n        'less-equal': 515,\n        greater: 516,\n        'not-equal': 517,\n        'greater-equal': 518,\n        always: 519\n    });\n}\nexport function convertToCompareFunction(parameter, value) {\n    return map(parameter, value, {\n        [512]: 'never',\n        [513]: 'less',\n        [514]: 'equal',\n        [515]: 'less-equal',\n        [516]: 'greater',\n        [517]: 'not-equal',\n        [518]: 'greater-equal',\n        [519]: 'always'\n    });\n}\nfunction convertStencilOperation(parameter, value) {\n    return map(parameter, value, {\n        keep: 7680,\n        zero: 0,\n        replace: 7681,\n        invert: 5386,\n        'increment-clamp': 7682,\n        'decrement-clamp': 7683,\n        'increment-wrap': 34055,\n        'decrement-wrap': 34056\n    });\n}\nfunction convertBlendOperationToEquation(parameter, value) {\n    return map(parameter, value, {\n        add: 32774,\n        subtract: 32778,\n        'reverse-subtract': 32779,\n        min: 32775,\n        max: 32776\n    });\n}\nfunction convertBlendFactorToFunction(parameter, value, type = 'color') {\n    return map(parameter, value, {\n        one: 1,\n        zero: 0,\n        src: 768,\n        'one-minus-src': 769,\n        dst: 774,\n        'one-minus-dst': 775,\n        'src-alpha': 770,\n        'one-minus-src-alpha': 771,\n        'dst-alpha': 772,\n        'one-minus-dst-alpha': 773,\n        'src-alpha-saturated': 776,\n        constant: type === 'color' ? 32769 : 32771,\n        'one-minus-constant': type === 'color' ? 32770 : 32772,\n        // 'constant-alpha': GL.CONSTANT_ALPHA,\n        // 'one-minus-constant-alpha': GL.ONE_MINUS_CONSTANT_ALPHA,\n        // TODO not supported in WebGL2\n        src1: 768,\n        'one-minus-src1': 769,\n        'src1-alpha': 770,\n        'one-minus-src1-alpha': 771\n    });\n}\nfunction message(parameter, value) {\n    return `Illegal parameter ${value} for ${parameter}`;\n}\nfunction map(parameter, value, valueMap) {\n    if (!(value in valueMap)) {\n        throw new Error(message(parameter, value));\n    }\n    return valueMap[value];\n}\nfunction mapBoolean(parameter, value) {\n    return value;\n}\n/** Returns true if given object is empty, false otherwise. */\nfunction isObjectEmpty(obj) {\n    let isEmpty = true;\n    // @ts-ignore key is unused\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    for (const key in obj) {\n        isEmpty = false;\n        break;\n    }\n    return isEmpty;\n}\n//# sourceMappingURL=device-parameters.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\nimport { convertCompareFunction } from \"./device-parameters.js\";\n/**\n * Convert WebGPU-style sampler props to WebGL\n * @param props\n * @returns\n */\nexport function convertSamplerParametersToWebGL(props) {\n    const params = {};\n    if (props.addressModeU) {\n        params[10242] = convertAddressMode(props.addressModeU);\n    }\n    if (props.addressModeV) {\n        params[10243] = convertAddressMode(props.addressModeV);\n    }\n    if (props.addressModeW) {\n        params[32882] = convertAddressMode(props.addressModeW);\n    }\n    if (props.magFilter) {\n        params[10240] = convertMaxFilterMode(props.magFilter);\n    }\n    if (props.minFilter || props.mipmapFilter) {\n        // TODO - arbitrary choice of linear?\n        params[10241] = convertMinFilterMode(props.minFilter || 'linear', props.mipmapFilter);\n    }\n    if (props.lodMinClamp !== undefined) {\n        params[33082] = props.lodMinClamp;\n    }\n    if (props.lodMaxClamp !== undefined) {\n        params[33083] = props.lodMaxClamp;\n    }\n    if (props.type === 'comparison-sampler') {\n        // Setting prop.compare turns this into a comparison sampler\n        params[34892] = 34894;\n    }\n    if (props.compare) {\n        params[34893] = convertCompareFunction('compare', props.compare);\n    }\n    // Note depends on WebGL extension\n    if (props.maxAnisotropy) {\n        params[34046] = props.maxAnisotropy;\n    }\n    return params;\n}\n// HELPERS\n/** Convert address more */\nfunction convertAddressMode(addressMode) {\n    switch (addressMode) {\n        case 'clamp-to-edge':\n            return 33071;\n        case 'repeat':\n            return 10497;\n        case 'mirror-repeat':\n            return 33648;\n    }\n}\nfunction convertMaxFilterMode(maxFilter) {\n    switch (maxFilter) {\n        case 'nearest':\n            return 9728;\n        case 'linear':\n            return 9729;\n    }\n}\n/**\n * WebGPU has separate min filter and mipmap filter,\n * WebGL is combined and effectively offers 6 options\n */\nfunction convertMinFilterMode(minFilter, mipmapFilter = 'none') {\n    if (!mipmapFilter) {\n        return convertMaxFilterMode(minFilter);\n    }\n    switch (mipmapFilter) {\n        case 'none':\n            return convertMaxFilterMode(minFilter);\n        case 'nearest':\n            switch (minFilter) {\n                case 'nearest':\n                    return 9984;\n                case 'linear':\n                    return 9985;\n            }\n            break;\n        case 'linear':\n            switch (minFilter) {\n                case 'nearest':\n                    return 9986;\n                case 'linear':\n                    return 9987;\n            }\n    }\n}\n//# sourceMappingURL=sampler-parameters.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Sampler } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { convertSamplerParametersToWebGL } from \"../converters/sampler-parameters.js\";\n/**\n * Sampler object -\n * so that they can be set directly on the texture\n * https://github.com/WebGLSamples/WebGL2Samples/blob/master/samples/sampler_object.html\n */\nexport class WEBGLSampler extends Sampler {\n    device;\n    handle;\n    parameters;\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.parameters = convertSamplerParametersToWebGL(props);\n        this.handle = props.handle || this.device.gl.createSampler();\n        this._setSamplerParameters(this.parameters);\n    }\n    destroy() {\n        if (this.handle) {\n            this.device.gl.deleteSampler(this.handle);\n            // @ts-expect-error read-only/undefined\n            this.handle = undefined;\n        }\n    }\n    toString() {\n        return `Sampler(${this.id},${JSON.stringify(this.props)})`;\n    }\n    /** Set sampler parameters on the sampler */\n    _setSamplerParameters(parameters) {\n        for (const [pname, value] of Object.entries(parameters)) {\n            // Apparently there are integer/float conversion issues requires two parameter setting functions in JavaScript.\n            // For now, pick the float version for parameters specified as GLfloat.\n            const param = Number(pname);\n            switch (param) {\n                case 33082:\n                case 33083:\n                    this.device.gl.samplerParameterf(this.handle, param, value);\n                    break;\n                default:\n                    this.device.gl.samplerParameteri(this.handle, param, value);\n                    break;\n            }\n        }\n    }\n}\n//# sourceMappingURL=webgl-sampler.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { setGLParameters } from \"../parameters/unified-parameter-api.js\";\nimport { WebGLStateTracker } from \"./webgl-state-tracker.js\";\n/**\n * Execute a function with a set of temporary WebGL parameter overrides\n * - Saves current \"global\" WebGL context settings\n * - Sets the supplies WebGL context parameters,\n * - Executes supplied function\n * - Restores parameters\n * - Returns the return value of the supplied function\n */\nexport function withGLParameters(gl, parameters, func) {\n    if (isObjectEmpty(parameters)) {\n        // Avoid setting state if no parameters provided. Just call and return\n        return func(gl);\n    }\n    const { nocatch = true } = parameters;\n    const webglState = WebGLStateTracker.get(gl);\n    webglState.push();\n    setGLParameters(gl, parameters);\n    // Setup is done, call the function\n    let value;\n    if (nocatch) {\n        // Avoid try catch to minimize stack size impact for safe execution paths\n        value = func(gl);\n        webglState.pop();\n    }\n    else {\n        // Wrap in a try-catch to ensure that parameters are restored on exceptions\n        try {\n            value = func(gl);\n        }\n        finally {\n            webglState.pop();\n        }\n    }\n    return value;\n}\n// Helpers\n// Returns true if given object is empty, false otherwise.\nfunction isObjectEmpty(object) {\n    // @ts-ignore - dummy key variable\n    for (const key in object) {\n        return false;\n    }\n    return true;\n}\n//# sourceMappingURL=with-parameters.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// import {getTextureFormatInfo} from '@luma.gl/core';\nimport { TextureView, Texture } from '@luma.gl/core';\nexport class WEBGLTextureView extends TextureView {\n    device;\n    gl;\n    handle; // Does not have a WebGL representation\n    texture;\n    constructor(device, props) {\n        super(device, { ...Texture.defaultProps, ...props });\n        this.device = device;\n        this.gl = this.device.gl;\n        this.handle = null;\n        this.texture = props.texture;\n    }\n}\n//# sourceMappingURL=webgl-texture-view.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Texture, log } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { getTextureFormatWebGL } from \"../converters/webgl-texture-table.js\";\nimport { convertSamplerParametersToWebGL } from \"../converters/sampler-parameters.js\";\nimport { withGLParameters } from \"../../context/state-tracker/with-parameters.js\";\nimport { WEBGLTextureView } from \"./webgl-texture-view.js\";\n/**\n * WebGL... the texture API from hell... hopefully made simpler\n */\nexport class WEBGLTexture extends Texture {\n    // readonly MAX_ATTRIBUTES: number;\n    device;\n    gl;\n    handle;\n    // @ts-ignore TODO - currently unused in WebGL. Create dummy sampler?\n    sampler = undefined;\n    view;\n    /**\n     * The WebGL target corresponding to the texture type\n     * @note `target` cannot be modified by bind:\n     * textures are special because when you first bind them to a target,\n     * When you first bind a texture as a GL_TEXTURE_2D, you are saying that this texture is a 2D texture.\n     * And it will always be a 2D texture; this state cannot be changed ever.\n     * A texture that was first bound as a GL_TEXTURE_2D, must always be bound as a GL_TEXTURE_2D;\n     * attempting to bind it as GL_TEXTURE_3D will give rise to a run-time error\n     */\n    glTarget;\n    /** The WebGL format - essentially channel structure */\n    glFormat;\n    /** The WebGL data format - the type of each channel */\n    glType;\n    /** The WebGL constant corresponding to the WebGPU style constant in format */\n    glInternalFormat;\n    /** Whether the internal format is compressed */\n    compressed;\n    // state\n    /** Texture binding slot - TODO - move to texture view? */\n    _textureUnit = 0;\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.gl = this.device.gl;\n        const formatInfo = getTextureFormatWebGL(this.props.format);\n        // Note: In WebGL the texture target defines the type of texture on first bind.\n        this.glTarget = getWebGLTextureTarget(this.props.dimension);\n        this.glInternalFormat = formatInfo.internalFormat;\n        this.glFormat = formatInfo.format;\n        this.glType = formatInfo.type;\n        this.compressed = formatInfo.compressed;\n        this.handle = this.props.handle || this.gl.createTexture();\n        this.device._setWebGLDebugMetadata(this.handle, this, { spector: this.props });\n        /**\n         * Use WebGL immutable texture storage to allocate and clear texture memory.\n         * - texStorage2D should be considered a preferred alternative to texImage2D. It may have lower memory costs than texImage2D in some implementations.\n         * - Once texStorage*D has been called, the texture is immutable and can only be updated with texSubImage*(), not texImage()\n         * @see https://registry.khronos.org/webgl/specs/latest/2.0/ WebGL 2 spec section 3.7.6\n         */\n        this.gl.bindTexture(this.glTarget, this.handle);\n        const { dimension, width, height, depth, mipLevels, glTarget, glInternalFormat } = this;\n        switch (dimension) {\n            case '2d':\n            case 'cube':\n                this.gl.texStorage2D(glTarget, mipLevels, glInternalFormat, width, height);\n                break;\n            case '2d-array':\n            case '3d':\n                this.gl.texStorage3D(glTarget, mipLevels, glInternalFormat, width, height, depth);\n                break;\n            default:\n                throw new Error(dimension);\n        }\n        this.gl.bindTexture(this.glTarget, null);\n        // Set data\n        this._initializeData(props.data);\n        // Set texture sampler parameters\n        this.setSampler(this.props.sampler);\n        // @ts-ignore TODO - fix types\n        this.view = new WEBGLTextureView(this.device, { ...this.props, texture: this });\n        Object.seal(this);\n    }\n    destroy() {\n        if (this.handle) {\n            this.gl.deleteTexture(this.handle);\n            this.removeStats();\n            this.trackDeallocatedMemory('Texture');\n            // this.handle = null;\n            this.destroyed = true;\n        }\n    }\n    createView(props) {\n        return new WEBGLTextureView(this.device, { ...props, texture: this });\n    }\n    setSampler(sampler = {}) {\n        super.setSampler(sampler);\n        // Apply sampler parameters to texture\n        const parameters = convertSamplerParametersToWebGL(this.sampler.props);\n        this._setSamplerParameters(parameters);\n    }\n    copyImageData(options_) {\n        const options = this._normalizeCopyImageDataOptions(options_);\n        const typedArray = options.data;\n        const { width, height, depth } = this;\n        const { mipLevel = 0, byteOffset = 0, x = 0, y = 0, z = 0 } = options;\n        const { glFormat, glType, compressed } = this;\n        // Target used for face updates, but not for binding\n        const glTarget = getWebGLCubeFaceTarget(this.glTarget, this.dimension, z);\n        let unpackRowLength;\n        if (!this.compressed) {\n            const { bytesPerPixel } = this.device.getTextureFormatInfo(this.format);\n            if (bytesPerPixel) {\n                if (options.bytesPerRow % bytesPerPixel !== 0) {\n                    throw new Error(`bytesPerRow (${options.bytesPerRow}) must be a multiple of bytesPerPixel (${bytesPerPixel}) for ${this.format}`);\n                }\n                unpackRowLength = options.bytesPerRow / bytesPerPixel;\n            }\n        }\n        const glParameters = !this.compressed\n            ? {\n                ...(unpackRowLength !== undefined ? { [3314]: unpackRowLength } : {}),\n                [32878]: options.rowsPerImage\n            }\n            : {};\n        this.gl.bindTexture(glTarget, this.handle);\n        withGLParameters(this.gl, glParameters, () => {\n            switch (this.dimension) {\n                case '2d':\n                case 'cube':\n                    if (compressed) {\n                        // prettier-ignore\n                        this.gl.compressedTexSubImage2D(glTarget, mipLevel, x, y, width, height, glFormat, typedArray, byteOffset); // , byteLength\n                    }\n                    else {\n                        // prettier-ignore\n                        this.gl.texSubImage2D(glTarget, mipLevel, x, y, width, height, glFormat, glType, typedArray, byteOffset); // , byteLength\n                    }\n                    break;\n                case '2d-array':\n                case '3d':\n                    if (compressed) {\n                        // prettier-ignore\n                        this.gl.compressedTexSubImage3D(glTarget, mipLevel, x, y, z, width, height, depth, glFormat, typedArray, byteOffset); // , byteLength\n                    }\n                    else {\n                        // prettier-ignore\n                        this.gl.texSubImage3D(glTarget, mipLevel, x, y, z, width, height, depth, glFormat, glType, typedArray, byteOffset); // , byteLength\n                    }\n                    break;\n                default:\n                // Can never happen in WebGL\n            }\n        });\n        this.gl.bindTexture(glTarget, null);\n    }\n    copyExternalImage(options_) {\n        const options = this._normalizeCopyExternalImageOptions(options_);\n        if (options.sourceX || options.sourceY) {\n            // requires copyTexSubImage2D from a framebuffer'\n            throw new Error('WebGL does not support sourceX/sourceY)');\n        }\n        const { glFormat, glType } = this;\n        const { image, depth, mipLevel, x, y, z, width, height } = options;\n        // WebGL cube maps specify faces by overriding target instead of using the depth parameter\n        const glTarget = getWebGLCubeFaceTarget(this.glTarget, this.dimension, depth);\n        const glParameters = options.flipY ? { [37440]: true } : {};\n        this.gl.bindTexture(this.glTarget, this.handle);\n        withGLParameters(this.gl, glParameters, () => {\n            switch (this.dimension) {\n                case '2d':\n                case 'cube':\n                    // prettier-ignore\n                    this.gl.texSubImage2D(glTarget, mipLevel, x, y, width, height, glFormat, glType, image);\n                    break;\n                case '2d-array':\n                case '3d':\n                    // prettier-ignore\n                    this.gl.texSubImage3D(glTarget, mipLevel, x, y, z, width, height, depth, glFormat, glType, image);\n                    break;\n                default:\n                // Can never happen in WebGL\n            }\n        });\n        this.gl.bindTexture(this.glTarget, null);\n        return { width: options.width, height: options.height };\n    }\n    // WEBGL SPECIFIC\n    generateMipmapsWebGL(options) {\n        const isFilterableAndRenderable = this.device.isTextureFormatRenderable(this.props.format) &&\n            this.device.isTextureFormatFilterable(this.props.format);\n        if (!isFilterableAndRenderable) {\n            log.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)();\n            if (!options?.force) {\n                return;\n            }\n        }\n        try {\n            this.gl.bindTexture(this.glTarget, this.handle);\n            this.gl.generateMipmap(this.glTarget);\n        }\n        catch (error) {\n            log.warn(`Error generating mipmap for ${this}: ${error.message}`)();\n        }\n        finally {\n            this.gl.bindTexture(this.glTarget, null);\n        }\n    }\n    // INTERNAL\n    /**\n     * Sets sampler parameters on texture\n     */\n    _setSamplerParameters(parameters) {\n        log.log(2, `${this.id} sampler parameters`, this.device.getGLKeys(parameters))();\n        this.gl.bindTexture(this.glTarget, this.handle);\n        for (const [pname, pvalue] of Object.entries(parameters)) {\n            const param = Number(pname);\n            const value = pvalue;\n            // Apparently integer/float issues require two different texture parameter setting functions in JavaScript.\n            // For now, pick the float version for parameters specified as GLfloat.\n            switch (param) {\n                case 33082:\n                case 33083:\n                    this.gl.texParameterf(this.glTarget, param, value);\n                    break;\n                case 10240:\n                case 10241:\n                    this.gl.texParameteri(this.glTarget, param, value);\n                    break;\n                case 10242:\n                case 10243:\n                case 32882:\n                    this.gl.texParameteri(this.glTarget, param, value);\n                    break;\n                case 34046:\n                    // We have to query feature before using it\n                    if (this.device.features.has('texture-filterable-anisotropic-webgl')) {\n                        this.gl.texParameteri(this.glTarget, param, value);\n                    }\n                    break;\n                case 34892:\n                case 34893:\n                    this.gl.texParameteri(this.glTarget, param, value);\n                    break;\n            }\n        }\n        this.gl.bindTexture(this.glTarget, null);\n    }\n    _getActiveUnit() {\n        return this.gl.getParameter(34016) - 33984;\n    }\n    _bind(_textureUnit) {\n        const { gl } = this;\n        if (_textureUnit !== undefined) {\n            this._textureUnit = _textureUnit;\n            gl.activeTexture(33984 + _textureUnit);\n        }\n        gl.bindTexture(this.glTarget, this.handle);\n        // @ts-ignore TODO fix types\n        return _textureUnit;\n    }\n    _unbind(_textureUnit) {\n        const { gl } = this;\n        if (_textureUnit !== undefined) {\n            this._textureUnit = _textureUnit;\n            gl.activeTexture(33984 + _textureUnit);\n        }\n        gl.bindTexture(this.glTarget, null);\n        return _textureUnit;\n    }\n}\n// INTERNAL HELPERS\n/** Convert a WebGPU style texture constant to a WebGL style texture constant */\nexport function getWebGLTextureTarget(dimension) {\n    // prettier-ignore\n    switch (dimension) {\n        case '1d': break; // not supported in any WebGL version\n        case '2d': return 3553; // supported in WebGL1\n        case '3d': return 32879; // supported in WebGL2\n        case 'cube': return 34067; // supported in WebGL1\n        case '2d-array': return 35866; // supported in WebGL2\n        case 'cube-array': break; // not supported in any WebGL version\n    }\n    throw new Error(dimension);\n}\n/**\n * In WebGL, cube maps specify faces by overriding target instead of using the depth parameter.\n * @note We still bind the texture using GL.TEXTURE_CUBE_MAP, but we need to use the face-specific target when setting mip levels.\n * @returns glTarget unchanged, if dimension !== 'cube'.\n */\nexport function getWebGLCubeFaceTarget(glTarget, dimension, level) {\n    return dimension === 'cube' ? 34069 + level : glTarget;\n}\n//# sourceMappingURL=webgl-texture.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n/** Converts to a luma shadertype to a GL data type (GL.BYTE, GL.FLOAT32 etc)  */\nexport function convertDataTypeToGLDataType(normalizedType) {\n    return NORMALIZED_SHADER_TYPE_TO_WEBGL[normalizedType];\n}\n/** Converts to a luma shadertype to a GL data type (GL.BYTE, GL.FLOAT32 etc)  */\nexport function convertShaderVariableTypeToGLDataType(normalizedType) {\n    // @ts-ignore TODO\n    return NORMALIZED_SHADER_TYPE_TO_WEBGL[normalizedType];\n}\n/** Convert a WebGL \"compisite type (e.g. GL.VEC3) into the corresponding luma shader uniform type */\nexport function convertGLUniformTypeToShaderVariableType(glUniformType) {\n    return WEBGL_SHADER_TYPES[glUniformType];\n}\n/** Check if a WebGL \"uniform:\" is a texture binding */\nexport function isGLSamplerType(type) {\n    // @ts-ignore TODO\n    return Boolean(WEBGL_SAMPLER_TO_TEXTURE_BINDINGS[type]);\n}\n/* Get luma texture binding info (viewDimension and sampleType) from a WebGL \"sampler\" binding */\nexport function getTextureBindingFromGLSamplerType(glSamplerType) {\n    return WEBGL_SAMPLER_TO_TEXTURE_BINDINGS[glSamplerType];\n}\n/** Get vertex format from GL constants */\nexport function getVertexFormatFromGL(type, components) {\n    const base = getVertexTypeFromGL(type);\n    // prettier-ignore\n    switch (components) {\n        case 1: return base;\n        case 2: return `${base}x2`;\n        // @ts-expect-error - deal with lack of \"unaligned\" formats\n        case 3: return `${base}x3`;\n        case 4: return `${base}x4`;\n    }\n    // @ts-ignore unreachable\n    throw new Error(String(components));\n}\n/** Get data type from GL constants */\nexport function getVertexTypeFromGL(glType, normalized = false) {\n    const index = normalized ? 1 : 0;\n    return WEBGL_TO_NORMALIZED_DATA_TYPE[glType][index];\n}\n// Composite types table\n// @ts-ignore TODO - fix the type confusion here\nconst WEBGL_SHADER_TYPES = {\n    [5126]: 'f32',\n    [35664]: 'vec2<f32>',\n    [35665]: 'vec3<f32>',\n    [35666]: 'vec4<f32>',\n    [5124]: 'i32',\n    [35667]: 'vec2<i32>',\n    [35668]: 'vec3<i32>',\n    [35669]: 'vec4<i32>',\n    [5125]: 'u32',\n    [36294]: 'vec2<u32>',\n    [36295]: 'vec3<u32>',\n    [36296]: 'vec4<u32>',\n    [35670]: 'f32',\n    [35671]: 'vec2<f32>',\n    [35672]: 'vec3<f32>',\n    [35673]: 'vec4<f32>',\n    // TODO - are sizes/components below correct?\n    [35674]: 'mat2x2<f32>',\n    [35685]: 'mat2x3<f32>',\n    [35686]: 'mat2x4<f32>',\n    [35687]: 'mat3x2<f32>',\n    [35675]: 'mat3x3<f32>',\n    [35688]: 'mat3x4<f32>',\n    [35689]: 'mat4x2<f32>',\n    [35690]: 'mat4x3<f32>',\n    [35676]: 'mat4x4<f32>'\n};\nconst WEBGL_SAMPLER_TO_TEXTURE_BINDINGS = {\n    [35678]: { viewDimension: '2d', sampleType: 'float' },\n    [35680]: { viewDimension: 'cube', sampleType: 'float' },\n    [35679]: { viewDimension: '3d', sampleType: 'float' },\n    [35682]: { viewDimension: '3d', sampleType: 'depth' },\n    [36289]: { viewDimension: '2d-array', sampleType: 'float' },\n    [36292]: { viewDimension: '2d-array', sampleType: 'depth' },\n    [36293]: { viewDimension: 'cube', sampleType: 'float' },\n    [36298]: { viewDimension: '2d', sampleType: 'sint' },\n    [36299]: { viewDimension: '3d', sampleType: 'sint' },\n    [36300]: { viewDimension: 'cube', sampleType: 'sint' },\n    [36303]: { viewDimension: '2d-array', sampleType: 'uint' },\n    [36306]: { viewDimension: '2d', sampleType: 'uint' },\n    [36307]: { viewDimension: '3d', sampleType: 'uint' },\n    [36308]: { viewDimension: 'cube', sampleType: 'uint' },\n    [36311]: { viewDimension: '2d-array', sampleType: 'uint' }\n};\n/** Map from WebGL normalized types to WebGL */\nconst NORMALIZED_SHADER_TYPE_TO_WEBGL = {\n    uint8: 5121,\n    sint8: 5120,\n    unorm8: 5121,\n    snorm8: 5120,\n    uint16: 5123,\n    sint16: 5122,\n    unorm16: 5123,\n    snorm16: 5122,\n    uint32: 5125,\n    sint32: 5124,\n    // WebGPU does not support normalized 32 bit integer attributes\n    //  'unorm32': GL.UNSIGNED_INT,\n    //  'snorm32': GL.INT,\n    float16: 5131,\n    float32: 5126\n};\n/* Map from WebGL types to webgpu normalized types */\nconst WEBGL_TO_NORMALIZED_DATA_TYPE = {\n    [5120]: ['sint8', 'snorm16'],\n    [5121]: ['uint8', 'unorm8'],\n    [5122]: ['sint16', 'unorm16'],\n    [5123]: ['uint16', 'unorm16'],\n    [5124]: ['sint32', 'sint32'],\n    [5125]: ['uint32', 'uint32'],\n    [5126]: ['float32', 'float32'],\n    [5131]: ['float16', 'float16']\n};\n//# sourceMappingURL=webgl-shadertypes.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { getVariableShaderTypeInfo } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { isGLSamplerType, getTextureBindingFromGLSamplerType, convertGLUniformTypeToShaderVariableType } from \"../converters/webgl-shadertypes.js\";\n/**\n * Extract metadata describing binding information for a program's shaders\n * Note: `linkProgram()` needs to have been called\n * (although linking does not need to have been successful).\n */\nexport function getShaderLayoutFromGLSL(gl, program) {\n    const shaderLayout = {\n        attributes: [],\n        bindings: []\n    };\n    shaderLayout.attributes = readAttributeDeclarations(gl, program);\n    // Uniform blocks\n    const uniformBlocks = readUniformBlocks(gl, program);\n    for (const uniformBlock of uniformBlocks) {\n        const uniforms = uniformBlock.uniforms.map(uniform => ({\n            name: uniform.name,\n            format: uniform.format,\n            byteOffset: uniform.byteOffset,\n            byteStride: uniform.byteStride,\n            arrayLength: uniform.arrayLength\n        }));\n        shaderLayout.bindings.push({\n            type: 'uniform',\n            name: uniformBlock.name,\n            group: 0,\n            location: uniformBlock.location,\n            visibility: (uniformBlock.vertex ? 0x1 : 0) & (uniformBlock.fragment ? 0x2 : 0),\n            minBindingSize: uniformBlock.byteLength,\n            uniforms\n        });\n    }\n    const uniforms = readUniformBindings(gl, program);\n    let textureUnit = 0;\n    for (const uniform of uniforms) {\n        if (isGLSamplerType(uniform.type)) {\n            const { viewDimension, sampleType } = getTextureBindingFromGLSamplerType(uniform.type);\n            shaderLayout.bindings.push({\n                type: 'texture',\n                name: uniform.name,\n                group: 0,\n                location: textureUnit,\n                viewDimension,\n                sampleType\n            });\n            // @ts-expect-error\n            uniform.textureUnit = textureUnit;\n            textureUnit += 1;\n        }\n    }\n    if (uniforms.length) {\n        shaderLayout.uniforms = uniforms;\n    }\n    // Varyings\n    const varyings = readVaryings(gl, program);\n    // Note - samplers are always in unform bindings, even if uniform blocks are used\n    if (varyings?.length) {\n        shaderLayout.varyings = varyings;\n    }\n    return shaderLayout;\n}\n// HELPERS\n/**\n * Extract info about all transform feedback varyings\n *\n * linkProgram needs to have been called, although linking does not need to have been successful\n */\nfunction readAttributeDeclarations(gl, program) {\n    const attributes = [];\n    const count = gl.getProgramParameter(program, 35721);\n    for (let index = 0; index < count; index++) {\n        const activeInfo = gl.getActiveAttrib(program, index);\n        if (!activeInfo) {\n            throw new Error('activeInfo');\n        }\n        const { name, type: compositeType /* , size*/ } = activeInfo;\n        const location = gl.getAttribLocation(program, name);\n        // Add only user provided attributes, for built-in attributes like `gl_InstanceID` location will be < 0\n        if (location >= 0) {\n            const attributeType = convertGLUniformTypeToShaderVariableType(compositeType);\n            // Whether an attribute is instanced is essentially fixed by the structure of the shader code,\n            // so it is arguably a static property of the shader.\n            // There is no hint in the shader declarations\n            // Heuristic: Any attribute name containing the word \"instance\" will be assumed to be instanced\n            const stepMode = /instance/i.test(name) ? 'instance' : 'vertex';\n            attributes.push({\n                name,\n                location,\n                stepMode,\n                type: attributeType\n                // size - for arrays, size is the number of elements in the array\n            });\n        }\n    }\n    // Sort by declaration order\n    attributes.sort((a, b) => a.location - b.location);\n    return attributes;\n}\n/**\n * Extract info about all transform feedback varyings\n *\n * linkProgram needs to have been called, although linking does not need to have been successful\n */\nfunction readVaryings(gl, program) {\n    const varyings = [];\n    const count = gl.getProgramParameter(program, 35971);\n    for (let location = 0; location < count; location++) {\n        const activeInfo = gl.getTransformFeedbackVarying(program, location);\n        if (!activeInfo) {\n            throw new Error('activeInfo');\n        }\n        const { name, type: glUniformType, size } = activeInfo;\n        const uniformType = convertGLUniformTypeToShaderVariableType(glUniformType);\n        const { type, components } = getVariableShaderTypeInfo(uniformType);\n        varyings.push({ location, name, type, size: size * components });\n    }\n    varyings.sort((a, b) => a.location - b.location);\n    return varyings;\n}\n/**\n * Extract info about all uniforms\n *\n * Query uniform locations and build name to setter map.\n */\nfunction readUniformBindings(gl, program) {\n    const uniforms = [];\n    const uniformCount = gl.getProgramParameter(program, 35718);\n    for (let i = 0; i < uniformCount; i++) {\n        const activeInfo = gl.getActiveUniform(program, i);\n        if (!activeInfo) {\n            throw new Error('activeInfo');\n        }\n        const { name: rawName, size, type } = activeInfo;\n        const { name, isArray } = parseUniformName(rawName);\n        let webglLocation = gl.getUniformLocation(program, name);\n        const uniformInfo = {\n            // WebGL locations are uniquely typed but just numbers\n            location: webglLocation,\n            name,\n            size,\n            type,\n            isArray\n        };\n        uniforms.push(uniformInfo);\n        // Array (e.g. matrix) uniforms can occupy several 4x4 byte banks\n        if (uniformInfo.size > 1) {\n            for (let j = 0; j < uniformInfo.size; j++) {\n                const elementName = `${name}[${j}]`;\n                webglLocation = gl.getUniformLocation(program, elementName);\n                const arrayElementUniformInfo = {\n                    ...uniformInfo,\n                    name: elementName,\n                    location: webglLocation\n                };\n                uniforms.push(arrayElementUniformInfo);\n            }\n        }\n    }\n    return uniforms;\n}\n/**\n * Extract info about all \"active\" uniform blocks\n * @note In WebGL, \"active\" just means that unused (inactive) blocks may have been optimized away during linking)\n */\nfunction readUniformBlocks(gl, program) {\n    const getBlockParameter = (blockIndex, pname) => gl.getActiveUniformBlockParameter(program, blockIndex, pname);\n    const uniformBlocks = [];\n    const blockCount = gl.getProgramParameter(program, 35382);\n    for (let blockIndex = 0; blockIndex < blockCount; blockIndex++) {\n        const blockInfo = {\n            name: gl.getActiveUniformBlockName(program, blockIndex) || '',\n            location: getBlockParameter(blockIndex, 35391),\n            byteLength: getBlockParameter(blockIndex, 35392),\n            vertex: getBlockParameter(blockIndex, 35396),\n            fragment: getBlockParameter(blockIndex, 35398),\n            uniformCount: getBlockParameter(blockIndex, 35394),\n            uniforms: []\n        };\n        const uniformIndices = getBlockParameter(blockIndex, 35395) || [];\n        const uniformType = gl.getActiveUniforms(program, uniformIndices, 35383); // Array of GLenum indicating the types of the uniforms.\n        const uniformArrayLength = gl.getActiveUniforms(program, uniformIndices, 35384); // Array of GLuint indicating the sizes of the uniforms.\n        // const uniformBlockIndex = gl.getActiveUniforms(\n        //   program,\n        //   uniformIndices,\n        //   GL.UNIFORM_BLOCK_INDEX\n        // ); // Array of GLint indicating the block indices of the uniforms.\n        const uniformOffset = gl.getActiveUniforms(program, uniformIndices, 35387); // Array of GLint indicating the uniform buffer offsets.\n        const uniformStride = gl.getActiveUniforms(program, uniformIndices, 35388); // Array of GLint indicating the strides between the elements.\n        // const uniformMatrixStride = gl.getActiveUniforms(\n        //   program,\n        //   uniformIndices,\n        //   GL.UNIFORM_MATRIX_STRIDE\n        // ); // Array of GLint indicating the strides between columns of a column-major matrix or a row-major matrix.\n        // const uniformRowMajor = gl.getActiveUniforms(program, uniformIndices, GL.UNIFORM_IS_ROW_MAJOR);\n        for (let i = 0; i < blockInfo.uniformCount; ++i) {\n            const activeInfo = gl.getActiveUniform(program, uniformIndices[i]);\n            if (!activeInfo) {\n                throw new Error('activeInfo');\n            }\n            const format = convertGLUniformTypeToShaderVariableType(uniformType[i]);\n            blockInfo.uniforms.push({\n                name: activeInfo.name,\n                format,\n                type: uniformType[i],\n                arrayLength: uniformArrayLength[i],\n                byteOffset: uniformOffset[i],\n                byteStride: uniformStride[i]\n                // matrixStride: uniformStride[i],\n                // rowMajor: uniformRowMajor[i]\n            });\n        }\n        uniformBlocks.push(blockInfo);\n    }\n    uniformBlocks.sort((a, b) => a.location - b.location);\n    return uniformBlocks;\n}\n/**\n * TOOD - compare with a above, confirm copy, then delete\n  const bindings: Binding[] = [];\n  const count = gl.getProgramParameter(program, gl.ACTIVE_UNIFORM_BLOCKS);\n  for (let blockIndex = 0; blockIndex < count; blockIndex++) {\n    const vertex = gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),\n    const fragment = gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),\n    const visibility = (vertex) + (fragment);\n    const binding: BufferBinding = {\n      location: gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_BINDING),\n      // name: gl.getActiveUniformBlockName(program, blockIndex),\n      type: 'uniform',\n      visibility,\n      minBindingSize: gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_DATA_SIZE),\n      // uniformCount: gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_ACTIVE_UNIFORMS),\n      // uniformIndices: gl.getActiveUniformBlockParameter(program, blockIndex, gl.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES),\n    }\n    bindings.push(binding);\n  }\n*/\n// HELPERS\nfunction parseUniformName(name) {\n    // Shortcut to avoid redundant or bad matches\n    if (name[name.length - 1] !== ']') {\n        return {\n            name,\n            length: 1,\n            isArray: false\n        };\n    }\n    // if array name then clean the array brackets\n    const UNIFORM_NAME_REGEXP = /([^[]*)(\\[[0-9]+\\])?/;\n    const matches = UNIFORM_NAME_REGEXP.exec(name);\n    if (!matches || matches.length < 2) {\n        throw new Error(`Failed to parse GLSL uniform name ${name}`);\n    }\n    return {\n        name: matches[1],\n        length: matches[2] ? 1 : 0,\n        isArray: Boolean(matches[2])\n    };\n}\n//# sourceMappingURL=get-shader-layout-from-glsl.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n/** Set a raw uniform (without type conversion and caching) */\n/* eslint-disable max-len */\nexport function setUniform(gl, location, type, value) {\n    const gl2 = gl;\n    // Prepare the value for WebGL setters\n    let uniformValue = value;\n    if (uniformValue === true) {\n        uniformValue = 1;\n    }\n    if (uniformValue === false) {\n        uniformValue = 0;\n    }\n    const arrayValue = typeof uniformValue === 'number' ? [uniformValue] : uniformValue;\n    // prettier-ignore\n    switch (type) {\n        case 35678:\n        case 35680:\n        case 35679:\n        case 35682:\n        case 36289:\n        case 36292:\n        case 36293:\n        case 36298:\n        case 36299:\n        case 36300:\n        case 36303:\n        case 36306:\n        case 36307:\n        case 36308:\n        case 36311:\n            if (typeof value !== 'number') {\n                throw new Error('samplers must be set to integers');\n            }\n            return gl.uniform1i(location, value);\n        case 5126: return gl.uniform1fv(location, arrayValue);\n        case 35664: return gl.uniform2fv(location, arrayValue);\n        case 35665: return gl.uniform3fv(location, arrayValue);\n        case 35666: return gl.uniform4fv(location, arrayValue);\n        case 5124: return gl.uniform1iv(location, arrayValue);\n        case 35667: return gl.uniform2iv(location, arrayValue);\n        case 35668: return gl.uniform3iv(location, arrayValue);\n        case 35669: return gl.uniform4iv(location, arrayValue);\n        case 35670: return gl.uniform1iv(location, arrayValue);\n        case 35671: return gl.uniform2iv(location, arrayValue);\n        case 35672: return gl.uniform3iv(location, arrayValue);\n        case 35673: return gl.uniform4iv(location, arrayValue);\n        // WEBGL2 - unsigned integers\n        case 5125: return gl2.uniform1uiv(location, arrayValue, 1);\n        case 36294: return gl2.uniform2uiv(location, arrayValue, 2);\n        case 36295: return gl2.uniform3uiv(location, arrayValue, 3);\n        case 36296: return gl2.uniform4uiv(location, arrayValue, 4);\n        // WebGL2 - quadratic matrices\n        // false: don't transpose the matrix\n        case 35674: return gl.uniformMatrix2fv(location, false, arrayValue);\n        case 35675: return gl.uniformMatrix3fv(location, false, arrayValue);\n        case 35676: return gl.uniformMatrix4fv(location, false, arrayValue);\n        // WebGL2 - rectangular matrices\n        case 35685: return gl2.uniformMatrix2x3fv(location, false, arrayValue);\n        case 35686: return gl2.uniformMatrix2x4fv(location, false, arrayValue);\n        case 35687: return gl2.uniformMatrix3x2fv(location, false, arrayValue);\n        case 35688: return gl2.uniformMatrix3x4fv(location, false, arrayValue);\n        case 35689: return gl2.uniformMatrix4x2fv(location, false, arrayValue);\n        case 35690: return gl2.uniformMatrix4x3fv(location, false, arrayValue);\n    }\n    throw new Error('Illegal uniform');\n}\n//# sourceMappingURL=set-uniform.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n// Counts the number of complete primitives given a number of vertices and a drawMode\nexport function getPrimitiveDrawMode(drawMode) {\n    switch (drawMode) {\n        case 0:\n            return 0;\n        case 1:\n            return 1;\n        case 3:\n            return 1;\n        case 2:\n            return 1;\n        case 4:\n            return 4;\n        case 5:\n            return 4;\n        case 6:\n            return 4;\n        default:\n            throw new Error('drawMode');\n    }\n}\n// Counts the number of complete \"primitives\" given a number of vertices and a drawMode\nexport function getPrimitiveCount(options) {\n    const { drawMode, vertexCount } = options;\n    switch (drawMode) {\n        case 0:\n        case 2:\n            return vertexCount;\n        case 1:\n            return vertexCount / 2;\n        case 3:\n            return vertexCount - 1;\n        case 4:\n            return vertexCount / 3;\n        case 5:\n        case 6:\n            return vertexCount - 2;\n        default:\n            throw new Error('drawMode');\n    }\n}\n// Counts the number of vertices after splitting the vertex stream into separate \"primitives\"\nexport function getVertexCount(options) {\n    const { drawMode, vertexCount } = options;\n    const primitiveCount = getPrimitiveCount({ drawMode, vertexCount });\n    switch (getPrimitiveDrawMode(drawMode)) {\n        case 0:\n            return primitiveCount;\n        case 1:\n            return primitiveCount * 2;\n        case 4:\n            return primitiveCount * 3;\n        default:\n            throw new Error('drawMode');\n    }\n}\n/** Get the primitive type for draw */\nexport function getGLDrawMode(topology) {\n    // prettier-ignore\n    switch (topology) {\n        case 'point-list': return 0;\n        case 'line-list': return 1;\n        case 'line-strip': return 3;\n        case 'triangle-list': return 4;\n        case 'triangle-strip': return 5;\n        default: throw new Error(topology);\n    }\n}\n/** Get the primitive type for transform feedback */\nexport function getGLPrimitive(topology) {\n    // prettier-ignore\n    switch (topology) {\n        case 'point-list': return 0;\n        case 'line-list': return 1;\n        case 'line-strip': return 1;\n        case 'triangle-list': return 4;\n        case 'triangle-strip': return 4;\n        default: throw new Error(topology);\n    }\n}\n//# sourceMappingURL=webgl-topology-utils.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { RenderPipeline, log } from '@luma.gl/core';\n// import {getAttributeInfosFromLayouts} from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { getShaderLayoutFromGLSL } from \"../helpers/get-shader-layout-from-glsl.js\";\nimport { withDeviceAndGLParameters } from \"../converters/device-parameters.js\";\nimport { setUniform } from \"../helpers/set-uniform.js\";\nimport { WEBGLBuffer } from \"./webgl-buffer.js\";\nimport { WEBGLFramebuffer } from \"./webgl-framebuffer.js\";\nimport { WEBGLTexture } from \"./webgl-texture.js\";\nimport { WEBGLTextureView } from \"./webgl-texture-view.js\";\nimport { getGLDrawMode } from \"../helpers/webgl-topology-utils.js\";\nconst LOG_PROGRAM_PERF_PRIORITY = 4;\n/** Creates a new render pipeline */\nexport class WEBGLRenderPipeline extends RenderPipeline {\n    /** The WebGL device that created this render pipeline */\n    device;\n    /** Handle to underlying WebGL program */\n    handle;\n    /** vertex shader */\n    vs;\n    /** fragment shader */\n    fs;\n    /** The layout extracted from shader by WebGL introspection APIs */\n    introspectedLayout;\n    /** Uniforms set on this model */\n    uniforms = {};\n    /** Bindings set on this model */\n    bindings = {};\n    /** WebGL varyings */\n    varyings = null;\n    _uniformCount = 0;\n    _uniformSetters = {}; // TODO are these used?\n    get [Symbol.toStringTag]() {\n        return 'WEBGLRenderPipeline';\n    }\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.handle = this.props.handle || this.device.gl.createProgram();\n        this.device._setWebGLDebugMetadata(this.handle, this, { spector: { id: this.props.id } });\n        // Create shaders if needed\n        this.vs = props.vs;\n        this.fs = props.fs;\n        // assert(this.vs.stage === 'vertex');\n        // assert(this.fs.stage === 'fragment');\n        // Setup varyings if supplied\n        // @ts-expect-error WebGL only\n        const { varyings, bufferMode = 35981 } = props;\n        if (varyings && varyings.length > 0) {\n            this.varyings = varyings;\n            this.device.gl.transformFeedbackVaryings(this.handle, varyings, bufferMode);\n        }\n        this._linkShaders();\n        log.time(3, `RenderPipeline ${this.id} - shaderLayout introspection`)();\n        this.introspectedLayout = getShaderLayoutFromGLSL(this.device.gl, this.handle);\n        log.timeEnd(3, `RenderPipeline ${this.id} - shaderLayout introspection`)();\n        // Merge provided layout with introspected layout\n        this.shaderLayout = props.shaderLayout\n            ? mergeShaderLayout(this.introspectedLayout, props.shaderLayout)\n            : this.introspectedLayout;\n    }\n    destroy() {\n        if (this.handle) {\n            // log.error(`Deleting program ${this.id}`)();\n            this.device.gl.useProgram(null);\n            this.device.gl.deleteProgram(this.handle);\n            this.destroyed = true;\n            // @ts-expect-error\n            this.handle.destroyed = true;\n            // @ts-ignore\n            this.handle = null;\n        }\n    }\n    /**\n     * Bindings include: textures, samplers and uniform buffers\n     * @todo needed for portable model\n     */\n    setBindings(bindings, options) {\n        // if (log.priority >= 2) {\n        //   checkUniformValues(uniforms, this.id, this._uniformSetters);\n        // }\n        for (const [name, value] of Object.entries(bindings)) {\n            // Accept both `xyz` and `xyzUniforms` as valid names for `xyzUniforms` uniform block\n            // This convention allows shaders to name uniform blocks as `uniform appUniforms {} app;`\n            // and reference them as `app` from both GLSL and JS.\n            // TODO - this is rather hacky - we could also remap the name directly in the shader layout.\n            const binding = this.shaderLayout.bindings.find(binding_ => binding_.name === name) ||\n                this.shaderLayout.bindings.find(binding_ => binding_.name === `${name}Uniforms`);\n            if (!binding) {\n                const validBindings = this.shaderLayout.bindings\n                    .map(binding_ => `\"${binding_.name}\"`)\n                    .join(', ');\n                if (!options?.disableWarnings) {\n                    log.warn(`No binding \"${name}\" in render pipeline \"${this.id}\", expected one of ${validBindings}`, value)();\n                }\n                continue; // eslint-disable-line no-continue\n            }\n            if (!value) {\n                log.warn(`Unsetting binding \"${name}\" in render pipeline \"${this.id}\"`)();\n            }\n            switch (binding.type) {\n                case 'uniform':\n                    // @ts-expect-error\n                    if (!(value instanceof WEBGLBuffer) && !(value.buffer instanceof WEBGLBuffer)) {\n                        throw new Error('buffer value');\n                    }\n                    break;\n                case 'texture':\n                    if (!(value instanceof WEBGLTextureView ||\n                        value instanceof WEBGLTexture ||\n                        value instanceof WEBGLFramebuffer)) {\n                        throw new Error(`${this} Bad texture binding for ${name}`);\n                    }\n                    break;\n                case 'sampler':\n                    log.warn(`Ignoring sampler ${name}`)();\n                    break;\n                default:\n                    throw new Error(binding.type);\n            }\n            this.bindings[name] = value;\n        }\n    }\n    /** @todo needed for portable model\n     * @note The WebGL API is offers many ways to draw things\n     * This function unifies those ways into a single call using common parameters with sane defaults\n     */\n    draw(options) {\n        const { renderPass, parameters = this.props.parameters, topology = this.props.topology, vertexArray, vertexCount, \n        // indexCount,\n        instanceCount, isInstanced = false, firstVertex = 0, \n        // firstIndex,\n        // firstInstance,\n        // baseVertex,\n        transformFeedback } = options;\n        const glDrawMode = getGLDrawMode(topology);\n        const isIndexed = Boolean(vertexArray.indexBuffer);\n        const glIndexType = vertexArray.indexBuffer?.glIndexType;\n        // Note that we sometimes get called with 0 instances\n        // If we are using async linking, we need to wait until linking completes\n        if (this.linkStatus !== 'success') {\n            log.info(2, `RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)();\n            return false;\n        }\n        // Avoid WebGL draw call when not rendering any data or values are incomplete\n        // Note: async textures set as uniforms might still be loading.\n        // Now that all uniforms have been updated, check if any texture\n        // in the uniforms is not yet initialized, then we don't draw\n        if (!this._areTexturesRenderable()) {\n            log.info(2, `RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)();\n            //  Note: false means that the app needs to redraw the pipeline again.\n            return false;\n        }\n        // (isInstanced && instanceCount === 0)\n        // if (vertexCount === 0) {\n        //   log.info(2, `RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)();\n        //   Note: false means that the app needs to redraw the pipeline again.\n        //   return true;\n        // }\n        this.device.gl.useProgram(this.handle);\n        // Note: Rebinds constant attributes before each draw call\n        vertexArray.bindBeforeRender(renderPass);\n        if (transformFeedback) {\n            transformFeedback.begin(this.props.topology);\n        }\n        // We have to apply bindings before every draw call since other draw calls will overwrite\n        this._applyBindings();\n        this._applyUniforms();\n        const webglRenderPass = renderPass;\n        withDeviceAndGLParameters(this.device, parameters, webglRenderPass.glParameters, () => {\n            if (isIndexed && isInstanced) {\n                this.device.gl.drawElementsInstanced(glDrawMode, vertexCount || 0, // indexCount?\n                glIndexType, firstVertex, instanceCount || 0);\n                // } else if (isIndexed && this.device.isWebGL2 && !isNaN(start) && !isNaN(end)) {\n                //   this.device.gldrawRangeElements(glDrawMode, start, end, vertexCount, glIndexType, offset);\n            }\n            else if (isIndexed) {\n                this.device.gl.drawElements(glDrawMode, vertexCount || 0, glIndexType, firstVertex); // indexCount?\n            }\n            else if (isInstanced) {\n                this.device.gl.drawArraysInstanced(glDrawMode, firstVertex, vertexCount || 0, instanceCount || 0);\n            }\n            else {\n                this.device.gl.drawArrays(glDrawMode, firstVertex, vertexCount || 0);\n            }\n            if (transformFeedback) {\n                transformFeedback.end();\n            }\n        });\n        vertexArray.unbindAfterRender(renderPass);\n        return true;\n    }\n    // PRIVATE METHODS\n    // setAttributes(attributes: Record<string, Buffer>): void {}\n    // setBindings(bindings: Record<string, Binding>): void {}\n    async _linkShaders() {\n        const { gl } = this.device;\n        gl.attachShader(this.handle, this.vs.handle);\n        gl.attachShader(this.handle, this.fs.handle);\n        log.time(LOG_PROGRAM_PERF_PRIORITY, `linkProgram for ${this.id}`)();\n        gl.linkProgram(this.handle);\n        log.timeEnd(LOG_PROGRAM_PERF_PRIORITY, `linkProgram for ${this.id}`)();\n        // TODO Avoid checking program linking error in production\n        if (log.level === 0) {\n            // return;\n        }\n        if (!this.device.features.has('compilation-status-async-webgl')) {\n            const status = this._getLinkStatus();\n            this._reportLinkStatus(status);\n            return;\n        }\n        // async case\n        log.once(1, 'RenderPipeline linking is asynchronous')();\n        await this._waitForLinkComplete();\n        log.info(2, `RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();\n        const status = this._getLinkStatus();\n        this._reportLinkStatus(status);\n    }\n    /** Report link status. First, check for shader compilation failures if linking fails */\n    async _reportLinkStatus(status) {\n        switch (status) {\n            case 'success':\n                return;\n            default:\n                const errorType = status === 'link-error' ? 'Link error' : 'Validation error';\n                // First check for shader compilation failures if linking fails\n                switch (this.vs.compilationStatus) {\n                    case 'error':\n                        this.vs.debugShader();\n                        throw new Error(`${this} ${errorType} during compilation of ${this.vs}`);\n                    case 'pending':\n                        await this.vs.asyncCompilationStatus;\n                        this.vs.debugShader();\n                        break;\n                    case 'success':\n                        break;\n                }\n                switch (this.fs?.compilationStatus) {\n                    case 'error':\n                        this.fs.debugShader();\n                        throw new Error(`${this} ${errorType} during compilation of ${this.fs}`);\n                    case 'pending':\n                        await this.fs.asyncCompilationStatus;\n                        this.fs.debugShader();\n                        break;\n                    case 'success':\n                        break;\n                }\n                const linkErrorLog = this.device.gl.getProgramInfoLog(this.handle);\n                this.device.reportError(new Error(`${errorType} during ${status}: ${linkErrorLog}`), this)();\n                this.device.debug();\n        }\n    }\n    /**\n     * Get the shader compilation status\n     * TODO - Load log even when no error reported, to catch warnings?\n     * https://gamedev.stackexchange.com/questions/30429/how-to-detect-glsl-warnings\n     */\n    _getLinkStatus() {\n        const { gl } = this.device;\n        const linked = gl.getProgramParameter(this.handle, 35714);\n        if (!linked) {\n            this.linkStatus = 'error';\n            return 'link-error';\n        }\n        gl.validateProgram(this.handle);\n        const validated = gl.getProgramParameter(this.handle, 35715);\n        if (!validated) {\n            this.linkStatus = 'error';\n            return 'validation-error';\n        }\n        this.linkStatus = 'success';\n        return 'success';\n    }\n    /** Use KHR_parallel_shader_compile extension if available */\n    async _waitForLinkComplete() {\n        const waitMs = async (ms) => await new Promise(resolve => setTimeout(resolve, ms));\n        const DELAY_MS = 10; // Shader compilation is typically quite fast (with some exceptions)\n        // If status polling is not available, we can't wait for completion. Just wait a little to minimize blocking\n        if (!this.device.features.has('compilation-status-async-webgl')) {\n            await waitMs(DELAY_MS);\n            return;\n        }\n        const { gl } = this.device;\n        for (;;) {\n            const complete = gl.getProgramParameter(this.handle, 37297);\n            if (complete) {\n                return;\n            }\n            await waitMs(DELAY_MS);\n        }\n    }\n    /**\n     * Checks if all texture-values uniforms are renderable (i.e. loaded)\n     * Update a texture if needed (e.g. from video)\n     * Note: This is currently done before every draw call\n     */\n    _areTexturesRenderable() {\n        let texturesRenderable = true;\n        for (const bindingInfo of this.shaderLayout.bindings) {\n            if (!this.bindings[bindingInfo.name] &&\n                !this.bindings[bindingInfo.name.replace(/Uniforms$/, '')]) {\n                log.warn(`Binding ${bindingInfo.name} not found in ${this.id}`)();\n                texturesRenderable = false;\n            }\n        }\n        // TODO - remove this should be handled by ExternalTexture\n        // for (const [, texture] of Object.entries(this.bindings)) {\n        //   if (texture instanceof WEBGLTexture) {\n        //     texture.update();\n        //   }\n        // }\n        return texturesRenderable;\n    }\n    /** Apply any bindings (before each draw call) */\n    _applyBindings() {\n        // If we are using async linking, we need to wait until linking completes\n        if (this.linkStatus !== 'success') {\n            return;\n        }\n        const { gl } = this.device;\n        gl.useProgram(this.handle);\n        let textureUnit = 0;\n        let uniformBufferIndex = 0;\n        for (const binding of this.shaderLayout.bindings) {\n            // Accept both `xyz` and `xyzUniforms` as valid names for `xyzUniforms` uniform block\n            const value = this.bindings[binding.name] || this.bindings[binding.name.replace(/Uniforms$/, '')];\n            if (!value) {\n                throw new Error(`No value for binding ${binding.name} in ${this.id}`);\n            }\n            switch (binding.type) {\n                case 'uniform':\n                    // Set buffer\n                    const { name } = binding;\n                    const location = gl.getUniformBlockIndex(this.handle, name);\n                    if (location === 4294967295) {\n                        throw new Error(`Invalid uniform block name ${name}`);\n                    }\n                    gl.uniformBlockBinding(this.handle, uniformBufferIndex, location);\n                    // console.debug(binding, location);\n                    if (value instanceof WEBGLBuffer) {\n                        gl.bindBufferBase(35345, uniformBufferIndex, value.handle);\n                    }\n                    else {\n                        gl.bindBufferRange(35345, uniformBufferIndex, \n                        // @ts-expect-error\n                        value.buffer.handle, \n                        // @ts-expect-error\n                        value.offset || 0, \n                        // @ts-expect-error\n                        value.size || value.buffer.byteLength - value.offset);\n                    }\n                    uniformBufferIndex += 1;\n                    break;\n                case 'texture':\n                    if (!(value instanceof WEBGLTextureView ||\n                        value instanceof WEBGLTexture ||\n                        value instanceof WEBGLFramebuffer)) {\n                        throw new Error('texture');\n                    }\n                    let texture;\n                    if (value instanceof WEBGLTextureView) {\n                        texture = value.texture;\n                    }\n                    else if (value instanceof WEBGLTexture) {\n                        texture = value;\n                    }\n                    else if (value instanceof WEBGLFramebuffer &&\n                        value.colorAttachments[0] instanceof WEBGLTextureView) {\n                        log.warn('Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead')();\n                        texture = value.colorAttachments[0].texture;\n                    }\n                    else {\n                        throw new Error('No texture');\n                    }\n                    gl.activeTexture(33984 + textureUnit);\n                    gl.bindTexture(texture.glTarget, texture.handle);\n                    // gl.bindSampler(textureUnit, sampler.handle);\n                    textureUnit += 1;\n                    break;\n                case 'sampler':\n                    // ignore\n                    break;\n                case 'storage':\n                case 'read-only-storage':\n                    throw new Error(`binding type '${binding.type}' not supported in WebGL`);\n            }\n        }\n    }\n    /**\n     * Due to program sharing, uniforms need to be reset before every draw call\n     * (though caching will avoid redundant WebGL calls)\n     */\n    _applyUniforms() {\n        for (const uniformLayout of this.shaderLayout.uniforms || []) {\n            const { name, location, type, textureUnit } = uniformLayout;\n            const value = this.uniforms[name] ?? textureUnit;\n            if (value !== undefined) {\n                setUniform(this.device.gl, location, type, value);\n            }\n        }\n    }\n}\n/**\n * Merges an provided shader layout into a base shader layout\n * In WebGL, this allows the auto generated shader layout to be overridden by the application\n * Typically to change the format of the vertex attributes (from float32x4 to uint8x4 etc).\n * @todo Drop this? Aren't all use cases covered by mergeBufferLayout()?\n */\nfunction mergeShaderLayout(baseLayout, overrideLayout) {\n    // Deep clone the base layout\n    const mergedLayout = {\n        ...baseLayout,\n        attributes: baseLayout.attributes.map(attribute => ({ ...attribute }))\n    };\n    // Merge the attributes\n    for (const attribute of overrideLayout?.attributes || []) {\n        const baseAttribute = mergedLayout.attributes.find(attr => attr.name === attribute.name);\n        if (!baseAttribute) {\n            log.warn(`shader layout attribute ${attribute.name} not present in shader`);\n        }\n        else {\n            baseAttribute.type = attribute.type || baseAttribute.type;\n            baseAttribute.stepMode = attribute.stepMode || baseAttribute.stepMode;\n        }\n    }\n    return mergedLayout;\n}\n//# sourceMappingURL=webgl-render-pipeline.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { CommandBuffer, Texture } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { WEBGLTexture } from \"./webgl-texture.js\";\nimport { getTextureFormatWebGL } from \"../converters/webgl-texture-table.js\";\nexport class WEBGLCommandBuffer extends CommandBuffer {\n    device;\n    handle = null;\n    commands = [];\n    constructor(device) {\n        super(device, {});\n        this.device = device;\n    }\n    _executeCommands(commands = this.commands) {\n        for (const command of commands) {\n            switch (command.name) {\n                case 'copy-buffer-to-buffer':\n                    _copyBufferToBuffer(this.device, command.options);\n                    break;\n                case 'copy-buffer-to-texture':\n                    _copyBufferToTexture(this.device, command.options);\n                    break;\n                case 'copy-texture-to-buffer':\n                    _copyTextureToBuffer(this.device, command.options);\n                    break;\n                case 'copy-texture-to-texture':\n                    _copyTextureToTexture(this.device, command.options);\n                    break;\n                // case 'clear-texture':\n                //   _clearTexture(this.device, command.options);\n                //   break;\n                default:\n                    throw new Error(command.name);\n            }\n        }\n    }\n}\nfunction _copyBufferToBuffer(device, options) {\n    const source = options.sourceBuffer;\n    const destination = options.destinationBuffer;\n    // {In WebGL2 we can p}erform the copy on the GPU\n    // Use GL.COPY_READ_BUFFER+GL.COPY_WRITE_BUFFER avoid disturbing other targets and locking type\n    device.gl.bindBuffer(36662, source.handle);\n    device.gl.bindBuffer(36663, destination.handle);\n    device.gl.copyBufferSubData(36662, 36663, options.sourceOffset ?? 0, options.destinationOffset ?? 0, options.size);\n    device.gl.bindBuffer(36662, null);\n    device.gl.bindBuffer(36663, null);\n}\n/**\n * Copies data from a Buffer object into a Texture object\n * NOTE: doesn't wait for copy to be complete\n */\nfunction _copyBufferToTexture(device, options) {\n    throw new Error('Not implemented');\n}\n/**\n * Copies data from a Texture object into a Buffer object.\n * NOTE: doesn't wait for copy to be complete\n */\nfunction _copyTextureToBuffer(device, options) {\n    const { \n    /** Texture to copy to/from. */\n    sourceTexture, \n    /**  Mip-map level of the texture to copy to/from. (Default 0) */\n    mipLevel = 0, \n    /** Defines which aspects of the texture to copy to/from. */\n    aspect = 'all', \n    /** Width to copy */\n    width = options.sourceTexture.width, \n    /** Height to copy */\n    height = options.sourceTexture.height, depthOrArrayLayers = 0, \n    /** Defines the origin of the copy - the minimum corner of the texture sub-region to copy to/from. */\n    origin = [0, 0], \n    /** Destination buffer */\n    destinationBuffer, \n    /** Offset, in bytes, from the beginning of the buffer to the start of the image data (default 0) */\n    byteOffset = 0, \n    /**\n     * The stride, in bytes, between the beginning of each block row and the subsequent block row.\n     * Required if there are multiple block rows (i.e. the copy height or depth is more than one block).\n     */\n    bytesPerRow, \n    /**\n     * Number of block rows per single image of the texture.\n     * rowsPerImage &times; bytesPerRow is the stride, in bytes, between the beginning of each image of data and the subsequent image.\n     * Required if there are multiple images (i.e. the copy depth is more than one).\n     */\n    rowsPerImage } = options;\n    // TODO - Not possible to read just stencil or depth part in WebGL?\n    if (aspect !== 'all') {\n        throw new Error('aspect not supported in WebGL');\n    }\n    // TODO - mipLevels are set when attaching texture to framebuffer\n    if (mipLevel !== 0 || depthOrArrayLayers !== 0 || bytesPerRow || rowsPerImage) {\n        throw new Error('not implemented');\n    }\n    // Asynchronous read (PIXEL_PACK_BUFFER) is WebGL2 only feature\n    const { framebuffer, destroyFramebuffer } = getFramebuffer(sourceTexture);\n    let prevHandle;\n    try {\n        const webglBuffer = destinationBuffer;\n        const sourceWidth = width || framebuffer.width;\n        const sourceHeight = height || framebuffer.height;\n        const sourceParams = getTextureFormatWebGL(framebuffer.colorAttachments[0].texture.props.format);\n        const sourceFormat = sourceParams.format;\n        const sourceType = sourceParams.type;\n        // if (!target) {\n        //   // Create new buffer with enough size\n        //   const components = glFormatToComponents(sourceFormat);\n        //   const byteCount = glTypeToBytes(sourceType);\n        //   const byteLength = byteOffset + sourceWidth * sourceHeight * components * byteCount;\n        //   target = device.createBuffer({byteLength});\n        // }\n        device.gl.bindBuffer(35051, webglBuffer.handle);\n        // @ts-expect-error native bindFramebuffer is overridden by our state tracker\n        prevHandle = device.gl.bindFramebuffer(36160, framebuffer.handle);\n        device.gl.readPixels(origin[0], origin[1], sourceWidth, sourceHeight, sourceFormat, sourceType, byteOffset);\n    }\n    finally {\n        device.gl.bindBuffer(35051, null);\n        // prevHandle may be unassigned if the try block failed before binding\n        if (prevHandle !== undefined) {\n            device.gl.bindFramebuffer(36160, prevHandle);\n        }\n        if (destroyFramebuffer) {\n            framebuffer.destroy();\n        }\n    }\n}\n/**\n * Copies data from a Framebuffer or a Texture object into a Buffer object.\n * NOTE: doesn't wait for copy to be complete, it programs GPU to perform a DMA transfer.\nexport function readPixelsToBuffer(\n  source: Framebuffer | Texture,\n  options?: {\n    sourceX?: number;\n    sourceY?: number;\n    sourceFormat?: number;\n    target?: Buffer; // A new Buffer object is created when not provided.\n    targetByteOffset?: number; // byte offset in buffer object\n    // following parameters are auto deduced if not provided\n    sourceWidth?: number;\n    sourceHeight?: number;\n    sourceType?: number;\n  }\n): Buffer\n */\n/**\n * Copy a rectangle from a Framebuffer or Texture object into a texture (at an offset)\n */\n// eslint-disable-next-line complexity, max-statements\nfunction _copyTextureToTexture(device, options) {\n    const { \n    /** Texture to copy to/from. */\n    sourceTexture, \n    /**  Mip-map level of the texture to copy to (Default 0) */\n    destinationMipLevel = 0, \n    /** Defines which aspects of the texture to copy to/from. */\n    // aspect = 'all',\n    /** Defines the origin of the copy - the minimum corner of the texture sub-region to copy from. */\n    origin = [0, 0], \n    /** Defines the origin of the copy - the minimum corner of the texture sub-region to copy to. */\n    destinationOrigin = [0, 0], \n    /** Texture to copy to/from. */\n    destinationTexture\n    /**  Mip-map level of the texture to copy to/from. (Default 0) */\n    // destinationMipLevel = options.mipLevel,\n    /** Defines the origin of the copy - the minimum corner of the texture sub-region to copy to/from. */\n    // destinationOrigin = [0, 0],\n    /** Defines which aspects of the texture to copy to/from. */\n    // destinationAspect = options.aspect,\n     } = options;\n    let { width = options.destinationTexture.width, height = options.destinationTexture.height\n    // depthOrArrayLayers = 0\n     } = options;\n    const { framebuffer, destroyFramebuffer } = getFramebuffer(sourceTexture);\n    const [sourceX, sourceY] = origin;\n    const [destinationX, destinationY, destinationZ] = destinationOrigin;\n    // @ts-expect-error native bindFramebuffer is overridden by our state tracker\n    const prevHandle = device.gl.bindFramebuffer(36160, framebuffer.handle);\n    // TODO - support gl.readBuffer (WebGL2 only)\n    // const prevBuffer = gl.readBuffer(attachment);\n    let texture;\n    let textureTarget;\n    if (destinationTexture instanceof WEBGLTexture) {\n        texture = destinationTexture;\n        width = Number.isFinite(width) ? width : texture.width;\n        height = Number.isFinite(height) ? height : texture.height;\n        texture._bind(0);\n        textureTarget = texture.glTarget;\n    }\n    else {\n        throw new Error('invalid destination');\n    }\n    switch (textureTarget) {\n        case 3553:\n        case 34067:\n            device.gl.copyTexSubImage2D(textureTarget, destinationMipLevel, destinationX, destinationY, sourceX, sourceY, width, height);\n            break;\n        case 35866:\n        case 32879:\n            device.gl.copyTexSubImage3D(textureTarget, destinationMipLevel, destinationX, destinationY, destinationZ, sourceX, sourceY, width, height);\n            break;\n        default:\n    }\n    if (texture) {\n        texture._unbind();\n    }\n    device.gl.bindFramebuffer(36160, prevHandle);\n    if (destroyFramebuffer) {\n        framebuffer.destroy();\n    }\n}\n/** Clear one mip level of a texture *\nfunction _clearTexture(device: WebGLDevice, options: ClearTextureOptions) {\n  const BORDER = 0;\n  const {dimension, width, height, depth = 0, mipLevel = 0} = options;\n  const {glInternalFormat, glFormat, glType, compressed} = options;\n  const glTarget = getWebGLCubeFaceTarget(options.glTarget, dimension, depth);\n\n  switch (dimension) {\n    case '2d-array':\n    case '3d':\n      if (compressed) {\n        // prettier-ignore\n        device.gl.compressedTexImage3D(glTarget, mipLevel, glInternalFormat, width, height, depth, BORDER, null);\n      } else {\n        // prettier-ignore\n        device.gl.texImage3D( glTarget, mipLevel, glInternalFormat, width, height, depth, BORDER, glFormat, glType, null);\n      }\n      break;\n\n    case '2d':\n    case 'cube':\n      if (compressed) {\n        // prettier-ignore\n        device.gl.compressedTexImage2D(glTarget, mipLevel, glInternalFormat, width, height, BORDER, null);\n      } else {\n        // prettier-ignore\n        device.gl.texImage2D(glTarget, mipLevel, glInternalFormat, width, height, BORDER, glFormat, glType, null);\n      }\n      break;\n\n    default:\n      throw new Error(dimension);\n  }\n}\n  */\n// function _readTexture(device: WebGLDevice, options: CopyTextureToBufferOptions) {}\n// HELPERS\n/**\n * In WebGL, cube maps specify faces by overriding target instead of using the depth parameter.\n * @note We still bind the texture using GL.TEXTURE_CUBE_MAP, but we need to use the face-specific target when setting mip levels.\n * @returns glTarget unchanged, if dimension !== 'cube'.\n */\nexport function getWebGLCubeFaceTarget(glTarget, dimension, level) {\n    return dimension === 'cube' ? 34069 + level : glTarget;\n}\n/** Wrap a texture in a framebuffer so that we can use WebGL APIs that work on framebuffers */\nfunction getFramebuffer(source) {\n    if (source instanceof Texture) {\n        const { width, height, id } = source;\n        const framebuffer = source.device.createFramebuffer({\n            id: `framebuffer-for-${id}`,\n            width,\n            height,\n            colorAttachments: [source]\n        });\n        return { framebuffer, destroyFramebuffer: true };\n    }\n    return { framebuffer: source, destroyFramebuffer: false };\n}\n/**\n * Returns number of components in a specific readPixels WebGL format\n * @todo use shadertypes utils instead?\n */\nexport function glFormatToComponents(format) {\n    switch (format) {\n        case 6406:\n        case 33326:\n        case 6403:\n            return 1;\n        case 33328:\n        case 33319:\n            return 2;\n        case 6407:\n        case 34837:\n            return 3;\n        case 6408:\n        case 34836:\n            return 4;\n        // TODO: Add support for additional WebGL2 formats\n        default:\n            throw new Error('GLFormat');\n    }\n}\n/**\n * Return byte count for given readPixels WebGL type\n * @todo use shadertypes utils instead?\n */\nexport function glTypeToBytes(type) {\n    switch (type) {\n        case 5121:\n            return 1;\n        case 33635:\n        case 32819:\n        case 32820:\n            return 2;\n        case 5126:\n            return 4;\n        // TODO: Add support for additional WebGL2 types\n        default:\n            throw new Error('GLType');\n    }\n}\n//# sourceMappingURL=webgl-command-buffer.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { RenderPass } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { withGLParameters } from \"../../context/state-tracker/with-parameters.js\";\nimport { setGLParameters } from \"../../context/parameters/unified-parameter-api.js\";\nconst COLOR_CHANNELS = [0x1, 0x2, 0x4, 0x8]; // GPUColorWrite RED, GREEN, BLUE, ALPHA\nexport class WEBGLRenderPass extends RenderPass {\n    device;\n    handle = null;\n    /** Parameters that should be applied before each draw call */\n    glParameters = {};\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        // If no viewport is provided, apply reasonably defaults\n        let viewport;\n        if (!props?.parameters?.viewport) {\n            if (props?.framebuffer) {\n                // Set the viewport to the size of the framebuffer\n                const { width, height } = props.framebuffer;\n                viewport = [0, 0, width, height];\n            }\n            else {\n                // Instead of using our own book-keeping, we can just read the values from the WebGL context\n                const [width, height] = device.getDefaultCanvasContext().getDrawingBufferSize();\n                viewport = [0, 0, width, height];\n            }\n        }\n        // TODO - do parameters (scissorRect) affect the clear operation?\n        this.device.pushState();\n        this.setParameters({ viewport, ...this.props.parameters });\n        // Specify mapping of draw buffer locations to color attachments\n        const webglFramebuffer = this.props.framebuffer;\n        // Default framebuffers can only be set to GL.BACK or GL.NONE\n        if (this.props.framebuffer && webglFramebuffer?.handle) {\n            const drawBuffers = this.props.framebuffer.colorAttachments.map((_, i) => 36064 + i);\n            this.device.gl.drawBuffers(drawBuffers);\n        }\n        else {\n            this.device.gl.drawBuffers([1029]);\n        }\n        // Hack - for now WebGL draws in \"immediate mode\" (instead of queueing the operations)...\n        this.clear();\n    }\n    end() {\n        this.device.popState();\n        // should add commands to CommandEncoder.\n    }\n    pushDebugGroup(groupLabel) { }\n    popDebugGroup() { }\n    insertDebugMarker(markerLabel) { }\n    // beginOcclusionQuery(queryIndex: number): void;\n    // endOcclusionQuery(): void;\n    // executeBundles(bundles: Iterable<GPURenderBundle>): void;\n    /**\n     * Maps RenderPass parameters to GL parameters\n     */\n    setParameters(parameters = {}) {\n        const glParameters = { ...this.glParameters };\n        // Framebuffers are specified using parameters in WebGL\n        glParameters.framebuffer = this.props.framebuffer || null;\n        if (this.props.depthReadOnly) {\n            glParameters.depthMask = !this.props.depthReadOnly;\n        }\n        glParameters.stencilMask = this.props.stencilReadOnly ? 0 : 1;\n        glParameters[35977] = this.props.discard;\n        // Map the four renderpass parameters to WebGL parameters\n        if (parameters.viewport) {\n            // WebGPU viewports are 6 coordinates (X, Y, Z)\n            if (parameters.viewport.length >= 6) {\n                glParameters.viewport = parameters.viewport.slice(0, 4);\n                glParameters.depthRange = [\n                    parameters.viewport[4],\n                    parameters.viewport[5]\n                ];\n            }\n            else {\n                // WebGL viewports are 4 coordinates (X, Y)\n                glParameters.viewport = parameters.viewport;\n            }\n        }\n        if (parameters.scissorRect) {\n            glParameters.scissorTest = true;\n            glParameters.scissor = parameters.scissorRect;\n        }\n        if (parameters.blendConstant) {\n            glParameters.blendColor = parameters.blendConstant;\n        }\n        if (parameters.stencilReference) {\n            // eslint-disable-next-line no-console\n            console.warn('RenderPassParameters.stencilReference not yet implemented in WebGL');\n            // parameters.stencilFunc = [func, ref, mask];\n            // Does this work?\n            glParameters[2967] = parameters.stencilReference;\n        }\n        if ('colorMask' in parameters) {\n            glParameters.colorMask = COLOR_CHANNELS.map(channel => Boolean(channel & parameters.colorMask));\n        }\n        this.glParameters = glParameters;\n        setGLParameters(this.device.gl, glParameters);\n    }\n    beginOcclusionQuery(queryIndex) {\n        const webglQuerySet = this.props.occlusionQuerySet;\n        webglQuerySet?.beginOcclusionQuery();\n    }\n    endOcclusionQuery() {\n        const webglQuerySet = this.props.occlusionQuerySet;\n        webglQuerySet?.endOcclusionQuery();\n    }\n    // PRIVATE\n    /**\n     * Optionally clears depth, color and stencil buffers based on parameters\n     */\n    clear() {\n        const glParameters = { ...this.glParameters };\n        let clearMask = 0;\n        if (this.props.clearColors) {\n            this.props.clearColors.forEach((color, drawBufferIndex) => {\n                if (color) {\n                    this.clearColorBuffer(drawBufferIndex, color);\n                }\n            });\n        }\n        if (this.props.clearColor !== false && this.props.clearColors === undefined) {\n            clearMask |= 16384;\n            glParameters.clearColor = this.props.clearColor;\n        }\n        if (this.props.clearDepth !== false) {\n            clearMask |= 256;\n            glParameters.clearDepth = this.props.clearDepth;\n        }\n        if (this.props.clearStencil !== false) {\n            clearMask |= 1024;\n            glParameters.clearStencil = this.props.clearStencil;\n        }\n        if (clearMask !== 0) {\n            // Temporarily set any clear \"colors\" and call clear\n            withGLParameters(this.device.gl, glParameters, () => {\n                this.device.gl.clear(clearMask);\n            });\n        }\n    }\n    /**\n     * WebGL2 - clear a specific color buffer\n     */\n    clearColorBuffer(drawBuffer = 0, value = [0, 0, 0, 0]) {\n        withGLParameters(this.device.gl, { framebuffer: this.props.framebuffer }, () => {\n            // Method selection per OpenGL ES 3 docs\n            switch (value.constructor) {\n                case Int8Array:\n                case Int16Array:\n                case Int32Array:\n                    this.device.gl.clearBufferiv(6144, drawBuffer, value);\n                    break;\n                case Uint8Array:\n                case Uint8ClampedArray:\n                case Uint16Array:\n                case Uint32Array:\n                    this.device.gl.clearBufferuiv(6144, drawBuffer, value);\n                    break;\n                case Float32Array:\n                    this.device.gl.clearBufferfv(6144, drawBuffer, value);\n                    break;\n                default:\n                    throw new Error('clearColorBuffer: color must be typed array');\n            }\n        });\n    }\n}\n//# sourceMappingURL=webgl-render-pass.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { CommandEncoder } from '@luma.gl/core';\nimport { WEBGLCommandBuffer } from \"./webgl-command-buffer.js\";\nimport { WEBGLRenderPass } from \"./webgl-render-pass.js\";\nexport class WEBGLCommandEncoder extends CommandEncoder {\n    device;\n    handle = null;\n    commandBuffer;\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.commandBuffer = new WEBGLCommandBuffer(device);\n    }\n    destroy() { }\n    finish() {\n        return this.commandBuffer;\n    }\n    beginRenderPass(props) {\n        return new WEBGLRenderPass(this.device, props);\n    }\n    beginComputePass(props) {\n        throw new Error('ComputePass not supported in WebGL');\n    }\n    copyBufferToBuffer(options) {\n        this.commandBuffer.commands.push({ name: 'copy-buffer-to-buffer', options });\n    }\n    copyBufferToTexture(options) {\n        this.commandBuffer.commands.push({ name: 'copy-buffer-to-texture', options });\n    }\n    copyTextureToBuffer(options) {\n        this.commandBuffer.commands.push({ name: 'copy-texture-to-buffer', options });\n    }\n    copyTextureToTexture(options) {\n        this.commandBuffer.commands.push({ name: 'copy-texture-to-texture', options });\n    }\n    // clearTexture(options: ClearTextureOptions): void {\n    //   this.commandBuffer.commands.push({name: 'copy-texture-to-texture', options});\n    // }\n    pushDebugGroup(groupLabel) { }\n    popDebugGroup() { }\n    insertDebugMarker(markerLabel) { }\n    resolveQuerySet(querySet, destination, options) { }\n}\n//# sourceMappingURL=webgl-command-encoder.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\n// Uses copyWithin to significantly speed up typed array value filling\nexport function fillArray(options) {\n    const { target, source, start = 0, count = 1 } = options;\n    const length = source.length;\n    const total = count * length;\n    let copied = 0;\n    for (let i = start; copied < length; copied++) {\n        target[i++] = source[copied];\n    }\n    while (copied < total) {\n        // If we have copied less than half, copy everything we got\n        // else copy remaining in one operation\n        if (copied < total - copied) {\n            target.copyWithin(start + copied, start, start + copied);\n            copied *= 2;\n        }\n        else {\n            target.copyWithin(start + copied, start, start + total - copied);\n            copied = total;\n        }\n    }\n    return options.target;\n}\n//# sourceMappingURL=fill-array.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { VertexArray, getScratchArray } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { getBrowser } from '@probe.gl/env';\nimport { getGLFromVertexType } from \"../converters/webgl-vertex-formats.js\";\nimport { fillArray } from \"../../utils/fill-array.js\";\n/** VertexArrayObject wrapper */\nexport class WEBGLVertexArray extends VertexArray {\n    get [Symbol.toStringTag]() {\n        return 'VertexArray';\n    }\n    device;\n    handle;\n    /** Attribute 0 buffer constant */\n    buffer = null;\n    bufferValue = null;\n    /** * Attribute 0 can not be disable on most desktop OpenGL based browsers */\n    static isConstantAttributeZeroSupported(device) {\n        return getBrowser() === 'Chrome';\n    }\n    // Create a VertexArray\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.handle = this.device.gl.createVertexArray();\n    }\n    destroy() {\n        super.destroy();\n        if (this.buffer) {\n            this.buffer?.destroy();\n        }\n        if (this.handle) {\n            this.device.gl.deleteVertexArray(this.handle);\n            // @ts-expect-error read-only/undefined\n            this.handle = undefined;\n        }\n        // Auto-delete elements?\n        // return [this.elements];\n    }\n    /**\n    // Set (bind/unbind) an elements buffer, for indexed rendering.\n    // Must be a Buffer bound to GL.ELEMENT_ARRAY_BUFFER or null. Constants not supported\n     *\n     * @param elementBuffer\n     */\n    setIndexBuffer(indexBuffer) {\n        const buffer = indexBuffer;\n        // Explicitly allow `null` to support clearing the index buffer\n        if (buffer && buffer.glTarget !== 34963) {\n            throw new Error('Use .setBuffer()');\n        }\n        // In WebGL The GL.ELEMENT_ARRAY_BUFFER_BINDING is stored on the VertexArrayObject\n        this.device.gl.bindVertexArray(this.handle);\n        this.device.gl.bindBuffer(34963, buffer ? buffer.handle : null);\n        this.indexBuffer = buffer;\n        // Unbind to prevent unintended changes to the VAO.\n        this.device.gl.bindVertexArray(null);\n    }\n    /** Set a location in vertex attributes array to a buffer, enables the location, sets divisor */\n    setBuffer(location, attributeBuffer) {\n        const buffer = attributeBuffer;\n        // Sanity check target\n        if (buffer.glTarget === 34963) {\n            throw new Error('Use .setIndexBuffer()');\n        }\n        const { size, type, stride, offset, normalized, integer, divisor } = this._getAccessor(location);\n        this.device.gl.bindVertexArray(this.handle);\n        // A non-zero buffer object must be bound to the GL_ARRAY_BUFFER target\n        this.device.gl.bindBuffer(34962, buffer.handle);\n        // WebGL2 supports *integer* data formats, i.e. GPU will see integer values\n        if (integer) {\n            this.device.gl.vertexAttribIPointer(location, size, type, stride, offset);\n        }\n        else {\n            // Attaches ARRAY_BUFFER with specified buffer format to location\n            this.device.gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\n        }\n        // Clear binding - keeping it may cause [.WebGL-0x12804417100]\n        // GL_INVALID_OPERATION: A transform feedback buffer that would be written to is also bound to a non-transform-feedback target\n        this.device.gl.bindBuffer(34962, null);\n        // Mark as non-constant\n        this.device.gl.enableVertexAttribArray(location);\n        // Set the step mode 0=vertex, 1=instance\n        this.device.gl.vertexAttribDivisor(location, divisor || 0);\n        this.attributes[location] = buffer;\n        // Unbind to prevent unintended changes to the VAO.\n        this.device.gl.bindVertexArray(null);\n    }\n    /** Set a location in vertex attributes array to a constant value, disables the location */\n    setConstantWebGL(location, value) {\n        this._enable(location, false);\n        this.attributes[location] = value;\n    }\n    bindBeforeRender() {\n        this.device.gl.bindVertexArray(this.handle);\n        this._applyConstantAttributes();\n    }\n    unbindAfterRender() {\n        // Unbind to prevent unintended changes to the VAO.\n        this.device.gl.bindVertexArray(null);\n    }\n    // Internal methods\n    /**\n     * Constant attributes need to be reset before every draw call\n     * Any attribute that is disabled in the current vertex array object\n     * is read from the context's global constant value for that attribute location.\n     * @note Constant attributes are only supported in WebGL, not in WebGPU\n     */\n    _applyConstantAttributes() {\n        for (let location = 0; location < this.maxVertexAttributes; ++location) {\n            const constant = this.attributes[location];\n            // A typed array means this is a constant\n            if (ArrayBuffer.isView(constant)) {\n                this.device.setConstantAttributeWebGL(location, constant);\n            }\n        }\n    }\n    /**\n     * Set a location in vertex attributes array to a buffer, enables the location, sets divisor\n     * @note requires vertex array to be bound\n     */\n    // protected _setAttributeLayout(location: number): void {\n    //   const {size, type, stride, offset, normalized, integer, divisor} = this._getAccessor(location);\n    //   // WebGL2 supports *integer* data formats, i.e. GPU will see integer values\n    //   if (integer) {\n    //     this.device.gl.vertexAttribIPointer(location, size, type, stride, offset);\n    //   } else {\n    //     // Attaches ARRAY_BUFFER with specified buffer format to location\n    //     this.device.gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\n    //   }\n    //   this.device.gl.vertexAttribDivisor(location, divisor || 0);\n    // }\n    /** Get an accessor from the  */\n    _getAccessor(location) {\n        const attributeInfo = this.attributeInfos[location];\n        if (!attributeInfo) {\n            throw new Error(`Unknown attribute location ${location}`);\n        }\n        const glType = getGLFromVertexType(attributeInfo.bufferDataType);\n        return {\n            size: attributeInfo.bufferComponents,\n            type: glType,\n            stride: attributeInfo.byteStride,\n            offset: attributeInfo.byteOffset,\n            normalized: attributeInfo.normalized,\n            // it is the shader attribute declaration, not the vertex memory format,\n            // that determines if the data in the buffer will be treated as integers.\n            //\n            // Also note that WebGL supports assigning non-normalized integer data to floating point attributes,\n            // but as far as we can tell, WebGPU does not.\n            integer: attributeInfo.integer,\n            divisor: attributeInfo.stepMode === 'instance' ? 1 : 0\n        };\n    }\n    /**\n     * Enabling an attribute location makes it reference the currently bound buffer\n     * Disabling an attribute location makes it reference the global constant value\n     * TODO - handle single values for size 1 attributes?\n     * TODO - convert classic arrays based on known type?\n     */\n    _enable(location, enable = true) {\n        // Attribute 0 cannot be disabled in most desktop OpenGL based browsers...\n        const canDisableAttributeZero = WEBGLVertexArray.isConstantAttributeZeroSupported(this.device);\n        const canDisableAttribute = canDisableAttributeZero || location !== 0;\n        if (enable || canDisableAttribute) {\n            location = Number(location);\n            this.device.gl.bindVertexArray(this.handle);\n            if (enable) {\n                this.device.gl.enableVertexAttribArray(location);\n            }\n            else {\n                this.device.gl.disableVertexAttribArray(location);\n            }\n            this.device.gl.bindVertexArray(null);\n        }\n    }\n    /**\n     * Provide a means to create a buffer that is equivalent to a constant.\n     * NOTE: Desktop OpenGL cannot disable attribute 0.\n     * https://stackoverflow.com/questions/20305231/webgl-warning-attribute-0-is-disabled-\n     * this-has-significant-performance-penalty\n     */\n    getConstantBuffer(elementCount, value) {\n        // Create buffer only when needed, and reuse it (avoids inflating buffer creation statistics)\n        const constantValue = normalizeConstantArrayValue(value);\n        const byteLength = constantValue.byteLength * elementCount;\n        const length = constantValue.length * elementCount;\n        if (this.buffer && byteLength !== this.buffer.byteLength) {\n            throw new Error(`Buffer size is immutable, byte length ${byteLength} !== ${this.buffer.byteLength}.`);\n        }\n        let updateNeeded = !this.buffer;\n        this.buffer = this.buffer || this.device.createBuffer({ byteLength });\n        // Reallocate and update contents if needed\n        // @ts-ignore TODO fix types\n        updateNeeded ||= !compareConstantArrayValues(constantValue, this.bufferValue);\n        if (updateNeeded) {\n            // Create a typed array that is big enough, and fill it with the required data\n            const typedArray = getScratchArray(value.constructor, length);\n            fillArray({ target: typedArray, source: constantValue, start: 0, count: length });\n            this.buffer.write(typedArray);\n            this.bufferValue = value;\n        }\n        return this.buffer;\n    }\n}\n// HELPER FUNCTIONS\n/**\n * TODO - convert Arrays based on known type? (read type from accessor, don't assume Float32Array)\n * TODO - handle single values for size 1 attributes?\n */\nfunction normalizeConstantArrayValue(arrayValue) {\n    if (Array.isArray(arrayValue)) {\n        return new Float32Array(arrayValue);\n    }\n    return arrayValue;\n}\n/**\n *\n */\nfunction compareConstantArrayValues(v1, v2) {\n    if (!v1 || !v2 || v1.length !== v2.length || v1.constructor !== v2.constructor) {\n        return false;\n    }\n    for (let i = 0; i < v1.length; ++i) {\n        if (v1[i] !== v2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=webgl-vertex-array.js.map","import { log, TransformFeedback } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { WEBGLBuffer } from \"../../index.js\";\nimport { getGLPrimitive } from \"../helpers/webgl-topology-utils.js\";\nexport class WEBGLTransformFeedback extends TransformFeedback {\n    device;\n    gl;\n    handle;\n    /**\n     * NOTE: The Model already has this information while drawing, but\n     * TransformFeedback currently needs it internally, to look up\n     * varying information outside of a draw() call.\n     */\n    layout;\n    buffers = {};\n    unusedBuffers = {};\n    /**\n     * Allows us to avoid a Chrome bug where a buffer that is already bound to a\n     * different target cannot be bound to 'TRANSFORM_FEEDBACK_BUFFER' target.\n     * This a major workaround, see: https://github.com/KhronosGroup/WebGL/issues/2346\n     */\n    bindOnUse = true;\n    _bound = false;\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        this.gl = device.gl;\n        this.handle = this.props.handle || this.gl.createTransformFeedback();\n        this.layout = this.props.layout;\n        if (props.buffers) {\n            this.setBuffers(props.buffers);\n        }\n        Object.seal(this);\n    }\n    destroy() {\n        this.gl.deleteTransformFeedback(this.handle);\n        super.destroy();\n    }\n    begin(topology = 'point-list') {\n        this.gl.bindTransformFeedback(36386, this.handle);\n        if (this.bindOnUse) {\n            this._bindBuffers();\n        }\n        this.gl.beginTransformFeedback(getGLPrimitive(topology));\n    }\n    end() {\n        this.gl.endTransformFeedback();\n        if (this.bindOnUse) {\n            this._unbindBuffers();\n        }\n        this.gl.bindTransformFeedback(36386, null);\n    }\n    // SUBCLASS\n    setBuffers(buffers) {\n        this.buffers = {};\n        this.unusedBuffers = {};\n        this.bind(() => {\n            for (const bufferName in buffers) {\n                this.setBuffer(bufferName, buffers[bufferName]);\n            }\n        });\n    }\n    setBuffer(locationOrName, bufferOrRange) {\n        const location = this._getVaryingIndex(locationOrName);\n        const { buffer, byteLength, byteOffset } = this._getBufferRange(bufferOrRange);\n        if (location < 0) {\n            this.unusedBuffers[locationOrName] = buffer;\n            log.warn(`${this.id} unusedBuffers varying buffer ${locationOrName}`)();\n            return;\n        }\n        this.buffers[location] = { buffer, byteLength, byteOffset };\n        // Need to avoid chrome bug where buffer that is already bound to a different target\n        // cannot be bound to 'TRANSFORM_FEEDBACK_BUFFER' target.\n        if (!this.bindOnUse) {\n            this._bindBuffer(location, buffer, byteOffset, byteLength);\n        }\n    }\n    getBuffer(locationOrName) {\n        if (isIndex(locationOrName)) {\n            return this.buffers[locationOrName] || null;\n        }\n        const location = this._getVaryingIndex(locationOrName);\n        return location >= 0 ? this.buffers[location] : null;\n    }\n    bind(funcOrHandle = this.handle) {\n        if (typeof funcOrHandle !== 'function') {\n            this.gl.bindTransformFeedback(36386, funcOrHandle);\n            return this;\n        }\n        let value;\n        if (!this._bound) {\n            this.gl.bindTransformFeedback(36386, this.handle);\n            this._bound = true;\n            value = funcOrHandle();\n            this._bound = false;\n            this.gl.bindTransformFeedback(36386, null);\n        }\n        else {\n            value = funcOrHandle();\n        }\n        return value;\n    }\n    unbind() {\n        this.bind(null);\n    }\n    // PRIVATE METHODS\n    /** Extract offsets for bindBufferRange */\n    _getBufferRange(bufferOrRange) {\n        if (bufferOrRange instanceof WEBGLBuffer) {\n            return { buffer: bufferOrRange, byteOffset: 0, byteLength: bufferOrRange.byteLength };\n        }\n        // To use bindBufferRange either offset or size must be specified.\n        // @ts-expect-error Must be a BufferRange.\n        const { buffer, byteOffset = 0, byteLength = bufferOrRange.buffer.byteLength } = bufferOrRange;\n        return { buffer, byteOffset, byteLength };\n    }\n    _getVaryingIndex(locationOrName) {\n        if (isIndex(locationOrName)) {\n            return Number(locationOrName);\n        }\n        for (const varying of this.layout.varyings || []) {\n            if (locationOrName === varying.name) {\n                return varying.location;\n            }\n        }\n        return -1;\n    }\n    /**\n     * Need to avoid chrome bug where buffer that is already bound to a different target\n     * cannot be bound to 'TRANSFORM_FEEDBACK_BUFFER' target.\n     */\n    _bindBuffers() {\n        for (const bufferIndex in this.buffers) {\n            const { buffer, byteLength, byteOffset } = this._getBufferRange(this.buffers[bufferIndex]);\n            this._bindBuffer(Number(bufferIndex), buffer, byteOffset, byteLength);\n        }\n    }\n    _unbindBuffers() {\n        for (const bufferIndex in this.buffers) {\n            this.gl.bindBufferBase(35982, Number(bufferIndex), null);\n        }\n    }\n    _bindBuffer(index, buffer, byteOffset = 0, byteLength) {\n        const handle = buffer && buffer.handle;\n        if (!handle || byteLength === undefined) {\n            this.gl.bindBufferBase(35982, index, handle);\n        }\n        else {\n            this.gl.bindBufferRange(35982, index, handle, byteOffset, byteLength);\n        }\n    }\n}\n/**\n * Returns true if the given value is an integer, or a string that\n * trivially converts to an integer (only numeric characters).\n */\nfunction isIndex(value) {\n    if (typeof value === 'number') {\n        return Number.isInteger(value);\n    }\n    return /^\\d+$/.test(value);\n}\n//# sourceMappingURL=webgl-transform-feedback.js.map","// WebGL2 Query (also handles disjoint timer extensions)\nimport { QuerySet } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\n/**\n * Asynchronous queries for different kinds of information\n */\nexport class WEBGLQuerySet extends QuerySet {\n    device;\n    handle;\n    target = null;\n    _queryPending = false;\n    _pollingPromise = null;\n    get [Symbol.toStringTag]() {\n        return 'Query';\n    }\n    // Create a query class\n    constructor(device, props) {\n        super(device, props);\n        this.device = device;\n        if (props.count > 1) {\n            throw new Error('WebGL QuerySet can only have one value');\n        }\n        const handle = this.device.gl.createQuery();\n        if (!handle) {\n            throw new Error('WebGL query not supported');\n        }\n        this.handle = handle;\n        Object.seal(this);\n    }\n    destroy() {\n        this.device.gl.deleteQuery(this.handle);\n    }\n    // FOR RENDER PASS AND COMMAND ENCODER\n    /**\n     * Shortcut for timer query (dependent on extension in both WebGL1 and 2)\n     * Measures GPU time delta between this call and a matching `end` call in the\n     * GPU instruction stream.\n     */\n    beginTimestampQuery() {\n        return this._begin(35007);\n    }\n    endTimestampQuery() {\n        this._end();\n    }\n    // Shortcut for occlusion queries\n    beginOcclusionQuery(options) {\n        return this._begin(options?.conservative ? 36202 : 35887);\n    }\n    endOcclusionQuery() {\n        this._end();\n    }\n    // Shortcut for transformFeedbackQuery\n    beginTransformFeedbackQuery() {\n        return this._begin(35976);\n    }\n    endTransformFeedbackQuery() {\n        this._end();\n    }\n    async resolveQuery() {\n        const value = await this.pollQuery();\n        return [value];\n    }\n    // PRIVATE METHODS\n    /**\n     * Due to OpenGL API limitations, after calling `begin()` on one Query\n     * instance, `end()` must be called on that same instance before\n     * calling `begin()` on another query. While there can be multiple\n     * outstanding queries representing disjoint `begin()`/`end()` intervals.\n     * It is not possible to interleave or overlap `begin` and `end` calls.\n     */\n    _begin(target) {\n        // Don't start a new query if one is already active.\n        if (this._queryPending) {\n            return;\n        }\n        this.target = target;\n        this.device.gl.beginQuery(this.target, this.handle);\n        return;\n    }\n    // ends the current query\n    _end() {\n        // Can't end a new query if the last one hasn't been resolved.\n        if (this._queryPending) {\n            return;\n        }\n        if (this.target) {\n            this.device.gl.endQuery(this.target);\n            this.target = null;\n            this._queryPending = true;\n        }\n        return;\n    }\n    // Returns true if the query result is available\n    isResultAvailable() {\n        if (!this._queryPending) {\n            return false;\n        }\n        const resultAvailable = this.device.gl.getQueryParameter(this.handle, 34919);\n        if (resultAvailable) {\n            this._queryPending = false;\n        }\n        return resultAvailable;\n    }\n    // Timing query is disjoint, i.e. results are invalid\n    isTimerDisjoint() {\n        return this.device.gl.getParameter(36795);\n    }\n    // Returns query result.\n    getResult() {\n        return this.device.gl.getQueryParameter(this.handle, 34918);\n    }\n    // Returns the query result, converted to milliseconds to match JavaScript conventions.\n    getTimerMilliseconds() {\n        return this.getResult() / 1e6;\n    }\n    // Polls the query\n    pollQuery(limit = Number.POSITIVE_INFINITY) {\n        if (this._pollingPromise) {\n            return this._pollingPromise;\n        }\n        let counter = 0;\n        this._pollingPromise = new Promise((resolve, reject) => {\n            const poll = () => {\n                if (this.isResultAvailable()) {\n                    resolve(this.getResult());\n                    this._pollingPromise = null;\n                }\n                else if (counter++ > limit) {\n                    reject('Timed out');\n                    this._pollingPromise = null;\n                }\n                else {\n                    requestAnimationFrame(poll);\n                }\n            };\n            requestAnimationFrame(poll);\n        });\n        return this._pollingPromise;\n    }\n}\n//# sourceMappingURL=webgl-query-set.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n// Returns number of components in a specific readPixels WebGL format\nexport function glFormatToComponents(format) {\n    switch (format) {\n        case 6406:\n        case 33326:\n        case 6403:\n        case 36244:\n            return 1;\n        case 33339:\n        case 33340:\n        case 33328:\n        case 33320:\n        case 33319:\n            return 2;\n        case 6407:\n        case 36248:\n        case 34837:\n            return 3;\n        case 6408:\n        case 36249:\n        case 34836:\n            return 4;\n        // TODO: Add support for additional WebGL2 formats\n        default:\n            return 0;\n    }\n}\n// Return byte count for given readPixels WebGL type\nexport function glTypeToBytes(type) {\n    switch (type) {\n        case 5121:\n            return 1;\n        case 33635:\n        case 32819:\n        case 32820:\n            return 2;\n        case 5126:\n            return 4;\n        // TODO: Add support for additional WebGL2 types\n        default:\n            return 0;\n    }\n}\n//# sourceMappingURL=format-utils.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { GL } from '@luma.gl/constants';\n/** Get shadertypes data type from GL constants */\nexport function convertGLDataTypeToDataType(type) {\n    return GL_DATA_TYPE_MAP[type];\n}\nconst GL_DATA_TYPE_MAP = {\n    [5124]: 'sint32',\n    [5125]: 'uint32',\n    [5122]: 'sint16',\n    [5123]: 'uint16',\n    [5120]: 'sint8',\n    [5121]: 'uint8',\n    [5126]: 'float32',\n    [5131]: 'float16',\n    [33635]: 'uint16',\n    [32819]: 'uint16',\n    [32820]: 'uint16',\n    [33640]: 'uint32',\n    [35899]: 'uint32',\n    [35902]: 'uint32',\n    [34042]: 'uint32',\n    [36269]: 'uint32'\n};\n/** Get shader data type from GL constants *\nexport function getPrimitiveTypeFromGL(type: GL): PrimitiveDataType {\n  switch (type) {\n    case GL.INT:\n      return 'i32';\n    case GL.UNSIGNED_INT:\n      return 'u32';\n    case GL.SHORT:\n      return 'i32';\n    case GL.UNSIGNED_SHORT:\n      return 'u32';\n    case GL.BYTE:\n      return 'i32';\n    case GL.UNSIGNED_BYTE:\n      return 'u32';\n    case GL.FLOAT:\n      return 'f32';\n    case GL.HALF_FLOAT:\n      return 'f16';\n    default:\n      throw new Error(String(type));\n  }\n}\n\n/** Get shader attribute type from GL constants *\nexport function getShaderAttributeTypeFromGL(\n  type: GL,\n  components: 1 | 2 | 3 | 4\n): AttributeShaderType {\n  const dataType = getPrimitiveTypeFromGL(type);\n  switch (components) {\n    case 1:\n      return dataType;\n    case 2:\n      return `vec2<${dataType}>`;\n    case 3:\n      return `vec2<${dataType}>`;\n    case 4:\n      return `vec2<${dataType}>`;\n    default:\n      throw new Error(String(components));\n  }\n}\n*/\n/** GetGL constant from shader data type\nexport function getGLFromShaderDataType(\n  type: PrimitiveDataType\n): GL.INT | GL.UNSIGNED_INT | GL.FLOAT | GL.HALF_FLOAT {\n  switch (type) {\n    // TODO\n    case 'i32':\n      return GL.INT;\n    case 'u32':\n      return GL.UNSIGNED_INT;\n    case 'f32':\n      return GL.FLOAT;\n    case 'f16':\n      return GL.HALF_FLOAT;\n    default:\n      throw new Error(String(type));\n  }\n}\n*/\n//# sourceMappingURL=shader-formats.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Framebuffer, getTypedArrayConstructor, getDataType } from '@luma.gl/core';\nimport { GL } from '@luma.gl/constants';\nimport { convertDataTypeToGLDataType } from \"../converters/webgl-shadertypes.js\";\nimport { glFormatToComponents, glTypeToBytes } from \"./format-utils.js\";\nimport { WEBGLTexture } from \"../resources/webgl-texture.js\";\nimport { convertGLDataTypeToDataType } from \"../converters/shader-formats.js\";\n/** A \"border\" parameter is required in many WebGL texture APIs, but must always be 0... */\nconst BORDER = 0;\n/**\n * Copy a region of compressed data from a GPU memory buffer into this texture.\n */\nexport function copyGPUBufferToMipLevel(gl, webglBuffer, byteLength, options) {\n    const { dimension, width, height, depth = 0, mipLevel = 0, byteOffset = 0 } = options;\n    const { x = 0, y = 0, z = 0 } = options;\n    const { glFormat, glType, compressed } = options;\n    const glTarget = getWebGLCubeFaceTarget(options.glTarget, dimension, depth);\n    gl.bindBuffer(35052, webglBuffer);\n    switch (dimension) {\n        case '2d-array':\n        case '3d':\n            // 3 dimensional textures requires 3D texture functions\n            if (compressed) {\n                // TODO enable extension?\n                // prettier-ignore\n                gl.compressedTexSubImage3D(glTarget, mipLevel, x, y, z, width, height, depth, glFormat, byteLength, byteOffset);\n            }\n            else {\n                // prettier-ignore\n                gl.texSubImage3D(glTarget, mipLevel, x, y, z, width, height, depth, glFormat, glType, byteOffset);\n            }\n            break;\n        case '2d':\n        case 'cube':\n            if (compressed) {\n                // prettier-ignore\n                gl.compressedTexSubImage2D(glTarget, mipLevel, x, y, width, height, glFormat, byteLength, byteOffset);\n            }\n            else {\n                // prettier-ignore\n                gl.texSubImage2D(glTarget, mipLevel, x, y, width, height, BORDER, glFormat, byteOffset);\n            }\n            break;\n        default:\n            throw new Error(dimension);\n    }\n}\n// INTERNAL HELPERS\n/** Convert a WebGPU style texture constant to a WebGL style texture constant */\nexport function getWebGLTextureTarget(dimension) {\n    // prettier-ignore\n    switch (dimension) {\n        case '1d': break; // not supported in any WebGL version\n        case '2d': return 3553; // supported in WebGL1\n        case '3d': return 32879; // supported in WebGL2\n        case 'cube': return 34067; // supported in WebGL1\n        case '2d-array': return 35866; // supported in WebGL2\n        case 'cube-array': break; // not supported in any WebGL version\n    }\n    throw new Error(dimension);\n}\n/**\n * In WebGL, cube maps specify faces by overriding target instead of using the depth parameter.\n * @note We still bind the texture using GL.TEXTURE_CUBE_MAP, but we need to use the face-specific target when setting mip levels.\n * @returns glTarget unchanged, if dimension !== 'cube'.\n */\nexport function getWebGLCubeFaceTarget(glTarget, dimension, level) {\n    return dimension === 'cube' ? 34069 + level : glTarget;\n}\n/**\n * Copies data from a type  or a Texture object into ArrayBuffer object.\n * App can provide targetPixelArray or have it auto allocated by this method\n *  newly allocated by this method unless provided by app.\n * @deprecated Use CommandEncoder.copyTextureToBuffer and Buffer.read\n * @note Slow requires roundtrip to GPU\n *\n * @param source\n * @param options\n * @returns pixel array,\n */\nexport function readPixelsToArray(source, options) {\n    const { sourceX = 0, sourceY = 0, sourceAttachment = 0 // TODO - support gl.readBuffer\n     } = options || {};\n    let { target = null, \n    // following parameters are auto deduced if not provided\n    sourceWidth, sourceHeight, sourceDepth, sourceFormat, sourceType } = options || {};\n    const { framebuffer, deleteFramebuffer } = getFramebuffer(source);\n    // assert(framebuffer);\n    const { gl, handle } = framebuffer;\n    sourceWidth ||= framebuffer.width;\n    sourceHeight ||= framebuffer.height;\n    const texture = framebuffer.colorAttachments[sourceAttachment]?.texture;\n    if (!texture) {\n        throw new Error(`Invalid framebuffer attachment ${sourceAttachment}`);\n    }\n    sourceDepth = texture?.depth || 1;\n    sourceFormat ||= texture?.glFormat || 6408;\n    // Deduce the type from color attachment if not provided.\n    sourceType ||= texture?.glType || 5121;\n    // Deduce type and allocated pixelArray if needed\n    target = getPixelArray(target, sourceType, sourceFormat, sourceWidth, sourceHeight, sourceDepth);\n    // Pixel array available, if necessary, deduce type from it.\n    const signedType = getDataType(target);\n    sourceType = sourceType || convertDataTypeToGLDataType(signedType);\n    // Note: luma.gl overrides bindFramebuffer so that we can reliably restore the previous framebuffer (this is the only function for which we do that)\n    const prevHandle = gl.bindFramebuffer(36160, handle);\n    // Select the color attachment to read from\n    gl.readBuffer(36064 + sourceAttachment);\n    // There is a lot of hedging in the WebGL2 spec about what formats are guaranteed to be readable\n    // (It should always be possible to read RGBA/UNSIGNED_BYTE, but most other combinations are not guaranteed)\n    // Querying is possible but expensive:\n    // const {device} = framebuffer;\n    // texture.glReadFormat ||= gl.getParameter(gl.IMPLEMENTATION_COLOR_READ_FORMAT);\n    // texture.glReadType ||= gl.getParameter(gl.IMPLEMENTATION_COLOR_READ_TYPE);\n    // console.log('params', device.getGLKey(texture.glReadFormat), device.getGLKey(texture.glReadType));\n    gl.readPixels(sourceX, sourceY, sourceWidth, sourceHeight, sourceFormat, sourceType, target);\n    gl.readBuffer(36064);\n    gl.bindFramebuffer(36160, prevHandle || null);\n    if (deleteFramebuffer) {\n        framebuffer.destroy();\n    }\n    return target;\n}\n/**\n * Copies data from a Framebuffer or a Texture object into a Buffer object.\n * NOTE: doesn't wait for copy to be complete, it programs GPU to perform a DMA transffer.\n * @deprecated Use CommandEncoder\n * @param source\n * @param options\n */\nexport function readPixelsToBuffer(source, options) {\n    const { target, sourceX = 0, sourceY = 0, sourceFormat = 6408, targetByteOffset = 0 } = options || {};\n    // following parameters are auto deduced if not provided\n    let { sourceWidth, sourceHeight, sourceType } = options || {};\n    const { framebuffer, deleteFramebuffer } = getFramebuffer(source);\n    // assert(framebuffer);\n    sourceWidth = sourceWidth || framebuffer.width;\n    sourceHeight = sourceHeight || framebuffer.height;\n    // Asynchronous read (PIXEL_PACK_BUFFER) is WebGL2 only feature\n    const webglFramebuffer = framebuffer;\n    // deduce type if not available.\n    sourceType = sourceType || 5121;\n    let webglBufferTarget = target;\n    if (!webglBufferTarget) {\n        // Create new buffer with enough size\n        const components = glFormatToComponents(sourceFormat);\n        const byteCount = glTypeToBytes(sourceType);\n        const byteLength = targetByteOffset + sourceWidth * sourceHeight * components * byteCount;\n        webglBufferTarget = webglFramebuffer.device.createBuffer({ byteLength });\n    }\n    // TODO(donmccurdy): Do we have tests to confirm this is working?\n    const commandEncoder = source.device.createCommandEncoder();\n    commandEncoder.copyTextureToBuffer({\n        sourceTexture: source,\n        width: sourceWidth,\n        height: sourceHeight,\n        origin: [sourceX, sourceY],\n        destinationBuffer: webglBufferTarget,\n        byteOffset: targetByteOffset\n    });\n    commandEncoder.destroy();\n    if (deleteFramebuffer) {\n        framebuffer.destroy();\n    }\n    return webglBufferTarget;\n}\n/**\n * Copy a rectangle from a Framebuffer or Texture object into a texture (at an offset)\n * @deprecated Use CommandEncoder\n */\n// eslint-disable-next-line complexity, max-statements\nexport function copyToTexture(sourceTexture, destinationTexture, options) {\n    const { sourceX = 0, sourceY = 0, \n    // attachment = GL.COLOR_ATTACHMENT0, // TODO - support gl.readBuffer\n    targetMipmaplevel = 0, targetInternalFormat = 6408 } = options || {};\n    let { targetX, targetY, targetZ, width, // defaults to target width\n    height // defaults to target height\n     } = options || {};\n    const { framebuffer, deleteFramebuffer } = getFramebuffer(sourceTexture);\n    // assert(framebuffer);\n    const webglFramebuffer = framebuffer;\n    const { device, handle } = webglFramebuffer;\n    const isSubCopy = typeof targetX !== 'undefined' ||\n        typeof targetY !== 'undefined' ||\n        typeof targetZ !== 'undefined';\n    targetX = targetX || 0;\n    targetY = targetY || 0;\n    targetZ = targetZ || 0;\n    const prevHandle = device.gl.bindFramebuffer(36160, handle);\n    // TODO - support gl.readBuffer (WebGL2 only)\n    // const prevBuffer = gl.readBuffer(attachment);\n    // assert(target);\n    let texture = null;\n    let textureTarget;\n    if (destinationTexture instanceof WEBGLTexture) {\n        texture = destinationTexture;\n        width = Number.isFinite(width) ? width : texture.width;\n        height = Number.isFinite(height) ? height : texture.height;\n        texture?._bind(0);\n        // @ts-ignore\n        textureTarget = texture.target;\n    }\n    else {\n        // @ts-ignore\n        textureTarget = target;\n    }\n    if (!isSubCopy) {\n        device.gl.copyTexImage2D(textureTarget, targetMipmaplevel, targetInternalFormat, sourceX, sourceY, width, height, 0 /* border must be 0 */);\n    }\n    else {\n        switch (textureTarget) {\n            case 3553:\n            case 34067:\n                device.gl.copyTexSubImage2D(textureTarget, targetMipmaplevel, targetX, targetY, sourceX, sourceY, width, height);\n                break;\n            case 35866:\n            case 32879:\n                device.gl.copyTexSubImage3D(textureTarget, targetMipmaplevel, targetX, targetY, targetZ, sourceX, sourceY, width, height);\n                break;\n            default:\n        }\n    }\n    if (texture) {\n        texture._unbind();\n    }\n    // @ts-expect-error\n    device.gl.bindFramebuffer(36160, prevHandle || null);\n    if (deleteFramebuffer) {\n        framebuffer.destroy();\n    }\n    return texture;\n}\nfunction getFramebuffer(source) {\n    if (!(source instanceof Framebuffer)) {\n        return { framebuffer: toFramebuffer(source), deleteFramebuffer: true };\n    }\n    return { framebuffer: source, deleteFramebuffer: false };\n}\n/**\n * Wraps a given texture into a framebuffer object, that can be further used\n * to read data from the texture object.\n */\nexport function toFramebuffer(texture, props) {\n    const { device, width, height, id } = texture;\n    const framebuffer = device.createFramebuffer({\n        ...props,\n        id: `framebuffer-for-${id}`,\n        width,\n        height,\n        colorAttachments: [texture]\n    });\n    return framebuffer;\n}\n// eslint-disable-next-line max-params\nfunction getPixelArray(pixelArray, glType, glFormat, width, height, depth) {\n    if (pixelArray) {\n        return pixelArray;\n    }\n    // const formatInfo = getTextureFormatInfo(format);\n    // Allocate pixel array if not already available, using supplied type\n    glType ||= 5121;\n    const shaderType = convertGLDataTypeToDataType(glType);\n    const ArrayType = getTypedArrayConstructor(shaderType);\n    const components = glFormatToComponents(glFormat);\n    // TODO - check for composite type (components = 1).\n    return new ArrayType(width * height * components);\n}\n//# sourceMappingURL=webgl-texture-utils.js.map","// luma.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Device, log } from '@luma.gl/core';\nimport { WebGLStateTracker } from \"../context/state-tracker/webgl-state-tracker.js\";\nimport { createBrowserContext } from \"../context/helpers/create-browser-context.js\";\nimport { getDeviceInfo } from \"./device-helpers/webgl-device-info.js\";\nimport { WebGLDeviceFeatures } from \"./device-helpers/webgl-device-features.js\";\nimport { WebGLDeviceLimits } from \"./device-helpers/webgl-device-limits.js\";\nimport { WebGLCanvasContext } from \"./webgl-canvas-context.js\";\nimport { initializeSpectorJS } from \"../context/debug/spector.js\";\nimport { makeDebugContext } from \"../context/debug/webgl-developer-tools.js\";\nimport { getTextureFormatCapabilitiesWebGL } from \"./converters/webgl-texture-table.js\";\nimport { uid } from \"../utils/uid.js\";\nimport { WEBGLBuffer } from \"./resources/webgl-buffer.js\";\nimport { WEBGLShader } from \"./resources/webgl-shader.js\";\nimport { WEBGLSampler } from \"./resources/webgl-sampler.js\";\nimport { WEBGLTexture } from \"./resources/webgl-texture.js\";\nimport { WEBGLFramebuffer } from \"./resources/webgl-framebuffer.js\";\nimport { WEBGLRenderPipeline } from \"./resources/webgl-render-pipeline.js\";\nimport { WEBGLCommandEncoder } from \"./resources/webgl-command-encoder.js\";\nimport { WEBGLVertexArray } from \"./resources/webgl-vertex-array.js\";\nimport { WEBGLTransformFeedback } from \"./resources/webgl-transform-feedback.js\";\nimport { WEBGLQuerySet } from \"./resources/webgl-query-set.js\";\nimport { readPixelsToArray, readPixelsToBuffer } from \"./helpers/webgl-texture-utils.js\";\nimport { setGLParameters, getGLParameters, resetGLParameters } from \"../context/parameters/unified-parameter-api.js\";\nimport { withGLParameters } from \"../context/state-tracker/with-parameters.js\";\nimport { getWebGLExtension } from \"../context/helpers/webgl-extensions.js\";\n/** WebGPU style Device API for a WebGL context */\nexport class WebGLDevice extends Device {\n    // Public `Device` API\n    /** type of this device */\n    type = 'webgl';\n    // Use the ! assertion to handle the case where _reuseDevices causes the constructor to return early\n    /** The underlying WebGL context */\n    handle;\n    features;\n    limits;\n    info;\n    canvasContext;\n    preferredColorFormat = 'rgba8unorm';\n    preferredDepthFormat = 'depth24plus';\n    commandEncoder;\n    lost;\n    _resolveContextLost;\n    /** WebGL2 context. */\n    gl;\n    /** Store constants */\n    // @ts-ignore TODO fix\n    _constants;\n    /** State used by luma.gl classes - TODO - not used? */\n    _extensions = {};\n    _polyfilled = false;\n    /** Instance of Spector.js (if initialized) */\n    spectorJS;\n    //\n    // Public API\n    //\n    get [Symbol.toStringTag]() {\n        return 'WebGLDevice';\n    }\n    toString() {\n        return `${this[Symbol.toStringTag]}(${this.id})`;\n    }\n    isVertexFormatSupported(format) {\n        switch (format) {\n            case 'unorm8x4-bgra':\n                return false;\n            default:\n                return true;\n        }\n    }\n    constructor(props) {\n        super({ ...props, id: props.id || uid('webgl-device') });\n        const canvasContextProps = Device._getCanvasContextProps(props);\n        // WebGL requires a canvas to be created before creating the context\n        if (!canvasContextProps) {\n            throw new Error('WebGLDevice requires props.createCanvasContext to be set');\n        }\n        // Check if the WebGL context is already associated with a device\n        // Note that this can be avoided in webgl2adapter.create() if\n        // DeviceProps._reuseDevices is set.\n        // @ts-expect-error device is attached to context\n        let device = canvasContextProps.canvas?.gl?.device;\n        if (device) {\n            throw new Error(`WebGL context already attached to device ${device.id}`);\n        }\n        // Create and instrument context\n        this.canvasContext = new WebGLCanvasContext(this, canvasContextProps);\n        this.lost = new Promise(resolve => {\n            this._resolveContextLost = resolve;\n        });\n        const webglContextAttributes = { ...props.webgl };\n        // Copy props from CanvasContextProps\n        if (canvasContextProps.alphaMode === 'premultiplied') {\n            webglContextAttributes.premultipliedAlpha = true;\n        }\n        if (props.powerPreference !== undefined) {\n            webglContextAttributes.powerPreference = props.powerPreference;\n        }\n        // Check if we should attach to an externally created context or create a new context\n        const externalGLContext = this.props._handle;\n        const gl = externalGLContext ||\n            createBrowserContext(this.canvasContext.canvas, {\n                onContextLost: (event) => this._resolveContextLost?.({\n                    reason: 'destroyed',\n                    message: 'Entered sleep mode, or too many apps or browser tabs are using the GPU.'\n                }),\n                // eslint-disable-next-line no-console\n                onContextRestored: (event) => console.log('WebGL context restored')\n            }, webglContextAttributes);\n        if (!gl) {\n            throw new Error('WebGL context creation failed');\n        }\n        // Note that the browser will only create one WebGL context per canvas.\n        // This means that a newly created gl context may already have a device attached to it.\n        // @ts-expect-error luma.gl stores a device reference on the context.\n        device = gl.device;\n        if (device) {\n            if (props._reuseDevices) {\n                log.log(1, `Not creating a new Device, instead returning a reference to Device ${device.id} already attached to WebGL context`, device)();\n                device._reused = true;\n                return device;\n            }\n            throw new Error(`WebGL context already attached to device ${device.id}`);\n        }\n        this.handle = gl;\n        this.gl = gl;\n        // Add spector debug instrumentation to context\n        // We need to trust spector integration to decide if spector should be initialized\n        // We also run spector instrumentation first, otherwise spector can clobber luma instrumentation.\n        this.spectorJS = initializeSpectorJS({ ...this.props, gl: this.handle });\n        // Instrument context\n        this.gl.device = this; // Update GL context: Link webgl context back to device\n        // TODO - remove, this is only used to detect debug contexts.\n        this.gl._version = 2; // Update GL context: Store WebGL version field on gl context (HACK to identify debug contexts)\n        // initialize luma Device fields\n        this.info = getDeviceInfo(this.gl, this._extensions);\n        this.limits = new WebGLDeviceLimits(this.gl);\n        this.features = new WebGLDeviceFeatures(this.gl, this._extensions, this.props._disabledFeatures);\n        if (this.props._initializeFeatures) {\n            this.features.initializeFeatures();\n        }\n        // Install context state tracking\n        const glState = new WebGLStateTracker(this.gl, {\n            log: (...args) => log.log(1, ...args)()\n        });\n        glState.trackState(this.gl, { copyState: false });\n        // DEBUG contexts: Add luma debug instrumentation to the context, force log level to at least 1\n        const debugWebGL = props.debugWebGL || props.debug;\n        const traceWebGL = props.debugWebGL;\n        if (debugWebGL) {\n            this.gl = makeDebugContext(this.gl, { debugWebGL, traceWebGL });\n            log.warn('WebGL debug mode activated. Performance reduced.')();\n            if (props.debugWebGL) {\n                log.level = Math.max(log.level, 1);\n            }\n        }\n        this.commandEncoder = new WEBGLCommandEncoder(this, { id: `${this}-command-encoder` });\n    }\n    /**\n     * Destroys the device\n     *\n     * @note \"Detaches\" from the WebGL context unless _reuseDevices is true.\n     *\n     * @note The underlying WebGL context is not immediately destroyed,\n     * but may be destroyed later through normal JavaScript garbage collection.\n     * This is a fundamental limitation since WebGL does not offer any\n     * browser API for destroying WebGL contexts.\n     */\n    destroy() {\n        // Note that deck.gl (especially in React strict mode) depends on being able\n        // to asynchronously create a Device against the same canvas (i.e. WebGL context)\n        // multiple times and getting the same device back. Since deck.gl is not aware\n        // of this sharing, it might call destroy() multiple times on the same device.\n        // Therefore we must do nothing in destroy() if props._reuseDevices is true\n        if (!this.props._reuseDevices && !this._reused) {\n            // Delete the reference to the device that we store on the WebGL context\n            delete this.gl.device;\n        }\n    }\n    get isLost() {\n        return this.gl.isContextLost();\n    }\n    // IMPLEMENTATION OF ABSTRACT DEVICE\n    getTextureByteAlignment() {\n        return 4;\n    }\n    createCanvasContext(props) {\n        throw new Error('WebGL only supports a single canvas');\n    }\n    createBuffer(props) {\n        const newProps = this._normalizeBufferProps(props);\n        return new WEBGLBuffer(this, newProps);\n    }\n    createTexture(props) {\n        return new WEBGLTexture(this, props);\n    }\n    createExternalTexture(props) {\n        throw new Error('createExternalTexture() not implemented'); // return new Program(props);\n    }\n    createSampler(props) {\n        return new WEBGLSampler(this, props);\n    }\n    createShader(props) {\n        return new WEBGLShader(this, props);\n    }\n    createFramebuffer(props) {\n        return new WEBGLFramebuffer(this, props);\n    }\n    createVertexArray(props) {\n        return new WEBGLVertexArray(this, props);\n    }\n    createTransformFeedback(props) {\n        return new WEBGLTransformFeedback(this, props);\n    }\n    createQuerySet(props) {\n        return new WEBGLQuerySet(this, props);\n    }\n    createRenderPipeline(props) {\n        return new WEBGLRenderPipeline(this, props);\n    }\n    createComputePipeline(props) {\n        throw new Error('ComputePipeline not supported in WebGL');\n    }\n    createCommandEncoder(props = {}) {\n        return new WEBGLCommandEncoder(this, props);\n    }\n    /**\n     * Offscreen Canvas Support: Commit the frame\n     * https://developer.mozilla.org/en-US/docs/Web/API/WebGL2RenderingContext/commit\n     * Chrome's offscreen canvas does not require gl.commit\n     */\n    submit(commandBuffer) {\n        if (!commandBuffer) {\n            commandBuffer = this.commandEncoder.finish();\n            this.commandEncoder.destroy();\n            this.commandEncoder = this.createCommandEncoder({ id: `${this.id}-default-encoder` });\n        }\n        commandBuffer._executeCommands();\n    }\n    //\n    // TEMPORARY HACKS - will be removed in v9.1\n    //\n    /** @deprecated - should use command encoder */\n    readPixelsToArrayWebGL(source, options) {\n        return readPixelsToArray(source, options);\n    }\n    /** @deprecated - should use command encoder */\n    readPixelsToBufferWebGL(source, options) {\n        return readPixelsToBuffer(source, options);\n    }\n    setParametersWebGL(parameters) {\n        setGLParameters(this.gl, parameters);\n    }\n    getParametersWebGL(parameters) {\n        return getGLParameters(this.gl, parameters);\n    }\n    withParametersWebGL(parameters, func) {\n        return withGLParameters(this.gl, parameters, func);\n    }\n    resetWebGL() {\n        log.warn('WebGLDevice.resetWebGL is deprecated, use only for debugging')();\n        resetGLParameters(this.gl);\n    }\n    _getDeviceSpecificTextureFormatCapabilities(capabilities) {\n        return getTextureFormatCapabilitiesWebGL(this.gl, capabilities, this._extensions);\n    }\n    //\n    // WebGL-only API (not part of `Device` API)\n    //\n    /**\n     * Triggers device (or WebGL context) loss.\n     * @note primarily intended for testing how application reacts to device loss\n     */\n    loseDevice() {\n        let deviceLossTriggered = false;\n        const extensions = this.getExtension('WEBGL_lose_context');\n        const ext = extensions.WEBGL_lose_context;\n        if (ext) {\n            deviceLossTriggered = true;\n            ext.loseContext();\n            // ext.loseContext should trigger context loss callback but the platform may not do this, so do it explicitly\n        }\n        this._resolveContextLost?.({\n            reason: 'destroyed',\n            message: 'Application triggered context loss'\n        });\n        return deviceLossTriggered;\n    }\n    /** Save current WebGL context state onto an internal stack */\n    pushState() {\n        const webglState = WebGLStateTracker.get(this.gl);\n        webglState.push();\n    }\n    /** Restores previously saved context state */\n    popState() {\n        const webglState = WebGLStateTracker.get(this.gl);\n        webglState.pop();\n    }\n    /**\n     * Returns the GL.<KEY> constant that corresponds to a numeric value of a GL constant\n     * Be aware that there are some duplicates especially for constants that are 0,\n     * so this isn't guaranteed to return the right key in all cases.\n     */\n    getGLKey(value, options) {\n        const number = Number(value);\n        for (const key in this.gl) {\n            // @ts-ignore expect-error depends on settings\n            if (this.gl[key] === number) {\n                return `GL.${key}`;\n            }\n        }\n        // No constant found. Stringify the value and return it.\n        return options?.emptyIfUnknown ? '' : String(value);\n    }\n    /**\n     * Returns a map with any GL.<KEY> constants mapped to strings, both for keys and values\n     */\n    getGLKeys(glParameters) {\n        const opts = { emptyIfUnknown: true };\n        return Object.entries(glParameters).reduce((keys, [key, value]) => {\n            // eslint-disable-next-line @typescript-eslint/no-base-to-string\n            keys[`${key}:${this.getGLKey(key, opts)}`] = `${value}:${this.getGLKey(value, opts)}`;\n            return keys;\n        }, {});\n    }\n    /**\n     * Set a constant value for a location. Disabled attributes at that location will read from this value\n     * @note WebGL constants are stored globally on the WebGL context, not the VertexArray\n     * so they need to be updated before every render\n     * @todo - remember/cache values to avoid setting them unnecessarily?\n     */\n    setConstantAttributeWebGL(location, constant) {\n        const maxVertexAttributes = this.limits.maxVertexAttributes;\n        this._constants = this._constants || new Array(maxVertexAttributes).fill(null);\n        const currentConstant = this._constants[location];\n        if (currentConstant && compareConstantArrayValues(currentConstant, constant)) {\n            log.info(1, `setConstantAttributeWebGL(${location}) could have been skipped, value unchanged`)();\n        }\n        this._constants[location] = constant;\n        switch (constant.constructor) {\n            case Float32Array:\n                setConstantFloatArray(this, location, constant);\n                break;\n            case Int32Array:\n                setConstantIntArray(this, location, constant);\n                break;\n            case Uint32Array:\n                setConstantUintArray(this, location, constant);\n                break;\n            default:\n                throw new Error('constant');\n        }\n    }\n    /** Ensure extensions are only requested once */\n    getExtension(name) {\n        getWebGLExtension(this.gl, name, this._extensions);\n        return this._extensions;\n    }\n    // INTERNAL SUPPORT METHODS FOR WEBGL RESOURCES\n    /**\n     * Storing data on a special field on WebGLObjects makes that data visible in SPECTOR chrome debug extension\n     * luma.gl ids and props can be inspected\n     */\n    _setWebGLDebugMetadata(handle, resource, options) {\n        // @ts-expect-error\n        handle.luma = resource;\n        const spectorMetadata = { props: options.spector, id: options.spector['id'] };\n        // @ts-expect-error\n        // eslint-disable-next-line camelcase\n        handle.__SPECTOR_Metadata = spectorMetadata;\n    }\n}\n/** Set constant float array attribute */\nfunction setConstantFloatArray(device, location, array) {\n    switch (array.length) {\n        case 1:\n            device.gl.vertexAttrib1fv(location, array);\n            break;\n        case 2:\n            device.gl.vertexAttrib2fv(location, array);\n            break;\n        case 3:\n            device.gl.vertexAttrib3fv(location, array);\n            break;\n        case 4:\n            device.gl.vertexAttrib4fv(location, array);\n            break;\n        default:\n        // assert(false);\n    }\n}\n/** Set constant signed int array attribute */\nfunction setConstantIntArray(device, location, array) {\n    device.gl.vertexAttribI4iv(location, array);\n    // TODO - not clear if we need to use the special forms, more testing needed\n    // switch (array.length) {\n    //   case 1:\n    //     gl.vertexAttribI1iv(location, array);\n    //     break;\n    //   case 2:\n    //     gl.vertexAttribI2iv(location, array);\n    //     break;\n    //   case 3:\n    //     gl.vertexAttribI3iv(location, array);\n    //     break;\n    //   case 4:\n    //     break;\n    //   default:\n    //     assert(false);\n    // }\n}\n/** Set constant unsigned int array attribute */\nfunction setConstantUintArray(device, location, array) {\n    device.gl.vertexAttribI4uiv(location, array);\n    // TODO - not clear if we need to use the special forms, more testing needed\n    // switch (array.length) {\n    //   case 1:\n    //     gl.vertexAttribI1uiv(location, array);\n    //     break;\n    //   case 2:\n    //     gl.vertexAttribI2uiv(location, array);\n    //     break;\n    //   case 3:\n    //     gl.vertexAttribI3uiv(location, array);\n    //     break;\n    //   case 4:\n    //     gl.vertexAttribI4uiv(location, array);\n    //     break;\n    //   default:\n    //     assert(false);\n    // }\n}\n/**\n * Compares contents of two typed arrays\n * @todo max length?\n */\nfunction compareConstantArrayValues(v1, v2) {\n    if (!v1 || !v2 || v1.length !== v2.length || v1.constructor !== v2.constructor) {\n        return false;\n    }\n    for (let i = 0; i < v1.length; ++i) {\n        if (v1[i] !== v2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n//# sourceMappingURL=webgl-device.js.map"],"mappings":"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"}
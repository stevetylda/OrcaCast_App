.pageStage--whaleTest {
  --whale-scroll-progress: 0;
  background:
    linear-gradient(
      180deg,
      rgba(142, 202, 252, calc(0.22 * (1 - var(--whale-scroll-progress)))) 0%,
      rgba(76, 147, 222, calc(0.16 * (1 - var(--whale-scroll-progress)))) 42%,
      rgba(8, 28, 76, calc(0.24 + (0.38 * var(--whale-scroll-progress)))) 100%
    ),
    radial-gradient(circle at 16% 0%, rgba(11, 194, 217, 0.18), transparent 40%),
    radial-gradient(circle at 86% 2%, rgba(49, 113, 198, 0.16), transparent 44%),
    #060d1e;
}

.whaleSandboxPage {
  width: min(1120px, calc(100vw - 28px));
  margin: 0 auto;
  padding: clamp(18px, 3vw, 30px) 0 clamp(24px, 4vw, 36px);
  position: relative;
  z-index: 14;
}

.whaleSandboxHero {
  position: relative;
  z-index: 14;
  border-radius: 22px;
  border: 1px solid rgba(255, 255, 255, 0.13);
  background: rgba(8, 14, 30, 0.62);
  box-shadow:
    0 20px 44px rgba(3, 9, 20, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.08),
    0 0 0 1px rgba(3, 169, 191, 0.16);
  overflow: hidden;
}

.whaleSandboxScrollTest {
  margin-top: 18px;
  display: grid;
  gap: 16px;
  padding-bottom: 40px;
}

.whaleSandboxScrollCard {
  position: relative;
  z-index: 14;
  border-radius: 16px;
  border: 1px solid rgba(255, 255, 255, 0.12);
  background: rgba(8, 14, 30, 0.58);
  box-shadow: 0 14px 30px rgba(3, 9, 20, 0.24);
  padding: clamp(16px, 2vw, 22px);
}

.whaleSandboxScrollCard h2,
.whaleSandboxScrollCard h3 {
  margin: 0 0 8px;
  color: rgba(239, 249, 255, 0.95);
}

.whaleSandboxScrollCard p {
  margin: 0;
  max-width: 70ch;
  color: rgba(218, 235, 252, 0.84);
}

.whaleSandboxScrollCard--tall {
  min-height: min(72vh, 620px);
}

.whaleSandboxCanvas {
  height: clamp(320px, 42vw, 420px);
}

.whaleSandboxControls {
  position: absolute;
  top: 16px;
  right: 16px;
  z-index: 10;
  width: min(530px, calc(100% - 22px));
  display: grid;
  gap: 10px;
  padding: 12px;
  border-radius: 14px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(5, 16, 34, 0.66);
  backdrop-filter: blur(10px);
}

.whaleSandboxControls__row {
  display: grid;
  gap: 8px;
}

.whaleSandboxControls__label {
  font-size: 11px;
  font-weight: 800;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(231, 244, 255, 0.76);
}

.whaleSandboxSegment {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 6px;
  padding: 6px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.16);
  background: rgba(8, 17, 34, 0.84);
}

.whaleSandboxBtn {
  height: 38px;
  border-radius: 999px;
  border: 0;
  color: rgba(236, 248, 255, 0.76);
  background: transparent;
  font-family: "Space Grotesk", "Sora", sans-serif;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  transition: color 140ms ease, background 140ms ease, box-shadow 140ms ease;
}

.whaleSandboxBtn:hover,
.whaleSandboxBtn:focus-visible {
  color: rgba(245, 252, 255, 0.96);
  background: rgba(255, 255, 255, 0.08);
  outline: none;
}

.whaleSandboxBtn.is-active {
  color: rgba(247, 254, 255, 0.98);
  background: linear-gradient(180deg, rgba(93, 108, 126, 0.94), rgba(68, 79, 98, 0.96));
  box-shadow:
    inset 0 0 0 1px rgba(210, 224, 240, 0.22),
    0 8px 16px rgba(0, 0, 0, 0.28);
}

.whaleSandboxActions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.whaleSandboxToggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  color: rgba(228, 241, 255, 0.86);
}

.whaleSandboxToggle input {
  width: 15px;
  height: 15px;
  margin: 0;
  accent-color: var(--teal2);
}

.whaleSandboxRandomize {
  margin-left: auto;
  height: 36px;
  padding: 0 14px;
  border-radius: 999px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(9, 25, 52, 0.84);
  color: rgba(237, 248, 255, 0.9);
  font-family: "Space Grotesk", "Sora", sans-serif;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.03em;
  cursor: pointer;
}

.whaleSandboxRandomize:hover,
.whaleSandboxRandomize:focus-visible {
  border-color: rgba(120, 225, 245, 0.62);
  box-shadow: 0 0 0 2px rgba(26, 198, 230, 0.16);
  outline: none;
}

.whaleAmbient {
  --wa-px: 0px;
  --wa-py: 0px;
  --wa-bg-top: #0b1f45;
  --wa-bg-bottom: #071326;
  --wa-water-top: rgba(37, 128, 151, 0.28);
  --wa-water-bottom: rgba(12, 53, 72, 0.44);
  --wa-water-near: rgba(16, 98, 126, 0.32);
  --wa-ripple: rgba(172, 235, 246, 0.44);

  width: 100%;
  height: 100%;
  position: relative;
}

.whaleAmbient__scene {
  width: 100%;
  height: 100%;
  display: block;
}

.wa-layer--bg {
  transform: translate(calc(var(--wa-px) * 0.14), calc(var(--wa-py) * 0.12));
}

.wa-layer--fg {
  transform: translate(calc(var(--wa-px) * 0.72), calc(var(--wa-py) * 0.7));
}

.wa-water--far {
  animation: wa-water-drift var(--wa-water-duration, 30s) ease-in-out infinite;
}

.wa-water--near,
.wa-ripple {
  animation: wa-water-drift calc(var(--wa-water-duration, 30s) * 0.74) ease-in-out infinite reverse;
}

.whaleAmbient.is-paused .wa-water,
.whaleAmbient.is-paused .wa-ripple {
  animation-play-state: paused !important;
}

.wa-debug {
  display: none;
  fill: none;
  pointer-events: none;
  vector-effect: non-scaling-stroke;
  stroke-width: 1.5;
}

.whaleAmbient.is-debug .wa-debug {
  display: block;
}

.wa-debug--bg {
  stroke: rgba(255, 201, 94, 0.84);
  stroke-dasharray: 7 5;
}

.wa-debug--whale {
  stroke: rgba(255, 112, 138, 0.86);
  stroke-dasharray: 6 4;
}

.wa-debug--fg {
  stroke: rgba(63, 230, 207, 0.86);
  stroke-dasharray: 8 4;
}

@keyframes wa-water-drift {
  0%,
  100% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(-18px);
  }
}

@media (max-width: 900px) {
  .whaleSandboxControls {
    position: static;
    width: 100%;
    border-radius: 0;
    border-left: 0;
    border-right: 0;
    border-top: 0;
  }

  .whaleSandboxCanvas {
    height: clamp(220px, 58vw, 280px);
  }

  .whaleSandboxRandomize {
    margin-left: 0;
  }
}

.app:not(.app--dark) .pageStage--whaleTest {
  background:
    linear-gradient(
      180deg,
      rgba(193, 226, 255, calc(0.24 * (1 - var(--whale-scroll-progress)))) 0%,
      rgba(135, 190, 240, calc(0.18 * (1 - var(--whale-scroll-progress)))) 44%,
      rgba(15, 58, 130, calc(0.16 + (0.22 * var(--whale-scroll-progress)))) 100%
    ),
    radial-gradient(circle at 16% 0%, rgba(7, 159, 177, 0.14), transparent 40%),
    radial-gradient(circle at 86% 2%, rgba(67, 131, 207, 0.14), transparent 44%),
    linear-gradient(180deg, #e6f1fb 0%, #dae8f9 100%);
}

.app:not(.app--dark) .whaleSandboxHero {
  border-color: rgba(11, 27, 58, 0.16);
  background: rgba(245, 251, 255, 0.86);
  box-shadow:
    0 20px 44px rgba(16, 32, 56, 0.16),
    inset 0 1px 0 rgba(255, 255, 255, 0.72),
    0 0 0 1px rgba(2, 129, 152, 0.14);
}

.app:not(.app--dark) .whaleSandboxScrollCard {
  border-color: rgba(11, 27, 58, 0.16);
  background: rgba(245, 251, 255, 0.88);
  box-shadow: 0 14px 30px rgba(16, 32, 56, 0.12);
}

.app:not(.app--dark) .whaleSandboxScrollCard h2,
.app:not(.app--dark) .whaleSandboxScrollCard h3 {
  color: rgba(13, 33, 60, 0.95);
}

.app:not(.app--dark) .whaleSandboxScrollCard p {
  color: rgba(29, 53, 86, 0.86);
}

.app:not(.app--dark) .whaleSandboxControls {
  border-color: rgba(11, 27, 58, 0.18);
  background: rgba(244, 251, 255, 0.82);
}

.app:not(.app--dark) .whaleSandboxControls__label {
  color: rgba(32, 55, 86, 0.78);
}

.app:not(.app--dark) .whaleSandboxSegment {
  border-color: rgba(11, 27, 58, 0.16);
  background: rgba(255, 255, 255, 0.92);
}

.app:not(.app--dark) .whaleSandboxBtn {
  color: rgba(20, 43, 74, 0.76);
}

.app:not(.app--dark) .whaleSandboxBtn:hover,
.app:not(.app--dark) .whaleSandboxBtn:focus-visible {
  color: rgba(17, 35, 58, 0.95);
  background: rgba(9, 22, 46, 0.08);
}

.app:not(.app--dark) .whaleSandboxBtn.is-active {
  color: rgba(10, 23, 40, 0.96);
  background: linear-gradient(180deg, rgba(209, 246, 241, 0.98), rgba(185, 236, 228, 0.98));
  box-shadow:
    0 8px 16px rgba(10, 22, 44, 0.12),
    inset 0 0 0 1px rgba(19, 119, 111, 0.34);
}

.app:not(.app--dark) .whaleSandboxToggle {
  color: rgba(23, 44, 72, 0.86);
}

.app:not(.app--dark) .whaleSandboxRandomize {
  border-color: rgba(11, 27, 58, 0.2);
  background: rgba(235, 245, 255, 0.88);
  color: rgba(17, 39, 67, 0.9);
}

.app:not(.app--dark) .whaleAmbient {
  --wa-bg-top: #dff0fb;
  --wa-bg-bottom: #cadff0;
  --wa-water-top: rgba(57, 145, 162, 0.23);
  --wa-water-bottom: rgba(22, 95, 118, 0.36);
  --wa-water-near: rgba(32, 121, 150, 0.28);
  --wa-ripple: rgba(184, 239, 245, 0.52);
}

@media (prefers-reduced-motion: reduce) {
  .whaleAmbient .wa-water,
  .whaleAmbient .wa-ripple {
    animation: none !important;
  }
}

.pixelSeafloor {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 20;
  height: clamp(82px, 12vh, 124px);
  pointer-events: none;
  --pixel-sand: rgba(158, 142, 102, 0.56);
  --pixel-sand-grain: rgba(213, 190, 135, 0.62);
  --pixel-kelp: rgba(55, 164, 134, 0.52);
  --pixel-star: rgba(255, 181, 96, 0.72);
}

.pixelSeafloor__svg {
  width: 100%;
  height: 100%;
  display: block;
  shape-rendering: crispEdges;
  image-rendering: pixelated;
}

.pixelSeafloor__grain {
  fill: var(--pixel-sand-grain);
}

.pixelSeafloor__kelp {
  fill: var(--pixel-kelp);
}

.pixelSeafloor__star {
  fill: var(--pixel-star);
}

.app:not(.app--dark) .pixelSeafloor {
  --pixel-sand: rgba(183, 164, 122, 0.44);
  --pixel-sand-grain: rgba(218, 197, 148, 0.54);
  --pixel-kelp: rgba(61, 155, 130, 0.46);
  --pixel-star: rgba(236, 146, 76, 0.62);
}
